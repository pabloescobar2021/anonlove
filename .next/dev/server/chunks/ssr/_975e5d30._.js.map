{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/my-next-app/utils/supabase/alSupabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_ANONLOVE_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_ANONLOVE_SUPABASE_ANON_KEY!\r\n);"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,uLAAY"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/my-next-app/app/anonlove/things/utils/auth.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\n\r\nexport async function getCurrentUser() {\r\n    const {data, error} = await supabase.auth.getUser()\r\n    if(error) return\r\n    return data.user\r\n}\r\n\r\nexport async function getUserProfile(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from(\"users\")\r\n        .select(\"public_id, username\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error) return null\r\n    return data\r\n}\r\n\r\nexport async function sighOut() {\r\n    const {error} = await supabase.auth.signOut()\r\n    if(error) throw error\r\n}\r\n\r\nexport function onAuthStateChange(callback: (user:any) => void) {\r\n    const {data: listener} = supabase.auth.onAuthStateChange((event,session) => {\r\n        callback(session?.user || null)\r\n    })\r\n    return listener.subscription\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IAClB,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,2IAAQ,CAAC,IAAI,CAAC,OAAO;IACjD,IAAG,OAAO;IACV,OAAO,KAAK,IAAI;AACpB;AAEO,eAAe,eAAe,MAAc;IAC/C,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,2IAAQ,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,OAAO,OAAO;IACjB,OAAO;AACX;AAEO,eAAe;IAClB,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,2IAAQ,CAAC,IAAI,CAAC,OAAO;IAC3C,IAAG,OAAO,MAAM;AACpB;AAEO,SAAS,kBAAkB,QAA4B;IAC1D,MAAM,EAAC,MAAM,QAAQ,EAAC,GAAG,2IAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAM;QAC5D,SAAS,SAAS,QAAQ;IAC9B;IACA,OAAO,SAAS,YAAY;AAChC"}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/my-next-app/app/anonlove/things/hooks/useAuth.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getCurrentUser, getUserProfile, onAuthStateChange } from \"../utils/auth\"\r\n\r\nexport function useAuth() {\r\n    const [user, setUser] = useState<any>(null)\r\n    const [profile, setProfile] = useState<any>(null)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        const loadUser = async () => {\r\n            try {\r\n                const userData = await getCurrentUser()\r\n                setUser(userData)\r\n\r\n                if(userData) {\r\n                    const profileData = await getUserProfile(userData.id)\r\n                    setProfile(profileData)\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Error loading user:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadUser()\r\n\r\n        const subscription = onAuthStateChange(async (newUser) => {\r\n            setUser(newUser)\r\n            if (newUser) {\r\n                const profileData = await getUserProfile(newUser.id)\r\n                setProfile(profileData)\r\n            } else {\r\n                setProfile(null)\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            subscription.unsubscribe()\r\n        }\r\n    },[])\r\n\r\n    return {user,profile,loading}\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKO,SAAS;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAM;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACN,MAAM,WAAW;YACb,IAAI;gBACA,MAAM,WAAW,MAAM,IAAA,4JAAc;gBACrC,QAAQ;gBAER,IAAG,UAAU;oBACT,MAAM,cAAc,MAAM,IAAA,4JAAc,EAAC,SAAS,EAAE;oBACpD,WAAW;gBACf;YACJ,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,uBAAuB;YACzC,SAAU;gBACN,WAAW;YACf;QACJ;QACA;QAEA,MAAM,eAAe,IAAA,+JAAiB,EAAC,OAAO;YAC1C,QAAQ;YACR,IAAI,SAAS;gBACT,MAAM,cAAc,MAAM,IAAA,4JAAc,EAAC,QAAQ,EAAE;gBACnD,WAAW;YACf,OAAO;gBACH,WAAW;YACf;QACJ;QAEA,OAAO;YACH,aAAa,WAAW;QAC5B;IACJ,GAAE,EAAE;IAEJ,OAAO;QAAC;QAAK;QAAQ;IAAO;AAChC"}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/my-next-app/app/anonlove/things/utils/messages.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\nimport { error } from \"console\";\r\n\r\nexport async function getInboxMessages(userId: string){\r\n    const {data, error} = await supabase\r\n        .from(\"messages_safe\")\r\n        .select(`\r\n            id,\r\n            body,\r\n            created_at,\r\n            is_anon,\r\n            from_user,\r\n            from_public_id,\r\n            from_username\r\n            `)\r\n        .eq(\"to_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    if(error) throw error;\r\n    return data || []\r\n}\r\n\r\nexport async function getCurrentMessage(messageId: string, userId: string) {\r\n    const {data, error} = await supabase\r\n    .from(\"messages_safe\")\r\n    .select(\"*\")\r\n    .eq(\"id\", messageId)\r\n    .eq(\"to_user\", userId)\r\n    .single()\r\n    if (error) throw error\r\n    return data || []\r\n}\r\n\r\nexport async function getSentMessages(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from(\"messages\")\r\n        .select(`\r\n            id,\r\n            body,\r\n            created_at,\r\n            is_anon,\r\n            to_user: to_user (\r\n                public_id,\r\n                username\r\n            )\r\n        `)\r\n        .eq(\"from_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    if(error) throw error\r\n    return data || []\r\n}\r\n\r\nexport async function sendMessage({\r\n    fromUserId,\r\n    toPublicId,\r\n    body,\r\n    isAnon\r\n}: {\r\n    fromUserId: string,\r\n    toPublicId: string,\r\n    body: string,\r\n    isAnon: boolean\r\n}) {\r\n    const {data: receiver, error: userError} = await supabase\r\n        .from(\"users\")\r\n        .select(\"id_user\")\r\n        .eq(\"public_id\", toPublicId)\r\n        .single()\r\n    if(userError || !receiver){\r\n        throw new Error(\"Пользователь не найден, кись\")\r\n    }\r\n\r\n    const {error: messageError} = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n            from_user: fromUserId,\r\n            to_user: receiver.id_user,\r\n            body,\r\n            is_anon: isAnon\r\n        })\r\n    if(messageError) throw messageError\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,eAAe,iBAAiB,MAAc;IACjD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,2IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;;;;;;;;YAQL,CAAC,EACJ,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IACzC,IAAG,OAAO,MAAM;IAChB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,kBAAkB,SAAiB,EAAE,MAAc;IACrE,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,2IAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,WAAW,QACd,MAAM;IACP,IAAI,OAAO,MAAM;IACjB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,gBAAgB,MAAc;IAChD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,2IAAQ,CAC/B,IAAI,CAAC,YACL,MAAM,CAAC,CAAC;;;;;;;;;QAST,CAAC,EACA,EAAE,CAAC,aAAa,QAChB,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IACzC,IAAG,OAAO,MAAM;IAChB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,YAAY,EAC9B,UAAU,EACV,UAAU,EACV,IAAI,EACJ,MAAM,EAMT;IACG,MAAM,EAAC,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAC,GAAG,MAAM,2IAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC,WACP,EAAE,CAAC,aAAa,YAChB,MAAM;IACX,IAAG,aAAa,CAAC,UAAS;QACtB,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,2IAAQ,CACvC,IAAI,CAAC,YACL,MAAM,CAAC;QACJ,WAAW;QACX,SAAS,SAAS,OAAO;QACzB;QACA,SAAS;IACb;IACJ,IAAG,cAAc,MAAM;AAC3B"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/my-next-app/app/anonlove/things/hooks/useMessages.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getInboxMessages, getSentMessages, sendMessage, getCurrentMessage } from \"../utils/messages\"\r\n\r\nexport function useMessages(userId: string | null) {\r\n    const [inbox, setInbox] = useState<any[]>([])\r\n    const [sent, setSent] = useState<any[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    const loadMessage = async () => {\r\n        if(!userId) return\r\n\r\n        try{\r\n            setLoading(true)\r\n            const [inboxData, sentData] = await Promise.all([\r\n                getInboxMessages(userId), \r\n                getSentMessages(userId)\r\n            ])\r\n\r\n            setInbox(inboxData)\r\n            setSent(sentData)\r\n        } catch (error) {\r\n            console.error(\"Error loading messages:\", error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadMessage()\r\n    },[userId])\r\n\r\n    const send = async (toPublicId: string, body: string, isAnon: boolean) => {\r\n        if(!userId) throw new Error(\"User not logged in\")\r\n        \r\n        await sendMessage({fromUserId: userId, toPublicId, body, isAnon})\r\n\r\n        await loadMessage()\r\n    }\r\n\r\n    return {\r\n        inbox,\r\n        sent,\r\n        loading,\r\n        sendMessage: send,\r\n        refresh: loadMessage\r\n    }\r\n\r\n}\r\n\r\nexport function useCurrentMessage(userId: string | null, messageId: string | null) {\r\n    const [message, setMessage] = useState<any>(null)\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    useEffect(() => {\r\n        if (!userId || !messageId) return\r\n\r\n        const loadMessage = async () => {\r\n            setLoading(true)\r\n            try{\r\n                const data = await getCurrentMessage(messageId, userId)\r\n                setMessage(data)\r\n            } catch (error) {\r\n                console.error(\"Error loading messages:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadMessage()\r\n\r\n    }, [userId, messageId])\r\n\r\n    return {\r\n        message,\r\n        loading\r\n    }\r\n}"],"names":[],"mappings":";;;;;;AAEA;AACA;AAHA;;;AAKO,SAAS,YAAY,MAAqB;IAC7C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAQ,EAAE;IAC5C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAQ,EAAE;IAC1C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,MAAM,cAAc;QAChB,IAAG,CAAC,QAAQ;QAEZ,IAAG;YACC,WAAW;YACX,MAAM,CAAC,WAAW,SAAS,GAAG,MAAM,QAAQ,GAAG,CAAC;gBAC5C,IAAA,kKAAgB,EAAC;gBACjB,IAAA,iKAAe,EAAC;aACnB;YAED,SAAS;YACT,QAAQ;QACZ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,2BAA2B;QAC7C,SAAU;YACN,WAAW;QACf;IACJ;IAEA,IAAA,kNAAS,EAAC;QACN;IACJ,GAAE;QAAC;KAAO;IAEV,MAAM,OAAO,OAAO,YAAoB,MAAc;QAClD,IAAG,CAAC,QAAQ,MAAM,IAAI,MAAM;QAE5B,MAAM,IAAA,6JAAW,EAAC;YAAC,YAAY;YAAQ;YAAY;YAAM;QAAM;QAE/D,MAAM;IACV;IAEA,OAAO;QACH;QACA;QACA;QACA,aAAa;QACb,SAAS;IACb;AAEJ;AAEO,SAAS,kBAAkB,MAAqB,EAAE,SAAwB;IAC7E,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACN,IAAI,CAAC,UAAU,CAAC,WAAW;QAE3B,MAAM,cAAc;YAChB,WAAW;YACX,IAAG;gBACC,MAAM,OAAO,MAAM,IAAA,mKAAiB,EAAC,WAAW;gBAChD,WAAW;YACf,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,2BAA2B;YAC7C,SAAU;gBACN,WAAW;YACf;QACJ;QACA;IAEJ,GAAG;QAAC;QAAQ;KAAU;IAEtB,OAAO;QACH;QACA;IACJ;AACJ"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/my-next-app/app/anonlove/anonlovemain/page.tsx"],"sourcesContent":["\"use client\"\r\nimport { useState, useEffect, useRef } from \"react\"\r\nimport { supabase } from \"@/utils/supabase/alSupabase\"\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useAuth } from \"../things/hooks/useAuth\";\r\nimport { useMessages } from \"../things/hooks/useMessages\";\r\nimport { sighOut } from \"../things/utils/auth\";\r\n\r\nexport default function Page() {\r\n    const router = useRouter();\r\n\r\n    const {user, profile, loading: authLoading} = useAuth();\r\n    \r\n    const {inbox, sent, sendMessage: send, loading: messageLoading} = useMessages(user?.id || null);\r\n\r\n\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    const idRef = useRef<HTMLInputElement>(null);\r\n    const textRef = useRef<HTMLInputElement>(null);\r\n    const [isAnon, setIsAnon] = useState(false);\r\n\r\n    // ответ на сообщение\r\n    const [replyToUserId, setreplyToUserId] = useState<string | null>(null); //id\r\n    const [isReply, setIsReply] = useState(false);\r\n\r\n    const [tab, setTab] = useState<\"inbox\" | \"sent\">(\"inbox\");\r\n    \r\n    // автовставка id\r\n    useEffect(() => {\r\n        if (isOpen && idRef.current) {\r\n            idRef.current.value = replyToUserId || ''\r\n        }\r\n    }, [isOpen, replyToUserId])\r\n    \r\n    const handleSendMessage = async () => {\r\n        const publicId = idRef.current?.value || \"\"\r\n        const text = textRef.current?.value || \"\"\r\n\r\n        if (!publicId || !text){\r\n            alert('все поля заполни, сладкий!')\r\n            return\r\n        }\r\n        \r\n        try {\r\n            await send(publicId, text, isAnon)\r\n            idRef.current!.value = \"\"\r\n            textRef.current!.value = \"\"\r\n            setIsOpen(false)\r\n        } catch (error: any) {\r\n            console.log(error.message || 'Error sending message');\r\n        }\r\n        \r\n    }\r\n    \r\n    const handleSignOut = async () => {\r\n        await sighOut()\r\n        router.push('/anonlove/auth')\r\n    }\r\n\r\n    if (authLoading) {\r\n        return (\r\n            <div className=\"bg-black min-h-screen flex items-center justify-center text-white\">\r\n                Загрузка...\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative bg-black min-h-screen flex flex-col\">\r\n            {user ? (\r\n                <header className=\"bg-[#8f184f] text-white p-1 flex justify-between items-center shadow-md\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center text-lg font-bold\">\r\n                            {profile?.public_id.charAt(1).toUpperCase()}\r\n                        </div>\r\n                        <div className=\"flex flex-col\">\r\n                            <span className=\"font-semibold\">{profile?.public_id}</span>\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        className=\"bg-white/10 hover:bg-white/20 text-white px-4 py-1 rounded-md transition\"\r\n                        onClick={handleSignOut}\r\n                    >\r\n                        Выйти\r\n                    </button>\r\n                </header>\r\n            ) : (\r\n                <header className=\"bg-gray-900 text-white p-4 shadow-md\">\r\n                    <span>Вы не залогинены</span>\r\n                </header>\r\n            )}\r\n\r\n            {/* сообщения */}\r\n            <main className=\"flex-1 p-6 text-white flex\">\r\n                <div className=\"bg-[#12080b] border-2 border-[#8f184f] rounded-lg w-1/2 min-h-full\">\r\n                    <div className=\"flex flex-1\">\r\n                        <button \r\n                            onClick={() => setTab(\"inbox\")} \r\n                            className=\"bg-white/10 p-2 rounded-md w-1/2 text-center flex items-center gap-1\"\r\n                        >\r\n                            <span>Сообщения</span>\r\n                            <span \r\n                                className={`w-3 h-3 rounded-full border transition\r\n                                    ${tab === \"inbox\"\r\n                                        ? \"bg-white border-white\"\r\n                                        : \"border-white/50\"\r\n                                    }    \r\n                                `}\r\n                            />\r\n                        </button>\r\n\r\n                        <button \r\n                            onClick={() => setTab(\"sent\")} \r\n                            className=\"bg-white/10 p-2 rounded-md w-1/2 text-center flex items-center gap-1\"\r\n                        >\r\n                            <span>Отправленные</span>\r\n                            <span \r\n                                className={`w-3 h-3 rounded-full border transition\r\n                                    ${tab === \"sent\"\r\n                                        ? \"bg-white border-white\"\r\n                                        : \"border-white/50\"\r\n                                    }    \r\n                                `}\r\n                            />\r\n                        </button>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"flex flex-col items-start gap-2 p-2 overflow-y-scroll\">\r\n                        {tab === \"inbox\" \r\n                            ?\r\n                            inbox.map((message) => (\r\n                              <div \r\n                                key={message.id} \r\n                                className=\"flex flex-col items-start relative w-full hover:bg-white/10 transition \"\r\n                                >\r\n\r\n                                <div \r\n                                    className=\"flex items-start gap-2 p-2  cursor-pointer\"\r\n                                    onClick={() => {\r\n                                        router.push(`lovecard#${message.id}`)\r\n                                    }}\r\n                                >\r\n                                    <div className=\"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center text-lg font-bold\">\r\n                                        {message.is_anon \r\n                                        ? \"A\"\r\n                                        : message.from_public_id?.charAt(1).toUpperCase()}\r\n                                    </div>\r\n\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"font-semibold\">\r\n                                            {message.is_anon \r\n                                            ? \"Anon\"\r\n                                            : message.from_public_id}\r\n                                        </span>\r\n                                        <span className=\"\">Тебе тут что то пришло, малышка!</span>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                {/* svg */}\r\n                                <button className=\"absolute top-1/2 right-1 -translate-y-1/2 \"\r\n                                        onClick={() => {\r\n                                            setreplyToUserId(message.from_public_id ?? '')\r\n                                            setIsReply(true)\r\n                                            setIsOpen(true)\r\n                                        }}\r\n                                > \r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 14 14\"><title></title><g fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M7.5.5h-5a1 1 0 0 0-1 1v9l-1 3l4-1h8a1 1 0 0 0 1-1v-5\"/><path d=\"m8.363 8.137l-3 .54l.5-3.04l4.73-4.71a.999.999 0 0 1 1.42 0l1.06 1.06a1.001 1.001 0 0 1 0 1.42z\"/></g></svg>\r\n                                </button>\r\n\r\n                                <div className=\"w-full bg-white/20 h-[1px]\"></div>\r\n\r\n                            </div>  \r\n                            \r\n                            ))\r\n\r\n\r\n                            :\r\n                            sent.map((message) => (\r\n                              <div \r\n                                key={message.id} \r\n                                className=\"flex items-center gap-2\"\r\n                                >\r\n                                <div className=\"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center text-lg font-bold\">\r\n                                    {message.is_anon ? \"A\" : profile.public_id.charAt(1).toUpperCase()}\r\n                                </div>\r\n                                <div className=\"flex flex-col\">\r\n                                    <span className=\"font-semibold\">{\r\n                                    message.is_anon \r\n                                        ? `Anon > ${message.to_user.public_id}`\r\n                                        : `${profile.public_id} > ${message.to_user.public_id}`\r\n                                    \r\n                                    }</span>\r\n                                    <span className=\"\">{message.body}</span>\r\n                                </div>\r\n                            </div>  \r\n                            ))\r\n                        }\r\n                        \r\n                    </div>\r\n                    \r\n                </div>\r\n\r\n                <div className=\"flex w-1/2 justify-center items-center\">\r\n                    <AnimatedButton\r\n                    openModal={() => {\r\n                        setreplyToUserId('')\r\n                        setIsOpen(true)\r\n                        setIsReply(false)\r\n                    }}\r\n                    >\r\n                        Давай отправим что нибудь!\r\n                    </AnimatedButton>\r\n                </div>\r\n            </main>\r\n\r\n            {/* modalka */}\r\n            {isOpen && (\r\n                <div \r\n                    className=\"absolute w-[400px] h-[300px] bg-black z-50 \r\n                                rounded-lg flex border-2 border-[#8f184f]\r\n                                top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\"> \r\n                    <form \r\n                        className=\"relative flex flex-col justify-center items-center gap-2 mx-auto w-full\"\r\n                        onSubmit={(e) => {e.preventDefault()}}\r\n                        >\r\n                        <input\r\n                            ref={idRef}\r\n                            type=\"text\" \r\n                            placeholder=\"id няшки\" \r\n                            disabled={isReply}\r\n                            className={`p-2 border-2 rounded-lg \r\n                                ${isReply \r\n                                    ? 'opacity-50'\r\n                                    : 'opacity-100'\r\n                                }`}\r\n                            />\r\n                        <input \r\n                            ref={textRef}\r\n                            type=\"text\" \r\n                            placeholder=\"Текст\" \r\n                            className=\"p-2 border-2 rounded-lg \"\r\n                            />\r\n                        <div className=\"flex justify-center items-center\">\r\n                            <input\r\n                                type=\"checkbox\" id=\"anon\" name=\"anon\"\r\n                                checked={isAnon}\r\n                                onChange={(e) => {setIsAnon(e.target.checked)}}\r\n                            />\r\n                            <label htmlFor=\"anon\">{`анонимно (увидит только id)`}</label>\r\n                        </div>\r\n                        \r\n\r\n                        <button type=\"button\" onClick={handleSendMessage}>Отправить</button>\r\n\r\n                        <button onClick={() => {setIsOpen(false)}} className=\"absolute top-1 right-2\">X</button>\r\n                    </form>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\n\r\nfunction AnimatedButton({ \r\n    children,\r\n    openModal \r\n}: {\r\n    children: React.ReactNode,\r\n    openModal: () => void\r\n\r\n}) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n    const animationRef = useRef<number>(0);\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current\r\n        const button = buttonRef.current\r\n        if(!canvas || !button) return;\r\n\r\n        const ctx = canvas.getContext(\"2d\");\r\n        if(!ctx) return;\r\n\r\n        const updateSize = () => {\r\n            const rect = button.getBoundingClientRect();\r\n            canvas.width = rect.width;\r\n            canvas.height = rect.height;\r\n        }\r\n        updateSize()\r\n\r\n        const w = canvas.width\r\n        const h = canvas.height\r\n        const perimeter = 2 * (w + h)\r\n        let distance = 0\r\n        const speed = 100\r\n\r\n        let lastTime = performance.now()\r\n\r\n        function animate(currentTime: number) {\r\n            if (!ctx || !canvas) return\r\n\r\n            const deltaTime = (currentTime - lastTime) / 1000\r\n            lastTime = currentTime\r\n\r\n            ctx.clearRect(0,0, canvas.width, canvas.height)\r\n\r\n            distance = (distance + speed * deltaTime) % perimeter\r\n\r\n            let x,y;\r\n\r\n            if (distance < w) {\r\n                x = distance\r\n                y = 0\r\n            } else if (distance < w + h) {\r\n                x = w\r\n                y = distance - w\r\n            } else if (distance < 2 * w + h){\r\n                x = w - (distance - w - h) \r\n                y = h\r\n            } else {\r\n                x = 0\r\n                y = h - (distance - 2 * w - h)\r\n            }\r\n\r\n            // Рисуем точку с многослойным свечением\r\n            // Внешнее свечение\r\n            ctx.shadowBlur = 0;\r\n            ctx.globalAlpha = 0.2;\r\n            ctx.fillStyle = 'white';\r\n            ctx.beginPath();\r\n            ctx.arc(x, y, 7, 0, Math.PI * 2);\r\n            ctx.fill();\r\n\r\n            // Среднее свечение\r\n            ctx.globalAlpha = 0.4;\r\n            ctx.beginPath();\r\n            ctx.arc(x, y, 6, 0, Math.PI * 2);\r\n            ctx.fill();\r\n\r\n            // Внутреннее свечение\r\n            ctx.shadowBlur = 8;\r\n            ctx.shadowColor = 'white';\r\n            ctx.globalAlpha = 0.7;\r\n            ctx.beginPath();\r\n            ctx.arc(x, y, 4, 0, Math.PI * 2);\r\n            ctx.fill();\r\n\r\n            // Яркое ядро\r\n            ctx.shadowBlur = 4;\r\n            ctx.globalAlpha = 1;\r\n            ctx.beginPath();\r\n            ctx.arc(x, y, 2, 0, Math.PI * 2);\r\n            ctx.fill();\r\n\r\n            animationRef.current = requestAnimationFrame(animate)\r\n\r\n        }\r\n\r\n        animationRef.current = requestAnimationFrame(animate)\r\n\r\n        window.addEventListener('resize', updateSize)\r\n\r\n        return () => {\r\n            if (animationRef.current){\r\n                cancelAnimationFrame(animationRef.current)\r\n            }\r\n            window.removeEventListener('resize', updateSize)\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"relative inline-block\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"absolute top-0 left-0 pointer-events-none\"\r\n            />\r\n\r\n            <button\r\n                ref={buttonRef}\r\n                onClick={openModal}\r\n                className=\"relative px-8 py-4 bg-white/10 rounded-md hover:bg-white/20 transition-colors\"\r\n            >\r\n                {children}\r\n            </button>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}