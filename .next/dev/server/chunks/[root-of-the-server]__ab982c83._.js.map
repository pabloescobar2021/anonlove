{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/utils/supabase/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\n\r\nexport const supabaseAdmin = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,gBAAgB,IAAA,yLAAY,gFAEvC,QAAQ,GAAG,CAAC,yBAAyB"}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/telegram/tgSend.ts"],"sourcesContent":["export async function tgSend(\r\n    chatId: number, \r\n    text: string,\r\n    parseMode: \"HTML\" | \"MarkdownV2\" = \"HTML\",\r\n    inlineKeyBoard?: {\r\n        text: string\r\n        callback_data?: string\r\n        url?: string\r\n        login_url?: { url: string }\r\n    }[][]\r\n){\r\n    const body: any = {\r\n        chat_id: chatId,\r\n        text,\r\n        parse_mode: parseMode\r\n    }\r\n    if(inlineKeyBoard) {\r\n        body.reply_markup = { inline_keyboard: inlineKeyBoard }\r\n    }\r\n\r\n    try{\r\n        await fetch(`https://api.telegram.org/bot${process.env.TELEGRAM_BOT_TOKEN}/sendMessage`, {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify(body),\r\n        })\r\n    } catch(e){\r\n        console.error('Failed to send Telegram message:', e)\r\n    }\r\n}\r\nexport async function tgEdit(\r\n    chatId: number,\r\n    messageId: number,\r\n    text: string,\r\n    parseMode: \"HTML\" | \"MarkdownV2\" = \"HTML\",\r\n    inlineKeyBoard?: {text: string, callback_data?: string, url?: string}[][]\r\n){\r\n    const body: any = {\r\n        chat_id: chatId,\r\n        message_id: messageId,\r\n        text,\r\n        parse_mode: parseMode\r\n    }\r\n    if(inlineKeyBoard) {\r\n        body.reply_markup = {inline_keyboard: inlineKeyBoard}\r\n    }\r\n\r\n    try{\r\n        await fetch(`https://api.telegram.org/bot${process.env.TELEGRAM_BOT_TOKEN}/editMessageText`, {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify(body),\r\n        })\r\n    } catch(e){\r\n        console.error('Failed to edit Telegram message:', e)\r\n    }\r\n}"],"names":[],"mappings":";;;;;;AAAO,eAAe,OAClB,MAAc,EACd,IAAY,EACZ,YAAmC,MAAM,EACzC,cAKK;IAEL,MAAM,OAAY;QACd,SAAS;QACT;QACA,YAAY;IAChB;IACA,IAAG,gBAAgB;QACf,KAAK,YAAY,GAAG;YAAE,iBAAiB;QAAe;IAC1D;IAEA,IAAG;QACC,MAAM,MAAM,CAAC,4BAA4B,EAAE,QAAQ,GAAG,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE;YACrF,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACzB;IACJ,EAAE,OAAM,GAAE;QACN,QAAQ,KAAK,CAAC,oCAAoC;IACtD;AACJ;AACO,eAAe,OAClB,MAAc,EACd,SAAiB,EACjB,IAAY,EACZ,YAAmC,MAAM,EACzC,cAAyE;IAEzE,MAAM,OAAY;QACd,SAAS;QACT,YAAY;QACZ;QACA,YAAY;IAChB;IACA,IAAG,gBAAgB;QACf,KAAK,YAAY,GAAG;YAAC,iBAAiB;QAAc;IACxD;IAEA,IAAG;QACC,MAAM,MAAM,CAAC,4BAA4B,EAAE,QAAQ,GAAG,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,EAAE;YACzF,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACzB;IACJ,EAAE,OAAM,GAAE;QACN,QAAQ,KAAK,CAAC,oCAAoC;IACtD;AACJ"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/telegram/sendTelegramNotification.ts"],"sourcesContent":["import { supabaseAdmin } from \"@/utils/supabase/supabaseAdmin\";\r\nimport { tgSend } from \"./tgSend\";\r\n\r\nexport async function sendTelegramNotification(userId: string, text:string){\r\n    const {data: user, error} = await supabaseAdmin\r\n        .from(\"users\")\r\n        .select(\"telegram_id, telegram_notifications\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error || !user || !user.telegram_id){\r\n        console.log('User not found or no Telegram ID:', {error})\r\n        return\r\n    }\r\n    const chatId = user.telegram_id\r\n    \r\n    // бот шлет сообщение об уведомлении что пришло сообщение\r\n    if(user.telegram_notifications){\r\n        await tgSend(chatId, text)\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,yBAAyB,MAAc,EAAE,IAAW;IACtE,MAAM,EAAC,MAAM,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,qJAAa,CAC1C,IAAI,CAAC,SACL,MAAM,CAAC,uCACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,SAAS,CAAC,QAAQ,CAAC,KAAK,WAAW,EAAC;QACnC,QAAQ,GAAG,CAAC,qCAAqC;YAAC;QAAK;QACvD;IACJ;IACA,MAAM,SAAS,KAAK,WAAW;IAE/B,yDAAyD;IACzD,IAAG,KAAK,sBAAsB,EAAC;QAC3B,MAAM,IAAA,qIAAM,EAAC,QAAQ;IACzB;AACJ"}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/api/telegram/sendNotifyTg/route.ts"],"sourcesContent":["import { sendTelegramNotification } from \"@/app/telegram/sendTelegramNotification\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    const { userId, text } = await req.json();\r\n    \r\n    try{\r\n        await sendTelegramNotification(userId, text)\r\n        return NextResponse.json({ ok: true })\r\n    } catch(e){\r\n        return NextResponse.json({ error: e }, { status: 500 })\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;IAEvC,IAAG;QACC,MAAM,IAAA,yKAAwB,EAAC,QAAQ;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAK;IACxC,EAAE,OAAM,GAAE;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAE,GAAG;YAAE,QAAQ;QAAI;IACzD;AACJ"}}]
}