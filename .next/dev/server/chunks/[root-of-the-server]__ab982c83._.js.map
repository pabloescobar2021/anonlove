{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/utils/supabase/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\n\r\nexport const supabaseAdmin = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,gBAAgB,IAAA,yLAAY,gFAEvC,QAAQ,GAAG,CAAC,yBAAyB"}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/telegram/tgSend.ts"],"sourcesContent":["\r\nexport async function tgSend(chatId: number, text: string){\r\n    try{\r\n        await fetch (`https://api.telegram.org/bot${process.env.TELEGRAM_BOT_TOKEN}/sendMessage`, {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({ chat_id: chatId, text }),\r\n        })\r\n    } catch(e){\r\n        console.error('Failed to send Telegram message:', e)\r\n    }\r\n}"],"names":[],"mappings":";;;;AACO,eAAe,OAAO,MAAc,EAAE,IAAY;IACrD,IAAG;QACC,MAAM,MAAO,CAAC,4BAA4B,EAAE,QAAQ,GAAG,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE;YACtF,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,SAAS;gBAAQ;YAAK;QACjD;IACJ,EAAE,OAAM,GAAE;QACN,QAAQ,KAAK,CAAC,oCAAoC;IACtD;AACJ"}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/telegram/sendTelegramNotification.ts"],"sourcesContent":["import { supabaseAdmin } from \"@/utils/supabase/supabaseAdmin\";\r\nimport { tgSend } from \"./tgSend\";\r\n\r\nexport async function sendTelegramNotification(userId: string, text:string){\r\n    const {data: user, error} = await supabaseAdmin\r\n        .from(\"users\")\r\n        .select(\"telegram_id, telegram_notifications\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error || !user || !user.telegram_id){\r\n        console.log('User not found or no Telegram ID:', {error})\r\n        return\r\n    }\r\n    const chatId = user.telegram_id\r\n    \r\n    // бот шлет сообщение об уведомлении что пришло сообщение\r\n    if(user.telegram_notifications){\r\n        await tgSend(chatId, text)\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,yBAAyB,MAAc,EAAE,IAAW;IACtE,MAAM,EAAC,MAAM,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,qJAAa,CAC1C,IAAI,CAAC,SACL,MAAM,CAAC,uCACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,SAAS,CAAC,QAAQ,CAAC,KAAK,WAAW,EAAC;QACnC,QAAQ,GAAG,CAAC,qCAAqC;YAAC;QAAK;QACvD;IACJ;IACA,MAAM,SAAS,KAAK,WAAW;IAE/B,yDAAyD;IACzD,IAAG,KAAK,sBAAsB,EAAC;QAC3B,MAAM,IAAA,qIAAM,EAAC,QAAQ;IACzB;AACJ"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/api/telegram/sendNotifyTg/route.ts"],"sourcesContent":["import { sendTelegramNotification } from \"@/app/telegram/sendTelegramNotification\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    const { userId, text } = await req.json();\r\n    \r\n    try{\r\n        await sendTelegramNotification(userId, text)\r\n        return NextResponse.json({ ok: true })\r\n    } catch(e){\r\n        return NextResponse.json({ error: e }, { status: 500 })\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;IAEvC,IAAG;QACC,MAAM,IAAA,yKAAwB,EAAC,QAAQ;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAK;IACxC,EAAE,OAAM,GAAE;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAE,GAAG;YAAE,QAAQ;QAAI;IACzD;AACJ"}}]
}