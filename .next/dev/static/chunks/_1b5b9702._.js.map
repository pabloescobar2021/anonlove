{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/createcard/useRandColor.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState,useEffect, useRef } from \"react\"\r\n\r\ntype Color = {r: number, g: number, b: number, a: number}\r\nconst lerp = (a: number, b: number, t: number) => {\r\n    return a + (b - a) * t\r\n}\r\nconst smoothStep = (t: number) => {\r\n    return t * t * (3 - 2 * t)\r\n}\r\nconst mixColor = (from: Color, to: Color, t: number): Color => {\r\n    const k = smoothStep(t)\r\n    return{\r\n        r: lerp(from.r, to.r, k),\r\n        g: lerp(from.g, to.g, k),\r\n        b: lerp(from.b, to.b, k),\r\n        a: lerp(from.a, to.a, k),\r\n    }\r\n}\r\nconst randomColor = (): Color => {\r\n    return {\r\n        r: Math.floor(Math.random() * 256),\r\n        g: 0,\r\n        b: 0,\r\n        a: 0.1\r\n    }\r\n}\r\n\r\nexport function useRandColor() {\r\n    const [bg, setBg] = useState<Color>({r: 0, g: 0, b: 0, a: 0.1})\r\n    const colorRef = useRef<Color>(bg)\r\n    const frameRef = useRef<number | null>(null)\r\n\r\n\r\n    useEffect(() => {\r\n        let start: number | null = null\r\n        let from = colorRef.current\r\n        let to = randomColor()\r\n        const duration = 3000 \r\n\r\n        const animate = (time: number) => {\r\n            if (!start) start = time\r\n            const t = Math.min((time - start) / duration, 1)\r\n            const next = mixColor(from, to, t)\r\n\r\n            colorRef.current = next\r\n            setBg(next)\r\n\r\n            if (t < 1) {\r\n                frameRef.current = requestAnimationFrame(animate)\r\n            } else{\r\n                from = to\r\n                to = randomColor()\r\n                start = null\r\n                frameRef.current = requestAnimationFrame(animate)\r\n            }\r\n        }\r\n        frameRef.current = requestAnimationFrame(animate)\r\n\r\n        return () => {\r\n            if (frameRef.current) cancelAnimationFrame(frameRef.current)\r\n        }\r\n    },[])\r\n\r\n    return {\r\n        bg\r\n    }\r\n}"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAKA,MAAM,OAAO,CAAC,GAAW,GAAW;IAChC,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI;AACzB;AACA,MAAM,aAAa,CAAC;IAChB,OAAO,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC;AAC7B;AACA,MAAM,WAAW,CAAC,MAAa,IAAW;IACtC,MAAM,IAAI,WAAW;IACrB,OAAM;QACF,GAAG,KAAK,KAAK,CAAC,EAAE,GAAG,CAAC,EAAE;QACtB,GAAG,KAAK,KAAK,CAAC,EAAE,GAAG,CAAC,EAAE;QACtB,GAAG,KAAK,KAAK,CAAC,EAAE,GAAG,CAAC,EAAE;QACtB,GAAG,KAAK,KAAK,CAAC,EAAE,GAAG,CAAC,EAAE;IAC1B;AACJ;AACA,MAAM,cAAc;IAChB,OAAO;QACH,GAAG,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;QAC9B,GAAG;QACH,GAAG;QACH,GAAG;IACP;AACJ;AAEO,SAAS;;IACZ,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,yKAAQ,EAAQ;QAAC,GAAG;QAAG,GAAG;QAAG,GAAG;QAAG,GAAG;IAAG;IAC7D,MAAM,WAAW,IAAA,uKAAM,EAAQ;IAC/B,MAAM,WAAW,IAAA,uKAAM,EAAgB;IAGvC,IAAA,0KAAS;kCAAC;YACN,IAAI,QAAuB;YAC3B,IAAI,OAAO,SAAS,OAAO;YAC3B,IAAI,KAAK;YACT,MAAM,WAAW;YAEjB,MAAM;kDAAU,CAAC;oBACb,IAAI,CAAC,OAAO,QAAQ;oBACpB,MAAM,IAAI,KAAK,GAAG,CAAC,CAAC,OAAO,KAAK,IAAI,UAAU;oBAC9C,MAAM,OAAO,SAAS,MAAM,IAAI;oBAEhC,SAAS,OAAO,GAAG;oBACnB,MAAM;oBAEN,IAAI,IAAI,GAAG;wBACP,SAAS,OAAO,GAAG,sBAAsB;oBAC7C,OAAM;wBACF,OAAO;wBACP,KAAK;wBACL,QAAQ;wBACR,SAAS,OAAO,GAAG,sBAAsB;oBAC7C;gBACJ;;YACA,SAAS,OAAO,GAAG,sBAAsB;YAEzC;0CAAO;oBACH,IAAI,SAAS,OAAO,EAAE,qBAAqB,SAAS,OAAO;gBAC/D;;QACJ;iCAAE,EAAE;IAEJ,OAAO;QACH;IACJ;AACJ;GAvCgB"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/utils/supabase/alSupabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,0LAAY"}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/utils/messages.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\nimport { error } from \"console\";\r\nimport { ItemDto } from \"../types/type\";\r\n\r\nexport async function getInboxMessages(userId: string){\r\n    const {data, error} = await supabase\r\n        .from(\"messages_safe\")\r\n        .select(`\r\n            *\r\n            `)\r\n        .eq(\"to_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    if(error) throw error;  \r\n\r\n    const messages = (data || []).map(msg => {\r\n        const anonSetting = msg.user_anonymous_settings?.[0]?.is_anon\r\n        return {\r\n            ...msg,\r\n            displayId: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_public_id,\r\n            username: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_username\r\n        }\r\n    })\r\n\r\n    return messages \r\n}\r\n\r\nexport async function getCurrentMessage(messageId: string, userId: string) {\r\n    const {data, error} = await supabase\r\n    .from(\"messages_safe\")\r\n    .select(\"*\")\r\n    .eq(\"id\", messageId)\r\n    .eq(\"to_user\", userId)\r\n    .single()\r\n    if (error) throw error\r\n    return data || []\r\n}\r\n\r\nexport async function getSentMessages(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from('messages_safe')\r\n        .select(`\r\n            *`)\r\n        .eq(\"from_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    \r\n    if(error) throw error\r\n    return data || []\r\n\r\n}\r\n\r\nexport async function sendMessage({\r\n    fromUserId,\r\n    toUserId,\r\n    toPublicId,\r\n    body,\r\n    isAnon\r\n}: {\r\n    fromUserId: string,\r\n    toUserId?: string,\r\n    toPublicId?: string,\r\n    body: ItemDto[],\r\n    isAnon?: boolean\r\n}) {\r\n    let receiverId = toUserId\r\n\r\n    if (!receiverId){\r\n        if (!toPublicId) throw new Error(\"Не указан пользователь, малыш\")\r\n            const {data: receiver, error: userError} = await supabase\r\n                .from(\"users\") \r\n                .select(\"id_user\")\r\n                .eq(\"public_id\", toPublicId)\r\n                .single()\r\n            if(userError || !receiver){\r\n                throw new Error(\"Пользователь не найден, кись\")\r\n            }\r\n        receiverId = receiver.id_user\r\n    }\r\n\r\n    const {error: settingError} = await supabase\r\n        .from(\"user_anonymous_settings\")\r\n        .upsert(\r\n            [{\r\n                from_user_id: fromUserId,\r\n                to_user_id: receiverId,\r\n                is_anon: isAnon\r\n            }], \r\n            { \r\n                onConflict: 'from_user_id,to_user_id'\r\n            }\r\n        );\r\n    if(settingError) throw settingError\r\n\r\n    const {error: messageError} = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n            from_user: fromUserId,\r\n            to_user: receiverId,\r\n            body,\r\n        })\r\n    if(messageError) throw messageError\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAIO,eAAe,iBAAiB,MAAc;IACjD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;;YAEL,CAAC,EACJ,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IACzC,IAAG,OAAO,MAAM;IAEhB,MAAM,WAAW,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAA;QAC9B,MAAM,cAAc,IAAI,uBAAuB,EAAE,CAAC,EAAE,EAAE;QACtD,OAAO;YACH,GAAG,GAAG;YACN,WAAW,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,cAAc;YACrE,UAAU,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,aAAa;QACvE;IACJ;IAEA,OAAO;AACX;AAEO,eAAe,kBAAkB,SAAiB,EAAE,MAAc;IACrE,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,WAAW,QACd,MAAM;IACP,IAAI,OAAO,MAAM;IACjB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,gBAAgB,MAAc;IAChD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;aACJ,CAAC,EACL,EAAE,CAAC,aAAa,QAChB,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IAEzC,IAAG,OAAO,MAAM;IAChB,OAAO,QAAQ,EAAE;AAErB;AAEO,eAAe,YAAY,EAC9B,UAAU,EACV,QAAQ,EACR,UAAU,EACV,IAAI,EACJ,MAAM,EAOT;IACG,IAAI,aAAa;IAEjB,IAAI,CAAC,YAAW;QACZ,IAAI,CAAC,YAAY,MAAM,IAAI,MAAM;QAC7B,MAAM,EAAC,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAC,GAAG,MAAM,8IAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC,WACP,EAAE,CAAC,aAAa,YAChB,MAAM;QACX,IAAG,aAAa,CAAC,UAAS;YACtB,MAAM,IAAI,MAAM;QACpB;QACJ,aAAa,SAAS,OAAO;IACjC;IAEA,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,2BACL,MAAM,CACH;QAAC;YACG,cAAc;YACd,YAAY;YACZ,SAAS;QACb;KAAE,EACF;QACI,YAAY;IAChB;IAER,IAAG,cAAc,MAAM;IAEvB,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,YACL,MAAM,CAAC;QACJ,WAAW;QACX,SAAS;QACT;IACJ;IACJ,IAAG,cAAc,MAAM;AAC3B"}},
    {"offset": {"line": 179, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useMessages.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from \"react\"\r\nimport { getInboxMessages, getSentMessages, sendMessage, getCurrentMessage } from \"../utils/messages\"\r\nimport { ItemDto, Message } from \"../types/type\"\r\n\r\n\r\n\r\nexport function useMessages(userId: string | null) {\r\n    const [inbox, setInbox] = useState<any[]>([])\r\n    const [sent, setSent] = useState<any[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n\r\n    const loadMessage = async () => {\r\n        if(!userId) return\r\n\r\n        try{\r\n            setLoading(true)\r\n            const [inboxData, sentData] = await Promise.all([\r\n                getInboxMessages(userId), \r\n                getSentMessages(userId)\r\n            ])\r\n\r\n            setInbox(inboxData)\r\n            setSent(sentData)\r\n        } catch (error) {\r\n            console.error(\"Error loading messages:\", error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadMessage()\r\n    },[userId])\r\n\r\n    const send = async (\r\n        to: {publicId?: string, userId?: string}, \r\n        body: ItemDto[],\r\n        isAnon?: boolean \r\n    ) => {\r\n        if(!userId) throw new Error(\"User not logged in\")\r\n        \r\n        await sendMessage({\r\n            fromUserId: userId,\r\n            toUserId: to.userId,\r\n            toPublicId: to.publicId, \r\n            body, \r\n            isAnon\r\n        })\r\n\r\n        await loadMessage()\r\n    }\r\n\r\n    return {\r\n        inbox,\r\n        sent,\r\n        loading,\r\n        sendMessage: send,\r\n        refresh: loadMessage\r\n    }\r\n\r\n}\r\n\r\ntype UseCurrentMessageResult = {\r\n    message: Message | null,\r\n    loading: boolean\r\n}\r\nexport function useCurrentMessage(\r\n    userId: string | null, \r\n    messageId: string | null\r\n): UseCurrentMessageResult {\r\n    const [message, setMessage] = useState<Message | null>(null)\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    useEffect(() => {\r\n        if (!userId || !messageId) return\r\n\r\n        const loadMessage = async () => {\r\n            setLoading(true)\r\n            try{\r\n                const data = await getCurrentMessage(messageId, userId)\r\n                setMessage(data)\r\n            } catch (error) {\r\n                console.error(\"Error loading messages:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadMessage()\r\n\r\n    }, [userId, messageId])\r\n\r\n    return {\r\n        message,\r\n        loading\r\n    }\r\n}\r\n\r\n\r\n\r\ntype Dialog = {\r\n    userId: string,\r\n    displayId: string,\r\n\r\n    lastMessage: Message,\r\n    messages: Message[],\r\n    count: number\r\n}\r\n\r\nexport function useDialogs(\r\n    inboxMessages: Message[],\r\n    sentMessages: Message[],\r\n    myUserId: string\r\n) {\r\n    const dialogs = useMemo<Dialog[]>(() => {\r\n        const map = new Map<string, Dialog>()\r\n\r\n        const allMessages = [...inboxMessages, ...sentMessages]\r\n\r\n        for (const msg of allMessages){\r\n            const dialogUserId = msg.from_user === myUserId\r\n                ? msg.to_user\r\n                : msg.from_user\r\n\r\n            let displayId = ''\r\n            if(msg.from_display_id === 'A'){\r\n                displayId = 'Anon'\r\n            } else{ \r\n                displayId = msg.to_display_id\r\n            }\r\n\r\n            if(!map.has(dialogUserId)) {\r\n                map.set(dialogUserId, {\r\n                    userId: dialogUserId,\r\n                    displayId: displayId,\r\n\r\n                    lastMessage: msg,\r\n                    messages: [msg],\r\n                    count: 1\r\n                })\r\n            } else{\r\n                const dialog = map.get(dialogUserId)!\r\n                dialog.messages.push(msg)\r\n                dialog.count++\r\n\r\n                if(\r\n                    new Date(msg.created_at) >\r\n                    new Date(dialog.lastMessage.created_at)\r\n                ){\r\n                    dialog.lastMessage = msg\r\n                }\r\n            }\r\n        }\r\n\r\n        return Array.from(map.values()).sort(\r\n            (a,b) =>\r\n                new Date(b.lastMessage.created_at).getTime() -\r\n                new Date(a.lastMessage.created_at).getTime()\r\n        )\r\n    }, [inboxMessages, sentMessages, myUserId])\r\n\r\n    return dialogs\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 328, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/utils/auth.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\n\r\nexport async function getCurrentUser() {\r\n    const {data, error} = await supabase.auth.getUser()\r\n    if(error) return\r\n    return data.user\r\n}\r\n\r\nexport async function getUserProfile(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from(\"users\")\r\n        .select(\"public_id, username\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error) return null\r\n    return data\r\n}\r\n\r\nexport async function sighOut() {\r\n    const {error} = await supabase.auth.signOut()\r\n    if(error) throw error\r\n}\r\n\r\nexport function onAuthStateChange(callback: (user:any) => void) {\r\n    const {data: listener} = supabase.auth.onAuthStateChange((event,session) => {\r\n        callback(session?.user || null)\r\n    })\r\n    return listener.subscription\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IAClB,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IACjD,IAAG,OAAO;IACV,OAAO,KAAK,IAAI;AACpB;AAEO,eAAe,eAAe,MAAc;IAC/C,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,OAAO,OAAO;IACjB,OAAO;AACX;AAEO,eAAe;IAClB,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IAC3C,IAAG,OAAO,MAAM;AACpB;AAEO,SAAS,kBAAkB,QAA4B;IAC1D,MAAM,EAAC,MAAM,QAAQ,EAAC,GAAG,8IAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAM;QAC5D,SAAS,SAAS,QAAQ;IAC9B;IACA,OAAO,SAAS,YAAY;AAChC"}},
    {"offset": {"line": 367, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useAuth.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getCurrentUser, getUserProfile, onAuthStateChange } from \"../utils/auth\"\r\n\r\nexport function useAuth() {\r\n    const [user, setUser] = useState<any>(null)\r\n    const [profile, setProfile] = useState<any>(null)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        const loadUser = async () => {\r\n            try {\r\n                const userData = await getCurrentUser()\r\n                setUser(userData)\r\n\r\n                if(userData) {\r\n                    const profileData = await getUserProfile(userData.id)\r\n                    setProfile(profileData)\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Error loading user:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadUser()\r\n\r\n        const subscription = onAuthStateChange(async (newUser) => {\r\n            setUser(newUser)\r\n            if (newUser) {\r\n                const profileData = await getUserProfile(newUser.id)\r\n                setProfile(profileData)\r\n            } else {\r\n                setProfile(null)\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            subscription.unsubscribe()\r\n        }\r\n    },[])\r\n\r\n    return {user,profile,loading}\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKO,SAAS;;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAM;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;6BAAC;YACN,MAAM;8CAAW;oBACb,IAAI;wBACA,MAAM,WAAW,MAAM,IAAA,+JAAc;wBACrC,QAAQ;wBAER,IAAG,UAAU;4BACT,MAAM,cAAc,MAAM,IAAA,+JAAc,EAAC,SAAS,EAAE;4BACpD,WAAW;wBACf;oBACJ,EAAE,OAAO,OAAO;wBACZ,QAAQ,KAAK,CAAC,uBAAuB;oBACzC,SAAU;wBACN,WAAW;oBACf;gBACJ;;YACA;YAEA,MAAM,eAAe,IAAA,kKAAiB;kDAAC,OAAO;oBAC1C,QAAQ;oBACR,IAAI,SAAS;wBACT,MAAM,cAAc,MAAM,IAAA,+JAAc,EAAC,QAAQ,EAAE;wBACnD,WAAW;oBACf,OAAO;wBACH,WAAW;oBACf;gBACJ;;YAEA;qCAAO;oBACH,aAAa,WAAW;gBAC5B;;QACJ;4BAAE,EAAE;IAEJ,OAAO;QAAC;QAAK;QAAQ;IAAO;AAChC;GAvCgB"}},
    {"offset": {"line": 433, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/createcard/btnFunction.ts"],"sourcesContent":["\r\nimport React from \"react\"\r\nimport { Item } from \"../things/types/type\"\r\n\r\nexport const createText = (setItems: React.Dispatch<React.SetStateAction<Item[]>>) => {\r\n        setItems(prev => [...prev, {\r\n            id: prev.length,\r\n            type: \"text\",\r\n            content: `new text ${prev.length + 1}`,\r\n            x: 0 ,\r\n            y: 0 + prev.length * 20,\r\n            w: 100,\r\n            h: 50,\r\n            fontSize: 16,\r\n            scaleX: 1,\r\n            scaleY: 1,\r\n            rotation: 0,\r\n            isEditing: 'none'\r\n        }])\r\n    }"],"names":[],"mappings":";;;;AAIO,MAAM,aAAa,CAAC;IACnB,SAAS,CAAA,OAAQ;eAAI;YAAM;gBACvB,IAAI,KAAK,MAAM;gBACf,MAAM;gBACN,SAAS,CAAC,SAAS,EAAE,KAAK,MAAM,GAAG,GAAG;gBACtC,GAAG;gBACH,GAAG,IAAI,KAAK,MAAM,GAAG;gBACrB,GAAG;gBACH,GAAG;gBACH,UAAU;gBACV,QAAQ;gBACR,QAAQ;gBACR,UAAU;gBACV,WAAW;YACf;SAAE;AACN"}},
    {"offset": {"line": 463, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/createcard/useItemInteractions.ts"],"sourcesContent":["import { Item, Viewport } from \"../things/types/type\"\r\nimport { useRef }from \"react\"\r\n\r\ntype ResizeDirection = \"horizontal\" | \"top\" | \"bottom\" | \"diagonal\"\r\n\r\ntype DragRef = {\r\n    id: number | null\r\n    offsetX: number\r\n    offsetY: number\r\n    w: number\r\n    h: number\r\n}\r\n\r\ntype ResizeRef = {\r\n    id: number | null\r\n    startX: number\r\n    startY: number\r\n    startW: number\r\n    startH: number\r\n    fontSize?: number\r\n    direction: ResizeDirection\r\n}\r\n\r\n\r\n\r\nexport const userItemInteractions = (\r\n    items: Item[], \r\n    setItems: React.Dispatch<React.SetStateAction<Item[]>>, \r\n    fieldRef: React.RefObject<HTMLDivElement | null>,\r\n    viewport: Viewport\r\n) => {\r\n    const dragRef = useRef<DragRef>({id: null, offsetX: 0, offsetY: 0, w: 0, h: 0})\r\n    const resizeRef = useRef<ResizeRef>({id: null, startX: 0, startY: 0, startW: 0, startH: 0, fontSize: 0, direction: \"horizontal\"})\r\n\r\n    function screenToCanvas(\r\n        clientX: number,\r\n        clientY: number,\r\n        rect: DOMRect,\r\n        viewport: Viewport\r\n    ){\r\n        return {\r\n            x: (clientX - rect.left - viewport.offsetX) / viewport.scale,\r\n            y: (clientY - rect.top - viewport.offsetY) / viewport.scale\r\n        }\r\n    }\r\n\r\n    function getTouchCoordinates(e: TouchEvent): { clientX: number; clientY: number } | null {\r\n        if (e.touches.length === 0) return null\r\n        const touch = e.touches[0]\r\n        return { clientX: touch.clientX, clientY: touch.clientY }\r\n    }\r\n    \r\n    const startDrag = (e: React.MouseEvent<HTMLDivElement> | React.TouchEvent<HTMLDivElement>, item: Item) => {\r\n        const rect = fieldRef!.current!.getBoundingClientRect()\r\n        \r\n        let clientX: number, clientY: number\r\n        \r\n        if ('touches' in e) {\r\n            if (e.touches.length === 0) return\r\n            clientX = e.touches[0].clientX\r\n            clientY = e.touches[0].clientY\r\n        } else {\r\n            clientX = e.clientX\r\n            clientY = e.clientY\r\n        }\r\n        \r\n        const pos = screenToCanvas(clientX, clientY, rect, viewport)\r\n        dragRef.current = {\r\n            id: item.id,\r\n            offsetX: pos.x - item.x,\r\n            offsetY: pos.y - item.y,\r\n            w: item.w,\r\n            h: item.h\r\n        }\r\n\r\n        window.addEventListener('mousemove', onDragMove)\r\n        window.addEventListener('mouseup', stopDrag)\r\n        window.addEventListener('touchmove', onDragMove as any)\r\n        window.addEventListener('touchend', stopDrag)\r\n    }\r\n    const onDragMove = (e: MouseEvent | TouchEvent) => {\r\n        if(resizeRef.current.id !== null) return;\r\n\r\n        const rect = fieldRef!.current!.getBoundingClientRect()\r\n        const drag = dragRef.current\r\n        \r\n        let clientX: number, clientY: number\r\n        \r\n        if (e instanceof TouchEvent) {\r\n            if (e.touches.length === 0) return\r\n            clientX = e.touches[0].clientX\r\n            clientY = e.touches[0].clientY\r\n        } else {\r\n            clientX = e.clientX\r\n            clientY = e.clientY\r\n        }\r\n        \r\n        const pos = screenToCanvas(clientX, clientY, rect, viewport)\r\n        if (drag.id === null) return;\r\n\r\n        setItems(prev => prev.map(it => it.id === drag.id \r\n            ? {...it, \r\n                x: pos.x - drag.offsetX, \r\n                y: pos.y - drag.offsetY\r\n            } \r\n            : it))\r\n    }\r\n    const stopDrag = () => {\r\n        dragRef.current.id = null\r\n        window.removeEventListener('mousemove', onDragMove)\r\n        window.removeEventListener('mouseup', stopDrag)\r\n        window.removeEventListener('touchmove', onDragMove as any)\r\n        window.removeEventListener('touchend', stopDrag)\r\n    }\r\n\r\n\r\n    //resize\r\n    const startResize = (e: React.MouseEvent<HTMLDivElement> | React.TouchEvent<HTMLDivElement>, item: Item, direction: ResizeDirection) => {\r\n        e.stopPropagation()\r\n        \r\n        let clientX: number, clientY: number\r\n        \r\n        if ('touches' in e) {\r\n            if (e.touches.length === 0) return\r\n            clientX = e.touches[0].clientX\r\n            clientY = e.touches[0].clientY\r\n        } else {\r\n            clientX = e.clientX\r\n            clientY = e.clientY\r\n        }\r\n        \r\n        resizeRef.current = {\r\n            id: item.id,\r\n            startX: clientX,\r\n            startY: clientY,\r\n            startW: item.w,\r\n            startH: item.h,\r\n            fontSize: item.fontSize,\r\n            direction: direction\r\n        }\r\n        window.addEventListener('mousemove', onResizeMove)\r\n        window.addEventListener('mouseup', stopResize)\r\n        window.addEventListener('touchmove', onResizeMove as any)\r\n        window.addEventListener('touchend', stopResize)\r\n    }\r\n\r\n    const onResizeMove = (e: MouseEvent | TouchEvent) => {\r\n        const r = resizeRef.current\r\n        if (r.id === null) return;\r\n\r\n        let clientX: number, clientY: number\r\n        \r\n        if (e instanceof TouchEvent) {\r\n            if (e.touches.length === 0) return\r\n            clientX = e.touches[0].clientX\r\n            clientY = e.touches[0].clientY\r\n        } else {\r\n            clientX = e.clientX\r\n            clientY = e.clientY\r\n        }\r\n\r\n        const dx = (clientX - r.startX) / viewport.scale\r\n        const dy = (clientY - r.startY) / viewport.scale\r\n\r\n        let w = r.startW\r\n        let h = r.startH\r\n        let fontSize = r.fontSize\r\n\r\n        if (r.direction === \"horizontal\") {\r\n            w = Math.max(50, r.startW + dx);\r\n        }\r\n        if(r.direction === \"top\") {\r\n            h = Math.max(30, r.startH + dy);\r\n        }\r\n        if (r.direction === \"bottom\") {\r\n            h = Math.max(30, r.startH + dy);\r\n        }\r\n        if (r.direction === \"diagonal\") {\r\n            w = Math.max(50, r.startW + dx);\r\n            h = Math.max(30, r.startH + dy);\r\n            fontSize = Math.max(2, r.fontSize! + (dx+dy) / 5);\r\n        }\r\n\r\n        // console.log(\"resize direction:\", r.direction, \"w:\", w, \"h:\", h, \"fontSize:\", fontSize)\r\n        setItems(prev => prev.map(it => it.id === r.id ? {...it, w, h, fontSize} : it))\r\n    }\r\n\r\n    const stopResize = () => {\r\n        resizeRef.current.id = null\r\n        window.removeEventListener('mousemove', onResizeMove)\r\n        window.removeEventListener('mouseup', stopResize)\r\n        window.removeEventListener('touchmove', onResizeMove as any)\r\n        window.removeEventListener('touchend', stopResize)\r\n    }\r\n\r\n\r\n\r\n    //delete\r\n    const deleteItem = (item: Item) => {\r\n        setItems(prev => prev.filter(it => it.id !== item.id))\r\n    }\r\n\r\n    return {startDrag, startResize, deleteItem}\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 644, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/checkMobile.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\n\r\nexport function useCheckMobile(breakPoint = 768) {\r\n    const [isMobile, setIsMobile] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const check = () => {\r\n            setIsMobile(window.innerWidth <= 768)\r\n        }\r\n        check()\r\n        window.addEventListener('resize', check)\r\n        return () => window.removeEventListener('resize', check)\r\n    },[breakPoint])\r\n\r\n    return isMobile\r\n}"],"names":[],"mappings":";;;;AAAA;;;AAEO,SAAS,eAAe,aAAa,GAAG;;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,IAAA,0KAAS;oCAAC;YACN,MAAM;kDAAQ;oBACV,YAAY,OAAO,UAAU,IAAI;gBACrC;;YACA;YACA,OAAO,gBAAgB,CAAC,UAAU;YAClC;4CAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;;QACtD;mCAAE;QAAC;KAAW;IAEd,OAAO;AACX;GAbgB"}},
    {"offset": {"line": 680, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/createcard/CreateCardClient.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState,useEffect, useRef } from \"react\"\r\nimport { useSearchParams } from \"next/navigation\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nimport { useRandColor } from \"./useRandColor\";\r\nimport { useMessages } from \"../things/hooks/useMessages\";\r\nimport { useAuth } from \"../things/hooks/useAuth\";\r\nimport {useCurrentMessage} from \"../things/hooks/useMessages\"\r\n\r\nimport { Item, Viewport } from \"../things/types/type\";\r\n\r\nimport { createText } from \"./btnFunction\";\r\nimport { userItemInteractions } from \"./useItemInteractions\";\r\nimport { useCheckMobile } from \"../things/hooks/checkMobile\";\r\n\r\ntype MessageData = {\r\n    items: Item[]\r\n}\r\ntype TypeData = {\r\n    type: string\r\n}\r\n\r\nexport default function CreateCardPage({initialData}: {initialData?: MessageData}) {\r\n    const searchParams = useSearchParams()\r\n    const rawTo = searchParams.get(\"to\")\r\n    const to = rawTo ? decodeURIComponent(rawTo) : null\r\n    const [messageId, setMessageId] = useState<string | null>(null) // получаем из url\r\n    const [isReply, setIsReply] = useState(false)\r\n\r\n    // тип перехода send или recieve\r\n    const type = searchParams.get(\"type\")\r\n    const [messageType, setMessageType] = useState<TypeData | null>(null)\r\n\r\n    const isMobile = useCheckMobile()\r\n\r\n    const {user, profile, loading: authLoading} = useAuth();\r\n    const {inbox, sent, sendMessage: send, loading: messageLoading} = useMessages(user?.id || null);\r\n    const router = useRouter()\r\n\r\n    const [items, setItems] = useState<Item[]>(initialData?.items || [])\r\n    const fieldRef = useRef<HTMLDivElement>(null)\r\n    const [viewport, setViewport] = useState<Viewport>({\r\n        scale: 1,\r\n        offsetX: 0,\r\n        offsetY: 0\r\n    })\r\n\r\n    const [rightPanelOpen, setRightPanelOpen] = useState(false)\r\n    const idRef = useRef<HTMLInputElement>(null)\r\n    const anonRef = useRef<HTMLInputElement>(null)\r\n    const [isAnon, setIsAnon] = useState(false)\r\n\r\n    const [ismenuTextOpen, setMenuTextOpen] = useState(false)\r\n    \r\n    const touchDistanceRef = useRef<number | null>(null)\r\n\r\n    const {startDrag, startResize, deleteItem} = userItemInteractions(items, setItems, fieldRef, viewport)\r\n\r\n\r\n    useEffect(() => {\r\n        if (to){\r\n            setMessageId(to)\r\n            setIsReply(true)\r\n        };\r\n\r\n        if (type){\r\n            setMessageType({type})\r\n        };\r\n    },[to, type])\r\n\r\n    \r\n\r\n        \r\n\r\n    // рандомный фон\r\n    const {bg} = useRandColor()\r\n    const bgStyle = `rgba(${Math.floor(bg.r)}, ${Math.floor(bg.g)}, ${Math.floor(bg.b)}, ${bg.a})`\r\n\r\n    const handleSendMessage = async () => {\r\n        const id = idRef.current?.value || \"\"\r\n        const anonCheckbox = anonRef.current?.checked || false\r\n\r\n        if (!id){\r\n            alert('Введи ID, сладкий!')\r\n            return\r\n        }\r\n        const cleanItems = items.map(({isSelected, isEditing, ...rest}) => rest)\r\n        console.log(\"SEND PAYLOAD\", cleanItems)\r\n        \r\n        try {\r\n            await send({publicId: id}, cleanItems, isAnon)\r\n\r\n            idRef.current!.value = \"\"\r\n            setRightPanelOpen(false)\r\n        } catch (error: any) {\r\n            console.log(error.message || 'Error sending message');\r\n        }\r\n        \r\n    }\r\n\r\n    const handleZoom = (e: React.WheelEvent<HTMLDivElement>) => {\r\n        // e.preventDefault()\r\n\r\n        setViewport(v => ({\r\n            ...v,\r\n            scale: Math.min(3, Math.max(0.3, v.scale - e.deltaY * 0.001))\r\n        }))\r\n    }\r\n\r\n    const getDistanceBetweenTouches = (touch1: Touch, touch2: Touch): number => {\r\n        const dx = touch1.clientX - touch2.clientX\r\n        const dy = touch1.clientY - touch2.clientY\r\n        return Math.sqrt(dx * dx + dy * dy)\r\n    }\r\n\r\n    const handleTouchStart = (e: React.TouchEvent<HTMLDivElement>) => {\r\n        if (e.touches.length === 2) {\r\n            touchDistanceRef.current = getDistanceBetweenTouches(e.touches[0] as Touch, e.touches[1] as Touch)\r\n        }\r\n    }\r\n\r\n    const handleTouchMove = (e: React.TouchEvent<HTMLDivElement>) => {\r\n        if (e.touches.length === 2 && touchDistanceRef.current !== null) {\r\n            e.preventDefault()\r\n            const currentDistance = getDistanceBetweenTouches(e.touches[0] as Touch, e.touches[1] as Touch)\r\n            const distanceDelta = currentDistance - touchDistanceRef.current\r\n            \r\n            setViewport(v => ({\r\n                ...v,\r\n                scale: Math.min(3, Math.max(0.3, v.scale + distanceDelta * 0.01))\r\n            }))\r\n            \r\n            touchDistanceRef.current = currentDistance\r\n        }\r\n    }\r\n\r\n    const handleTouchEnd = () => {\r\n        touchDistanceRef.current = null\r\n    }\r\n\r\n    if (messageType?.type === \"send\") {\r\n        return (\r\n            <div \r\n                className={`relative flex flex-col justify-center items-center h-full overflow-hidden`}\r\n                style={{ \r\n                    backgroundColor: bgStyle\r\n                }}\r\n            >\r\n                {/* field */}\r\n                <div\r\n                    className={`relative border  rounded-md bg-white overflow-hidden z-10\r\n                        ${isMobile ? \"w-full h-1/2\" : \"w-1/2 h-1/2\"}\r\n                        `}\r\n                    ref={fieldRef}\r\n                    onMouseDown={(e) =>{\r\n                        if(e.target !== e.currentTarget) return;\r\n                        setItems(prev => prev.map(it => ({...it, isSelected: false, isEditing: 'none'})))\r\n                    }}\r\n                    onWheel={handleZoom}\r\n                    onTouchStart={handleTouchStart}\r\n                    onTouchMove={handleTouchMove}\r\n                    onTouchEnd={handleTouchEnd}\r\n                    style={{\r\n                        transform: `\r\n                        translate(${viewport.offsetX}px, ${viewport.offsetY}px)\r\n                        scale(${viewport.scale})\r\n                        `,\r\n                        transformOrigin: \"center center\"\r\n                    }}\r\n                >\r\n                    {items.map((item,i) => (\r\n                        <div \r\n                            key={item.id}\r\n                            className={`flex \r\n                                    text-black select-none relative \r\n                                    ${item.isSelected && item.isEditing !== 'text' ? \"border\": \"\"}\r\n                                    `}\r\n                            style={{\r\n                                position: \"absolute\",\r\n                                left: item.x,\r\n                                top: item.y,\r\n                                width: item.w,\r\n                                height: item.h,\r\n                                fontSize: item.fontSize,\r\n                                cursor: item.isSelected ? \"move\" : \"pointer\",\r\n                            }}\r\n                        onDoubleClick={() => {\r\n                            setItems(prev => prev.map(it => it.id === item.id ? {...it, isEditing: \"text\"} : it))\r\n                        }}\r\n                        onMouseDown={(e) => {\r\n                            startDrag(e,item)\r\n                            setItems(prev => prev.map(it => ({...it, isSelected: it.id === item.id})))\r\n                        }}\r\n                        onTouchStart={(e) => {\r\n                            startDrag(e,item)\r\n                            setItems(prev => prev.map(it => ({...it, isSelected: it.id === item.id})))\r\n                        }}\r\n                        \r\n                        >\r\n                            {item.isEditing === \"text\" \r\n                            ?(\r\n                                <input\r\n                                    autoFocus\r\n                                    value={item.content}\r\n                                    onChange={(e) => {\r\n                                        setItems(prev => prev.map(it => it.id === item.id \r\n                                            ? {...it, content: e.target.value} \r\n                                            : it))\r\n                                    }}\r\n                                    onBlur={() => {\r\n                                        setItems(prev => prev.map(it => it.id === item.id \r\n                                            ? {...it, isEditing: 'none'}\r\n                                            : it\r\n                                        ))\r\n                                    }}\r\n                                    onKeyDown={(e) => {\r\n                                        if(e.key === \"Enter\") e.currentTarget.blur()\r\n                                    }}\r\n                                >\r\n                                \r\n                                </input>\r\n    \r\n                            ): (\r\n                                <div className={`relative w-full h-full text-wrap wrap-break-word flex \r\n                                                ${item.isSelected ? \" \" : \"overflow-hidden\" }`}> \r\n                                    {item.content}\r\n    \r\n                                    {item.isSelected && (\r\n                                        <div className=\"\">\r\n    \r\n                                            {/* menu */}\r\n                                            <div\r\n                                                className=\"absolute -top-1.5 -right-2.5 \"\r\n                                            >   \r\n                                                <div className=\"relative\"> \r\n                                                    <svg \r\n                                                        onClick={(e) => {\r\n                                                            if(ismenuTextOpen) setMenuTextOpen(false);\r\n                                                            else setMenuTextOpen(true)\r\n                                                            e.stopPropagation()\r\n                                                        }}\r\n                                                        className=\"hover:scale-110 transition-transform cursor-pointer\"\r\n                                                        xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 32 32\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 8h24M4 16h24M4 24h24\"/></svg>\r\n                                                    <div\r\n                                                        className={`absolute top-1 left-full text-[9px] bg-black/20 rounded-md w-15 h-15 flex flex-col\r\n                                                            ${ismenuTextOpen ? \"opacity-100\" : \"opacity-0\"} transition-opacity`}\r\n                                                    >\r\n                                                        <button \r\n                                                            className=\"hover:bg-black/10 transition-colors\" \r\n                                                            onClick={() => {deleteItem(item)}}>\r\n                                                            Удалить\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n    \r\n                                            {/* resize */}\r\n                                            <div \r\n                                                onMouseDown={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"horizontal\")\r\n                                                }}\r\n                                                onTouchStart={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"horizontal\")\r\n                                                }}\r\n                                                className=\"absolute -right-1 bottom-1/2 translate-y-1/2 w-1 h-3 bg-white \r\n                                                        border cursor-w-resize\"> \r\n    \r\n                                            </div>\r\n    \r\n                                            <div \r\n                                                onMouseDown={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"top\")\r\n                                                }}\r\n                                                onTouchStart={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"top\")\r\n                                                }}\r\n                                                className=\"absolute -top-1 left-1/2 -translate-x-1/2 w-3 h-1 bg-white \r\n                                                        border cursor-s-resize\"> \r\n    \r\n                                            </div>\r\n    \r\n                                            <div \r\n                                                onMouseDown={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"bottom\")\r\n                                                }}\r\n                                                onTouchStart={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"bottom\")\r\n                                                }}\r\n                                                className=\"absolute -bottom-1 left-1/2 -translate-x-1/2 w-3 h-1 bg-white \r\n                                                        border cursor-s-resize\"> \r\n    \r\n                                            </div>\r\n    \r\n                                            <div \r\n                                                onMouseDown={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"diagonal\")\r\n                                                }}\r\n                                                onTouchStart={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    startResize(e, item, \"diagonal\")\r\n                                                }}\r\n                                                className=\"absolute -bottom-1.5 -right-1.5  w-2 h-2 bg-white \r\n                                                        border cursor-se-resize\"> \r\n    \r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n    \r\n                        </div>\r\n                    ))}\r\n                </div>\r\n    \r\n                <div className=\"flex p-2 mt-10\">\r\n    \r\n                    <button\r\n                        className=\"p-2 border rounded-2xl\"  \r\n                        onClick={() => createText(setItems)}\r\n                    >\r\n                        Text\r\n                    </button>\r\n    \r\n                </div>\r\n    \r\n    \r\n    \r\n                {/* кнопка назад */}\r\n                <div\r\n                    className={`absolute left-0  flex justify-center items-center \r\n                    w-7 rounded-r-full backdrop-blur-md hover:bg-white/20 transition-cursor\r\n                    md:inset-y-0\r\n                    inset-y-60\r\n                    z-20\r\n                    ${isMobile ? \"bg-black/50\" : \"bg-white/10\"}\r\n                    `}\r\n                    \r\n                >\r\n                    <button \r\n                        onClick={() => router.push(\"anonlovemain\")}\r\n                        className=\"w-full h-full \">\r\n                        {`<`}\r\n                    </button>\r\n                </div>\r\n    \r\n    \r\n    \r\n                {/* Кнопка справа */}\r\n                <div\r\n                    className={`absolute right-0  flex justify-center items-center overflow-hidden\r\n                    w-7 rounded-l-full bg-black/50 backdrop-blur-md hover:bg-white/20 transition-cursor\r\n                    md:inset-y-0\r\n                    inset-y-60\r\n                    z-20\r\n                    ${isMobile ? \"bg-black/50\" : \"bg-white/10\"}\r\n                    `}\r\n                    \r\n                >\r\n                    <button \r\n                        onClick={() => {setRightPanelOpen(true)}}\r\n                        className=\"w-full h-full\">\r\n                        {`...`}\r\n                    </button>\r\n    \r\n                </div>\r\n    \r\n                {/* поле отправить */}\r\n                <div\r\n                    className={`fixed inset-0 z-20 bg-black/50 transition-all duration-300 overflow-hidden \r\n                            ${rightPanelOpen ? \"backdrop-blur-lg translate-x-0\" : \"backdrop-blur-none translate-x-full\"}\r\n                        `}\r\n                    onMouseDown={(e) => setRightPanelOpen(false)}\r\n                >\r\n                    <div \r\n                        className=\"absolute right-0 inset-y-0 flex justify-center items-center \r\n                                md:w-[400px] w-full bg-black/90 z-20\"\r\n                        onMouseDown={(e) => {\r\n                            e.stopPropagation()\r\n                        }}\r\n                    >   \r\n                        <form \r\n                            className=\"relative flex flex-col w-full justify-center items-center\"\r\n                            onSubmit={(e) => {\r\n                                e.preventDefault()\r\n                            }}\r\n                            >\r\n                            <input\r\n                                ref={idRef}\r\n                                value={messageId || ''}\r\n                                onChange={(e) => setMessageId(e.target.value)}\r\n                                disabled={isReply}\r\n                                type=\"text\"\r\n                                placeholder=\"ID кисы\"\r\n                                className={`p-2 mb-4 w-1/2 bg-white/10 border rounded-md text-white\r\n                                        ${isReply && \"opacity-50\"}\r\n                                `}\r\n                            />\r\n                            <div className=\"flex w-full justify-center items-center\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    ref={anonRef}\r\n                                    checked={isAnon}\r\n                                    onChange={(e) => {setIsAnon}}\r\n                                    className=\"bg-white/10 border rounded-md text-white\"\r\n                                />\r\n                                <span className=\"text-[10px]\">{`Будешь анонимен? (потом можно изменить)`}</span>\r\n                            </div>\r\n    \r\n                            <button\r\n                                type=\"submit\"\r\n                                className=\"p-2 mt-4 border rounded-2xl hover:bg-white/20 transition-all duration-200\"\r\n                                onClick={handleSendMessage}\r\n                            >\r\n                                Отправить\r\n                            </button>\r\n    \r\n                            <button \r\n                                className=\"absolute left-0 w-10 h-20 bg-white/20 rounded-r-full top-1/2 -translate-y-1/2\r\n                                hover:bg-white/40 transition-all duration-200\r\n                                \"\r\n                                onClick={() => setRightPanelOpen(false)}\r\n                            >\r\n                                {`>`}\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n    \r\n    \r\n            </div>\r\n        )\r\n    } \r\n    if (messageType?.type === \"recieve\"){\r\n        return (\r\n            <div \r\n                className={`relative flex flex-col justify-center items-center h-full overflow-hidden`}\r\n                style={{ \r\n                    backgroundColor: bgStyle\r\n                }}\r\n            >\r\n                {/* field */}\r\n                <div\r\n                    className={`relative border  rounded-md bg-white overflow-hidden z-10\r\n                        ${isMobile ? \"w-full h-1/2\" : \"w-1/2 h-1/2\"}\r\n                        `}\r\n                    ref={fieldRef}\r\n                    \r\n                    onWheel={handleZoom}\r\n                    onTouchStart={handleTouchStart}\r\n                    onTouchMove={handleTouchMove}\r\n                    onTouchEnd={handleTouchEnd}\r\n                    style={{\r\n                        transform: `\r\n                        translate(${viewport.offsetX}px, ${viewport.offsetY}px)\r\n                        scale(${viewport.scale})\r\n                        `,\r\n                        transformOrigin: \"center center\"\r\n                    }}\r\n                >\r\n                    {items.map((item,i) => (\r\n                        <div \r\n                            key={item.id}\r\n                            className={`flex \r\n                                    text-black select-none relative \r\n                                    `}\r\n                            style={{\r\n                                position: \"absolute\",\r\n                                left: item.x,\r\n                                top: item.y,\r\n                                width: item.w,\r\n                                height: item.h,\r\n                                fontSize: item.fontSize,\r\n                                cursor: item.isSelected ? \"move\" : \"pointer\",\r\n                            }}\r\n                        >\r\n                            <div className={`relative w-full h-full text-wrap wrap-break-word flex \r\n                                            ${item.isSelected ? \" \" : \"overflow-hidden\" }`}> \r\n                                {item.content}\r\n\r\n                            </div>\r\n    \r\n                        </div>\r\n                    ))}\r\n                </div>\r\n    \r\n    \r\n                {/* кнопка назад */}\r\n                <div\r\n                    className={`absolute left-0  flex justify-center items-center \r\n                    w-7 rounded-r-full backdrop-blur-md hover:bg-white/20 transition-cursor\r\n                    md:inset-y-0\r\n                    inset-y-60\r\n                    z-20\r\n                    ${isMobile ? \"bg-black/50\" : \"bg-white/10\"}\r\n                    `}\r\n                    \r\n                >\r\n                    <button \r\n                        onClick={() => router.push(\"anonlovemain\")}\r\n                        className=\"w-full h-full \">\r\n                        {`<`}\r\n                    </button>\r\n                </div>\r\n    \r\n    \r\n    \r\n                {/* Кнопка справа */}\r\n                <div\r\n                    className={`absolute right-0  flex justify-center items-center overflow-hidden\r\n                    w-7 rounded-l-full bg-black/50 backdrop-blur-md hover:bg-white/20 transition-cursor\r\n                    md:inset-y-0\r\n                    inset-y-60\r\n                    z-20\r\n                    ${isMobile ? \"bg-black/50\" : \"bg-white/10\"}\r\n                    `}\r\n                    \r\n                >\r\n                    <button \r\n                        onClick={() => {setRightPanelOpen(true)}}\r\n                        className=\"w-full h-full\">\r\n                        {`...`}\r\n                    </button>\r\n    \r\n                </div>\r\n    \r\n                {/* поле отправить */}\r\n                <div\r\n                    className={`fixed inset-0 z-20 bg-black/50 transition-all duration-300 overflow-hidden \r\n                            ${rightPanelOpen ? \"backdrop-blur-lg translate-x-0\" : \"backdrop-blur-none translate-x-full\"}\r\n                        `}\r\n                    onMouseDown={(e) => setRightPanelOpen(false)}\r\n                >\r\n                    <div \r\n                        className=\"absolute right-0 inset-y-0 flex justify-center items-center \r\n                                md:w-[400px] w-full bg-black/90 z-20\"\r\n                        onMouseDown={(e) => {\r\n                            e.stopPropagation()\r\n                        }}\r\n                    >   \r\n                        <form \r\n                            className=\"relative flex flex-col w-full justify-center items-center\"\r\n                            onSubmit={(e) => {\r\n                                e.preventDefault()\r\n                            }}\r\n                            >\r\n                            <input\r\n                                ref={idRef}\r\n                                value={messageId || ''}\r\n                                onChange={(e) => setMessageId(e.target.value)}\r\n                                disabled={isReply}\r\n                                type=\"text\"\r\n                                placeholder=\"ID кисы\"\r\n                                className={`p-2 mb-4 w-1/2 bg-white/10 border rounded-md text-white\r\n                                        ${isReply && \"opacity-50\"}\r\n                                `}\r\n                            />\r\n                            <div className=\"flex w-full justify-center items-center\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    ref={anonRef}\r\n                                    checked={isAnon}\r\n                                    onChange={(e) => {setIsAnon}}\r\n                                    className=\"bg-white/10 border rounded-md text-white\"\r\n                                />\r\n                                <span className=\"text-[10px]\">{`Будешь анонимен? (потом можно изменить)`}</span>\r\n                            </div>\r\n    \r\n                            <button\r\n                                type=\"submit\"\r\n                                className=\"p-2 mt-4 border rounded-2xl hover:bg-white/20 transition-all duration-200\"\r\n                                onClick={handleSendMessage}\r\n                            >\r\n                                Отправить\r\n                            </button>\r\n    \r\n                            <button \r\n                                className=\"absolute left-0 w-10 h-20 bg-white/20 rounded-r-full top-1/2 -translate-y-1/2\r\n                                hover:bg-white/40 transition-all duration-200\r\n                                \"\r\n                                onClick={() => setRightPanelOpen(false)}\r\n                            >\r\n                                {`>`}\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n    \r\n    \r\n            </div>\r\n        )\r\n    }\r\n\r\n}"],"names":[],"mappings":"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"}}]
}