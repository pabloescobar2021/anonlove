{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/data.ts"],"sourcesContent":["\r\nexport const size = {\r\n    width: 200,\r\n    height: 200,\r\n}\r\n\r\nexport const step = {\r\n    s: 100,\r\n    c: 10\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;AACO,MAAM,OAAO;IAChB,OAAO;IACP,QAAQ;AACZ;AAEO,MAAM,OAAO;IAChB,GAAG;IACH,GAAG;AACP"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/utils/supabase/alSupabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,0LAAY"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/utils/auth.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\n\r\nexport async function getCurrentUser() {\r\n    const {data, error} = await supabase.auth.getUser()\r\n    if(error) return\r\n    return data.user\r\n}\r\n\r\nexport async function getUserProfile(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from(\"users\")\r\n        .select(\"public_id, username\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error) return null\r\n    return data\r\n}\r\n\r\nexport async function sighOut() {\r\n    const {error} = await supabase.auth.signOut()\r\n    if(error) throw error\r\n}\r\n\r\nexport function onAuthStateChange(callback: (user:any) => void) {\r\n    const {data: listener} = supabase.auth.onAuthStateChange((event,session) => {\r\n        callback(session?.user || null)\r\n    })\r\n    return listener.subscription\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IAClB,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IACjD,IAAG,OAAO;IACV,OAAO,KAAK,IAAI;AACpB;AAEO,eAAe,eAAe,MAAc;IAC/C,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,OAAO,OAAO;IACjB,OAAO;AACX;AAEO,eAAe;IAClB,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IAC3C,IAAG,OAAO,MAAM;AACpB;AAEO,SAAS,kBAAkB,QAA4B;IAC1D,MAAM,EAAC,MAAM,QAAQ,EAAC,GAAG,8IAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAM;QAC5D,SAAS,SAAS,QAAQ;IAC9B;IACA,OAAO,SAAS,YAAY;AAChC"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useAuth.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getCurrentUser, getUserProfile, onAuthStateChange } from \"../utils/auth\"\r\n\r\nexport function useAuth() {\r\n    const [user, setUser] = useState<any>(null)\r\n    const [profile, setProfile] = useState<any>(null)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        const loadUser = async () => {\r\n            try {\r\n                const userData = await getCurrentUser()\r\n                setUser(userData)\r\n\r\n                if(userData) {\r\n                    const profileData = await getUserProfile(userData.id)\r\n                    setProfile(profileData)\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Error loading user:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadUser()\r\n\r\n        const subscription = onAuthStateChange(async (newUser) => {\r\n            setUser(newUser)\r\n            if (newUser) {\r\n                const profileData = await getUserProfile(newUser.id)\r\n                setProfile(profileData)\r\n            } else {\r\n                setProfile(null)\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            subscription.unsubscribe()\r\n        }\r\n    },[])\r\n\r\n    return {user,profile,loading}\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKO,SAAS;;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAM;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;6BAAC;YACN,MAAM;8CAAW;oBACb,IAAI;wBACA,MAAM,WAAW,MAAM,IAAA,+JAAc;wBACrC,QAAQ;wBAER,IAAG,UAAU;4BACT,MAAM,cAAc,MAAM,IAAA,+JAAc,EAAC,SAAS,EAAE;4BACpD,WAAW;wBACf;oBACJ,EAAE,OAAO,OAAO;wBACZ,QAAQ,KAAK,CAAC,uBAAuB;oBACzC,SAAU;wBACN,WAAW;oBACf;gBACJ;;YACA;YAEA,MAAM,eAAe,IAAA,kKAAiB;kDAAC,OAAO;oBAC1C,QAAQ;oBACR,IAAI,SAAS;wBACT,MAAM,cAAc,MAAM,IAAA,+JAAc,EAAC,QAAQ,EAAE;wBACnD,WAAW;oBACf,OAAO;wBACH,WAAW;oBACf;gBACJ;;YAEA;qCAAO;oBACH,aAAa,WAAW;gBAC5B;;QACJ;4BAAE,EAAE;IAEJ,OAAO;QAAC;QAAK;QAAQ;IAAO;AAChC;GAvCgB"}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/utils/messages.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\nimport { error } from \"console\";\r\nimport { ItemDto } from \"../types/type\";\r\n\r\nexport async function getInboxMessages(userId: string){\r\n    const {data, error} = await supabase\r\n        .from(\"messages_safe\")\r\n        .select(`\r\n            *\r\n            `)\r\n        .eq(\"to_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    if(error) throw error;  \r\n\r\n    const messages = (data || []).map(msg => {\r\n        const anonSetting = msg.user_anonymous_settings?.[0]?.is_anon\r\n        return {\r\n            ...msg,\r\n            displayId: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_public_id,\r\n            username: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_username\r\n        }\r\n    })\r\n\r\n    return messages \r\n}\r\n\r\nexport async function getCurrentMessage(messageId: string, userId: string) {\r\n    const {data, error} = await supabase\r\n    .from(\"messages_safe\")\r\n    .select(\"*\")\r\n    .eq(\"id\", messageId)\r\n    .eq(\"to_user\", userId)\r\n    .single()\r\n    if (error) throw error\r\n    return data || []\r\n}\r\n\r\nexport async function getSentMessages(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from('messages_safe')\r\n        .select(`\r\n            *`)\r\n        .eq(\"from_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    \r\n    if(error) throw error\r\n    return data || []\r\n\r\n}\r\n\r\nexport async function sendMessage({\r\n    fromUserId,\r\n    toUserId,\r\n    toPublicId,\r\n    body,\r\n    isAnon\r\n}: {\r\n    fromUserId: string,\r\n    toUserId?: string,\r\n    toPublicId?: string,\r\n    body: ItemDto[],\r\n    isAnon?: boolean\r\n}) {\r\n    let receiverId = toUserId\r\n\r\n    if (!receiverId){\r\n        if (!toPublicId) throw new Error(\"–ù–µ —É–∫–∞–∑–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –º–∞–ª—ã—à\")\r\n            const {data: receiver, error: userError} = await supabase\r\n                .from(\"users\") \r\n                .select(\"id_user\")\r\n                .eq(\"public_id\", toPublicId)\r\n                .single()\r\n            if(userError || !receiver){\r\n                throw new Error(\"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∏ÃÜ–¥–µ–Ω, –∫–∏—Å—å\")\r\n            }\r\n        receiverId = receiver.id_user\r\n    }\r\n\r\n    const {error: settingError} = await supabase\r\n        .from(\"user_anonymous_settings\")\r\n        .upsert(\r\n            [{\r\n                from_user_id: fromUserId,\r\n                to_user_id: receiverId,\r\n                is_anon: isAnon\r\n            }], \r\n            { \r\n                onConflict: 'from_user_id,to_user_id'\r\n            }\r\n        );\r\n    if(settingError) throw settingError\r\n\r\n    const {error: messageError} = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n            from_user: fromUserId,\r\n            to_user: receiverId,\r\n            body,\r\n        })\r\n    if(messageError) throw messageError\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAIO,eAAe,iBAAiB,MAAc;IACjD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;;YAEL,CAAC,EACJ,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IACzC,IAAG,OAAO,MAAM;IAEhB,MAAM,WAAW,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAA;QAC9B,MAAM,cAAc,IAAI,uBAAuB,EAAE,CAAC,EAAE,EAAE;QACtD,OAAO;YACH,GAAG,GAAG;YACN,WAAW,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,cAAc;YACrE,UAAU,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,aAAa;QACvE;IACJ;IAEA,OAAO;AACX;AAEO,eAAe,kBAAkB,SAAiB,EAAE,MAAc;IACrE,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,WAAW,QACd,MAAM;IACP,IAAI,OAAO,MAAM;IACjB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,gBAAgB,MAAc;IAChD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;aACJ,CAAC,EACL,EAAE,CAAC,aAAa,QAChB,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IAEzC,IAAG,OAAO,MAAM;IAChB,OAAO,QAAQ,EAAE;AAErB;AAEO,eAAe,YAAY,EAC9B,UAAU,EACV,QAAQ,EACR,UAAU,EACV,IAAI,EACJ,MAAM,EAOT;IACG,IAAI,aAAa;IAEjB,IAAI,CAAC,YAAW;QACZ,IAAI,CAAC,YAAY,MAAM,IAAI,MAAM;QAC7B,MAAM,EAAC,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAC,GAAG,MAAM,8IAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC,WACP,EAAE,CAAC,aAAa,YAChB,MAAM;QACX,IAAG,aAAa,CAAC,UAAS;YACtB,MAAM,IAAI,MAAM;QACpB;QACJ,aAAa,SAAS,OAAO;IACjC;IAEA,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,2BACL,MAAM,CACH;QAAC;YACG,cAAc;YACd,YAAY;YACZ,SAAS;QACb;KAAE,EACF;QACI,YAAY;IAChB;IAER,IAAG,cAAc,MAAM;IAEvB,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,YACL,MAAM,CAAC;QACJ,WAAW;QACX,SAAS;QACT;IACJ;IACJ,IAAG,cAAc,MAAM;AAC3B"}},
    {"offset": {"line": 221, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useMessages.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from \"react\"\r\nimport { getInboxMessages, getSentMessages, sendMessage, getCurrentMessage } from \"../utils/messages\"\r\nimport { ItemDto, Message } from \"../types/type\"\r\n\r\n\r\n\r\nexport function useMessages(userId: string | null) {\r\n    const [inbox, setInbox] = useState<any[]>([])\r\n    const [sent, setSent] = useState<any[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n\r\n    const loadMessage = async () => {\r\n        if(!userId) return\r\n\r\n        try{\r\n            setLoading(true)\r\n            const [inboxData, sentData] = await Promise.all([\r\n                getInboxMessages(userId), \r\n                getSentMessages(userId)\r\n            ])\r\n\r\n            setInbox(inboxData)\r\n            setSent(sentData)\r\n        } catch (error) {\r\n            console.error(\"Error loading messages:\", error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadMessage()\r\n    },[userId])\r\n\r\n    const send = async (\r\n        to: {publicId?: string, userId?: string}, \r\n        body: ItemDto[],\r\n        isAnon?: boolean \r\n    ) => {\r\n        if(!userId) throw new Error(\"User not logged in\")\r\n        \r\n        await sendMessage({\r\n            fromUserId: userId,\r\n            toUserId: to.userId,\r\n            toPublicId: to.publicId, \r\n            body, \r\n            isAnon\r\n        })\r\n\r\n        await loadMessage()\r\n    }\r\n\r\n    return {\r\n        inbox,\r\n        sent,\r\n        loading,\r\n        sendMessage: send,\r\n        refresh: loadMessage\r\n    }\r\n\r\n}\r\n\r\ntype UseCurrentMessageResult = {\r\n    message: Message | null,\r\n    loading: boolean\r\n}\r\nexport function useCurrentMessage(\r\n    userId: string | null, \r\n    messageId: string | null\r\n): UseCurrentMessageResult {\r\n    const [message, setMessage] = useState<Message | null>(null)\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    useEffect(() => {\r\n        if (!userId || !messageId) return\r\n\r\n        const loadMessage = async () => {\r\n            setLoading(true)\r\n            try{\r\n                const data = await getCurrentMessage(messageId, userId)\r\n                setMessage(data)\r\n            } catch (error) {\r\n                console.error(\"Error loading messages:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadMessage()\r\n\r\n    }, [userId, messageId])\r\n\r\n    return {\r\n        message,\r\n        loading\r\n    }\r\n}\r\n\r\n\r\n\r\ntype Dialog = {\r\n    userId: string,\r\n    displayId: string,\r\n\r\n    lastMessage: Message,\r\n    messages: Message[],\r\n    count: number\r\n}\r\n\r\nexport function useDialogs(\r\n    inboxMessages: Message[],\r\n    sentMessages: Message[],\r\n    myUserId: string\r\n) {\r\n    const dialogs = useMemo<Dialog[]>(() => {\r\n        const map = new Map<string, Dialog>()\r\n\r\n        const allMessages = [...inboxMessages, ...sentMessages]\r\n\r\n        for (const msg of allMessages){\r\n            const dialogUserId = msg.from_user === myUserId\r\n                ? msg.to_user\r\n                : msg.from_user\r\n\r\n            let displayId = ''\r\n            if(msg.from_display_id === 'A'){\r\n                displayId = 'Anon'\r\n            } else{ \r\n                displayId = msg.from_display_id\r\n            }\r\n\r\n            if(!map.has(dialogUserId)) {\r\n                map.set(dialogUserId, {\r\n                    userId: dialogUserId,\r\n                    displayId: displayId,\r\n\r\n                    lastMessage: msg,\r\n                    messages: [msg],\r\n                    count: 1\r\n                })\r\n            } else{\r\n                const dialog = map.get(dialogUserId)!\r\n                dialog.messages.push(msg)\r\n                dialog.count++\r\n\r\n                if(\r\n                    new Date(msg.created_at) >\r\n                    new Date(dialog.lastMessage.created_at)\r\n                ){\r\n                    dialog.lastMessage = msg\r\n                }\r\n            }\r\n        }\r\n\r\n        return Array.from(map.values()).sort(\r\n            (a,b) =>\r\n                new Date(b.lastMessage.created_at).getTime() -\r\n                new Date(a.lastMessage.created_at).getTime()\r\n        )\r\n    }, [inboxMessages, sentMessages, myUserId])\r\n\r\n    return dialogs\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/lovecard/page.tsx"],"sourcesContent":["\"use client\"\r\nexport const dynamic = \"force-dynamic\";\r\n\r\nimport { useEffect, useState } from \"react\"\r\n\r\nimport { size,step } from \"../things/data\"\r\n\r\nimport { useAuth } from \"../things/hooks/useAuth\";\r\nimport {useCurrentMessage} from \"../things/hooks/useMessages\"\r\n\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nimport { ItemDto } from \"../things/types/type\";\r\nimport { Message } from \"../things/types/type\";\r\n\r\nexport default function AnonLoveMain() {\r\n    const router = useRouter()\r\n\r\n    const {user} = useAuth()\r\n    const [messageId, setMessageId] = useState<string | null>(null)\r\n\r\n    const {message, loading} = useCurrentMessage(user?.id ?? null, messageId)\r\n\r\n    const [sizeFigure, setSizeFigure] = useState(size)\r\n    const [scale, setScale] = useState(1)\r\n\r\n    const [explode, setExplode] = useState(false)\r\n    const [showMessage, setShowMessage] = useState(false)\r\n\r\n    const [click, setClick] = useState(0)\r\n    const maxClicks = 3\r\n\r\n    useEffect(() => {\r\n        const hash = window.location.hash\r\n        if(hash){\r\n            setMessageId(hash.replace('#', ''))\r\n        }\r\n    },[])\r\n\r\n    const tap = () => {\r\n        if (click < maxClicks - 1){\r\n            setClick(prev => prev + 1)\r\n\r\n            setSizeFigure(prev => ({\r\n                width: prev.width + step.s,\r\n                height: prev.height + step.s\r\n            }))\r\n    \r\n            setScale(1.2);\r\n            setTimeout(() => setScale(0.95), 120);\r\n            setTimeout(() => setScale(1.05), 220);\r\n            setTimeout(() => setScale(1), 320);\r\n    \r\n            const interval =setInterval(() => {\r\n                setScale(1.2);\r\n                setTimeout(() => setScale(0.95), 120);\r\n                setTimeout(() => setScale(1.05), 220);\r\n                setTimeout(() => setScale(1), 320);\r\n            }, 700);\r\n    \r\n            setTimeout(() => clearInterval(interval), 1000);\r\n    \r\n        }else {\r\n            setExplode(true)\r\n\r\n            setTimeout(() => {\r\n                setShowMessage(true)\r\n            }, 400);\r\n        }\r\n\r\n    }\r\n    \r\n\r\n    const viewBox = 100\r\n    const center = viewBox /2\r\n\r\n        return (\r\n            <div className=\"flex justify-center items-center bg-black h-full\">\r\n                {!showMessage && (\r\n    \r\n                <div className=\"flex justify-center items-center bg-black h-full\"\r\n                >\r\n                    <svg \r\n                        width={sizeFigure.width} \r\n                        height={sizeFigure.height}\r\n                        viewBox={`0 0 ${viewBox} ${viewBox}`}\r\n                        className=\"overflow-visible\"\r\n                        style={{\r\n                            width: 200,\r\n                            height: 200,\r\n                            opacity: explode ? 0 : 1,\r\n                            transform: explode\r\n                                ? \"scale(25)\"\r\n                                : `scale(${scale})`,\r\n                            transition: explode\r\n                                ? \"transform 0.9s cubic-bezier(0.22,1,0.36,1), opacity 0.4s ease-in-out\"\r\n                                : \"transform 0.15s ease-in-out\",\r\n                        }}\r\n                    >\r\n                        <path\r\n                            onClick={tap}\r\n                            className=\"cursor-pointer transition-transform duration-150 ease-in-out\"\r\n                            style={{\r\n                                transformOrigin: \"50% 50%\",\r\n                                transform: `scale(${scale})`,\r\n                            }}\r\n                            fill=\"red\"\r\n                            stroke=\"#fff\"\r\n                            strokeWidth={2}\r\n                            d=\"\r\n                                M50 85\r\n                                C20 60, 5 45, 25 25\r\n                                C40 10, 50 25, 50 25\r\n                                C50 25, 60 10, 75 25\r\n                                C95 45, 80 60, 50 85\r\n                            \"\r\n                        >\r\n        \r\n                        </path>\r\n                        \r\n                    </svg>\r\n                </div>\r\n                )}\r\n\r\n                {showMessage && (\r\n                    <div className=\"relative w-full h-full overflow-hidden bg-black\">\r\n                        {/* üé• –í–∏–¥–µ–æ —Ñ–æ–Ω */}\r\n                        <video\r\n                        autoPlay\r\n                        loop\r\n                        muted\r\n                        playsInline\r\n                        className=\"absolute top-0 left-0 w-full h-full object-cover opacity-40\"\r\n                        >\r\n                        <source src=\"/bg/bgstar.mp4\" type=\"video/mp4\" />\r\n                        </video>\r\n\r\n                        {/* üåë –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é) */}\r\n                        <div className=\"absolute inset-0 bg-black/40\" />\r\n\r\n                        {/* üß† –ö–æ–Ω—Ç–µ–Ω—Ç */}\r\n                        <div className=\"relative z-10 flex flex-col justify-center items-center h-full\">\r\n                            <button\r\n                                className=\"bg-white/10 p-2 mb-4\"\r\n                                onClick={() => router.push(\"anonlovemain\")}\r\n                            >\r\n                                ‚Üê\r\n                            </button>\r\n\r\n                            {/* field */}\r\n                            <div\r\n                                className=\"relative border w-1/2 h-1/2 rounded-md bg-white overflow-hidden z-10\"\r\n                            >\r\n                                {message?.body.map((item: ItemDto) => (\r\n                                    <div \r\n                                        key={item.id}\r\n                                        className=\"flex text-black select-none relative\"\r\n                                        style={{\r\n                                            position: \"absolute\",\r\n                                            left: item.x,\r\n                                            top: item.y,\r\n                                            width: item.w,\r\n                                            height: item.h,\r\n                                            fontSize: item.fontSize,\r\n                                        }}\r\n                                    \r\n                                    \r\n                                    >\r\n                                            <div className={`relative w-full h-full text-wrap wrap-break-word\r\n                                                            overflow-hidden`}> \r\n                                                {item.content}\r\n\r\n                                                \r\n                                            </div>\r\n\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                                <button \r\n                                    className=\"p-2 mt-4 border rounded-2xl hover:bg-white/20 transition-all duration-200\"\r\n                                    onClick={() => {\r\n                                        router.push(`createcard?to=${encodeURIComponent(message?.from_display_id ?? '')}`)\r\n                                    }}\r\n                                >\r\n                                    –û—Ç–≤–µ—Ç–∫–∞\r\n                                </button>   \r\n                        </div>\r\n\r\n                    </div>\r\n                )}\r\n            </div>\r\n        )\r\n    \r\n\r\n\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}