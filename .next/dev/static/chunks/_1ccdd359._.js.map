{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/utils/supabase/alSupabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_ANONLOVE_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_ANONLOVE_SUPABASE_ANON_KEY!\r\n);"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,0LAAY"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/utils/auth.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\n\r\nexport async function getCurrentUser() {\r\n    const {data, error} = await supabase.auth.getUser()\r\n    if(error) return\r\n    return data.user\r\n}\r\n\r\nexport async function getUserProfile(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from(\"users\")\r\n        .select(\"public_id, username\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error) return null\r\n    return data\r\n}\r\n\r\nexport async function sighOut() {\r\n    const {error} = await supabase.auth.signOut()\r\n    if(error) throw error\r\n}\r\n\r\nexport function onAuthStateChange(callback: (user:any) => void) {\r\n    const {data: listener} = supabase.auth.onAuthStateChange((event,session) => {\r\n        callback(session?.user || null)\r\n    })\r\n    return listener.subscription\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IAClB,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IACjD,IAAG,OAAO;IACV,OAAO,KAAK,IAAI;AACpB;AAEO,eAAe,eAAe,MAAc;IAC/C,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,OAAO,OAAO;IACjB,OAAO;AACX;AAEO,eAAe;IAClB,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IAC3C,IAAG,OAAO,MAAM;AACpB;AAEO,SAAS,kBAAkB,QAA4B;IAC1D,MAAM,EAAC,MAAM,QAAQ,EAAC,GAAG,8IAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAM;QAC5D,SAAS,SAAS,QAAQ;IAC9B;IACA,OAAO,SAAS,YAAY;AAChC"}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useAuth.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getCurrentUser, getUserProfile, onAuthStateChange } from \"../utils/auth\"\r\n\r\nexport function useAuth() {\r\n    const [user, setUser] = useState<any>(null)\r\n    const [profile, setProfile] = useState<any>(null)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        const loadUser = async () => {\r\n            try {\r\n                const userData = await getCurrentUser()\r\n                setUser(userData)\r\n\r\n                if(userData) {\r\n                    const profileData = await getUserProfile(userData.id)\r\n                    setProfile(profileData)\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Error loading user:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadUser()\r\n\r\n        const subscription = onAuthStateChange(async (newUser) => {\r\n            setUser(newUser)\r\n            if (newUser) {\r\n                const profileData = await getUserProfile(newUser.id)\r\n                setProfile(profileData)\r\n            } else {\r\n                setProfile(null)\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            subscription.unsubscribe()\r\n        }\r\n    },[])\r\n\r\n    return {user,profile,loading}\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKO,SAAS;;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAM;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;6BAAC;YACN,MAAM;8CAAW;oBACb,IAAI;wBACA,MAAM,WAAW,MAAM,IAAA,+JAAc;wBACrC,QAAQ;wBAER,IAAG,UAAU;4BACT,MAAM,cAAc,MAAM,IAAA,+JAAc,EAAC,SAAS,EAAE;4BACpD,WAAW;wBACf;oBACJ,EAAE,OAAO,OAAO;wBACZ,QAAQ,KAAK,CAAC,uBAAuB;oBACzC,SAAU;wBACN,WAAW;oBACf;gBACJ;;YACA;YAEA,MAAM,eAAe,IAAA,kKAAiB;kDAAC,OAAO;oBAC1C,QAAQ;oBACR,IAAI,SAAS;wBACT,MAAM,cAAc,MAAM,IAAA,+JAAc,EAAC,QAAQ,EAAE;wBACnD,WAAW;oBACf,OAAO;wBACH,WAAW;oBACf;gBACJ;;YAEA;qCAAO;oBACH,aAAa,WAAW;gBAC5B;;QACJ;4BAAE,EAAE;IAEJ,OAAO;QAAC;QAAK;QAAQ;IAAO;AAChC;GAvCgB"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/utils/messages.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\nimport { error } from \"console\";\r\n\r\nexport async function getInboxMessages(userId: string){\r\n    const {data, error} = await supabase\r\n        .from(\"messages_safe\")\r\n        .select(`\r\n            *\r\n            `)\r\n        .eq(\"to_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    if(error) throw error;  \r\n\r\n    const messages = (data || []).map(msg => {\r\n        const anonSetting = msg.user_anonymous_settings?.[0]?.is_anon\r\n        return {\r\n            ...msg,\r\n            displayId: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_public_id,\r\n            username: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_username\r\n        }\r\n    })\r\n\r\n    return messages \r\n}\r\n\r\nexport async function getCurrentMessage(messageId: string, userId: string) {\r\n    const {data, error} = await supabase\r\n    .from(\"messages_safe\")\r\n    .select(\"*\")\r\n    .eq(\"id\", messageId)\r\n    .eq(\"to_user\", userId)\r\n    .single()\r\n    if (error) throw error\r\n    return data || []\r\n}\r\n\r\nexport async function getSentMessages(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from('messages_safe')\r\n        .select(`\r\n            *`)\r\n        .eq(\"from_user\", userId)\r\n        .order(\"created_at\", {ascending: true})\r\n    \r\n    if(error) throw error\r\n    return data || []\r\n\r\n}\r\n\r\nexport async function sendMessage({\r\n    fromUserId,\r\n    toUserId,\r\n    toPublicId,\r\n    body,\r\n    isAnon\r\n}: {\r\n    fromUserId: string,\r\n    toUserId?: string,\r\n    toPublicId?: string,\r\n    body: string,\r\n    isAnon?: boolean\r\n}) {\r\n    let receiverId = toUserId\r\n\r\n    if (!receiverId){\r\n        if (!toPublicId) throw new Error(\"Не указан пользователь, малыш\")\r\n            const {data: receiver, error: userError} = await supabase\r\n                .from(\"users\") \r\n                .select(\"id_user\")\r\n                .eq(\"public_id\", toPublicId)\r\n                .single()\r\n            if(userError || !receiver){\r\n                throw new Error(\"Пользователь не найден, кись\")\r\n            }\r\n        receiverId = receiver.id_user\r\n    }\r\n\r\n    const {error: settingError} = await supabase\r\n        .from(\"user_anonymous_settings\")\r\n        .upsert(\r\n            [{\r\n                from_user_id: fromUserId,\r\n                to_user_id: receiverId,\r\n                is_anon: isAnon\r\n            }], \r\n            { \r\n                onConflict: 'from_user_id,to_user_id'\r\n            }\r\n        );\r\n    if(settingError) throw settingError\r\n\r\n    const {error: messageError} = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n            from_user: fromUserId,\r\n            to_user: receiverId,\r\n            body,\r\n        })\r\n    if(messageError) throw messageError\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,eAAe,iBAAiB,MAAc;IACjD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;;YAEL,CAAC,EACJ,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IACzC,IAAG,OAAO,MAAM;IAEhB,MAAM,WAAW,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAA;QAC9B,MAAM,cAAc,IAAI,uBAAuB,EAAE,CAAC,EAAE,EAAE;QACtD,OAAO;YACH,GAAG,GAAG;YACN,WAAW,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,cAAc;YACrE,UAAU,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,aAAa;QACvE;IACJ;IAEA,OAAO;AACX;AAEO,eAAe,kBAAkB,SAAiB,EAAE,MAAc;IACrE,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,WAAW,QACd,MAAM;IACP,IAAI,OAAO,MAAM;IACjB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,gBAAgB,MAAc;IAChD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;aACJ,CAAC,EACL,EAAE,CAAC,aAAa,QAChB,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IAEzC,IAAG,OAAO,MAAM;IAChB,OAAO,QAAQ,EAAE;AAErB;AAEO,eAAe,YAAY,EAC9B,UAAU,EACV,QAAQ,EACR,UAAU,EACV,IAAI,EACJ,MAAM,EAOT;IACG,IAAI,aAAa;IAEjB,IAAI,CAAC,YAAW;QACZ,IAAI,CAAC,YAAY,MAAM,IAAI,MAAM;QAC7B,MAAM,EAAC,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAC,GAAG,MAAM,8IAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC,WACP,EAAE,CAAC,aAAa,YAChB,MAAM;QACX,IAAG,aAAa,CAAC,UAAS;YACtB,MAAM,IAAI,MAAM;QACpB;QACJ,aAAa,SAAS,OAAO;IACjC;IAEA,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,2BACL,MAAM,CACH;QAAC;YACG,cAAc;YACd,YAAY;YACZ,SAAS;QACb;KAAE,EACF;QACI,YAAY;IAChB;IAER,IAAG,cAAc,MAAM;IAEvB,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,YACL,MAAM,CAAC;QACJ,WAAW;QACX,SAAS;QACT;IACJ;IACJ,IAAG,cAAc,MAAM;AAC3B"}},
    {"offset": {"line": 200, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useMessages.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from \"react\"\r\nimport { getInboxMessages, getSentMessages, sendMessage, getCurrentMessage } from \"../utils/messages\"\r\n\r\n\r\nexport function useMessages(userId: string | null) {\r\n    const [inbox, setInbox] = useState<any[]>([])\r\n    const [sent, setSent] = useState<any[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n\r\n    const loadMessage = async () => {\r\n        if(!userId) return\r\n\r\n        try{\r\n            setLoading(true)\r\n            const [inboxData, sentData] = await Promise.all([\r\n                getInboxMessages(userId), \r\n                getSentMessages(userId)\r\n            ])\r\n\r\n            setInbox(inboxData)\r\n            setSent(sentData)\r\n        } catch (error) {\r\n            console.error(\"Error loading messages:\", error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadMessage()\r\n    },[userId])\r\n\r\n    const send = async (\r\n        to: {publicId?: string, userId?: string}, \r\n        body: string,\r\n        isAnon?: boolean \r\n    ) => {\r\n        if(!userId) throw new Error(\"User not logged in\")\r\n        \r\n        await sendMessage({\r\n            fromUserId: userId,\r\n            toUserId: to.userId,\r\n            toPublicId: to.publicId, \r\n            body, \r\n            isAnon\r\n        })\r\n\r\n        await loadMessage()\r\n    }\r\n\r\n    return {\r\n        inbox,\r\n        sent,\r\n        loading,\r\n        sendMessage: send,\r\n        refresh: loadMessage\r\n    }\r\n\r\n}\r\n\r\nexport function useCurrentMessage(userId: string | null, messageId: string | null) {\r\n    const [message, setMessage] = useState<any>(null)\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    useEffect(() => {\r\n        if (!userId || !messageId) return\r\n\r\n        const loadMessage = async () => {\r\n            setLoading(true)\r\n            try{\r\n                const data = await getCurrentMessage(messageId, userId)\r\n                setMessage(data)\r\n            } catch (error) {\r\n                console.error(\"Error loading messages:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadMessage()\r\n\r\n    }, [userId, messageId])\r\n\r\n    return {\r\n        message,\r\n        loading\r\n    }\r\n}\r\n\r\ntype Message = {\r\n    id: string,\r\n    from_user: string,\r\n    to_user: string,\r\n    from_display_id: string,\r\n    to_display_id: string,\r\n    is_anon: boolean,\r\n    body: string,\r\n    created_at: string\r\n}\r\n\r\ntype Dialog = {\r\n    userId: string,\r\n    displayId: string,\r\n\r\n    lastMessage: Message,\r\n    messages: Message[],\r\n    count: number\r\n}\r\n\r\nexport function useDialogs(\r\n    inboxMessages: Message[],\r\n    sentMessages: Message[],\r\n    myUserId: string\r\n) {\r\n    const dialogs = useMemo<Dialog[]>(() => {\r\n        const map = new Map<string, Dialog>()\r\n\r\n        const allMessages = [...inboxMessages, ...sentMessages]\r\n\r\n        for (const msg of allMessages){\r\n            const dialogUserId = msg.from_user === myUserId\r\n                ? msg.to_user\r\n                : msg.from_user\r\n\r\n            let displayId = ''\r\n            if(msg.from_display_id === 'A'){\r\n                displayId = 'Anon'\r\n            } else{ \r\n                displayId = msg.from_display_id\r\n            }\r\n\r\n            if(!map.has(dialogUserId)) {\r\n                map.set(dialogUserId, {\r\n                    userId: dialogUserId,\r\n                    displayId: displayId,\r\n\r\n                    lastMessage: msg,\r\n                    messages: [msg],\r\n                    count: 1\r\n                })\r\n            } else{\r\n                const dialog = map.get(dialogUserId)!\r\n                dialog.messages.push(msg)\r\n                dialog.count++\r\n\r\n                if(\r\n                    new Date(msg.created_at) >\r\n                    new Date(dialog.lastMessage.created_at)\r\n                ){\r\n                    dialog.lastMessage = msg\r\n                }\r\n            }\r\n        }\r\n\r\n        return Array.from(map.values()).sort(\r\n            (a,b) =>\r\n                new Date(b.lastMessage.created_at).getTime() -\r\n                new Date(a.lastMessage.created_at).getTime()\r\n        )\r\n    }, [inboxMessages, sentMessages, myUserId])\r\n\r\n    return dialogs\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 349, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/things/hooks/useSwipe.ts"],"sourcesContent":["import { on } from \"events\";\r\nimport { useRef } from \"react\";\r\n\r\ntype SwipeConfig = {\r\n    onSwipeLeft?: () => void,\r\n    onSwipeRight?: () => void,\r\n    threshold?: number\r\n}\r\n\r\nexport function useSwipe({\r\n    onSwipeLeft,\r\n    onSwipeRight,\r\n    threshold = 50\r\n}: SwipeConfig) {\r\n    const startX = useRef<number | null>(null);\r\n\r\n    const onTouchStart = (e: React.TouchEvent) => {\r\n        startX.current = e.touches[0].clientX;\r\n    }\r\n\r\n    const onTouchEnd = (e: React.TouchEvent) => {\r\n        if (startX.current === null) return;\r\n\r\n        const endX = e.changedTouches[0].clientX;\r\n        const delta = endX - startX.current;\r\n\r\n        if(Math.abs(delta) > threshold) {\r\n            if(delta > 0) onSwipeRight?.()\r\n            else onSwipeLeft?.()\r\n        }\r\n\r\n        startX.current = null;\r\n    }\r\n\r\n    return {\r\n        onTouchStart,\r\n        onTouchEnd\r\n    }\r\n}"],"names":[],"mappings":";;;;AACA;;;AAQO,SAAS,SAAS,EACrB,WAAW,EACX,YAAY,EACZ,YAAY,EAAE,EACJ;;IACV,MAAM,SAAS,IAAA,uKAAM,EAAgB;IAErC,MAAM,eAAe,CAAC;QAClB,OAAO,OAAO,GAAG,EAAE,OAAO,CAAC,EAAE,CAAC,OAAO;IACzC;IAEA,MAAM,aAAa,CAAC;QAChB,IAAI,OAAO,OAAO,KAAK,MAAM;QAE7B,MAAM,OAAO,EAAE,cAAc,CAAC,EAAE,CAAC,OAAO;QACxC,MAAM,QAAQ,OAAO,OAAO,OAAO;QAEnC,IAAG,KAAK,GAAG,CAAC,SAAS,WAAW;YAC5B,IAAG,QAAQ,GAAG;iBACT;QACT;QAEA,OAAO,OAAO,GAAG;IACrB;IAEA,OAAO;QACH;QACA;IACJ;AACJ;GA7BgB"}},
    {"offset": {"line": 385, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonlove/anonlovemain/page.tsx"],"sourcesContent":["\"use client\"\r\nimport { useState, useEffect, useRef, use } from \"react\"\r\nimport { supabase } from \"@/utils/supabase/alSupabase\"\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useAuth } from \"../things/hooks/useAuth\";\r\nimport { useMessages, useDialogs } from \"../things/hooks/useMessages\";\r\nimport { sighOut } from \"../things/utils/auth\";\r\nimport { useSwipe } from \"../things/hooks/useSwipe\";\r\n\r\nexport default function Page() {\r\n    const router = useRouter();\r\n\r\n    const {user, profile, loading: authLoading} = useAuth();\r\n    \r\n    const {inbox, sent, sendMessage: send, loading: messageLoading} = useMessages(user?.id || null);\r\n\r\n    const dialogs = useDialogs(inbox, sent, user?.id || \"\");\r\n    const [activeDialogId, setActiveDialogId] = useState<string | null>(null);\r\n    const activeDialog = dialogs.find((d) => d.userId === activeDialogId);\r\n\r\n    const [openChat, setOpenChat] = useState(false);\r\n    const [isMobile, setIsMobile] = useState(false);\r\n\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    const idRef = useRef<HTMLInputElement>(null);\r\n    const textRef = useRef<HTMLInputElement>(null);\r\n    const [isAnon, setIsAnon] = useState(false);\r\n\r\n    // ответ на сообщение\r\n    const [replyToUserId, setreplyToUserId] = useState<{id: string; isAnon: boolean} | null>(null); //id\r\n    const [isReply, setIsReply] = useState(false);\r\n\r\n    const [tab, setTab] = useState<\"inbox\" | \"sent\">(\"inbox\");\r\n\r\n    // свайп для мобилки\r\n    const chatSwipe = useSwipe({\r\n        onSwipeRight: () => {\r\n            if (!isMobile) return;\r\n            setOpenChat(false)\r\n        }\r\n    })\r\n    \r\n    // автовставка id\r\n    useEffect(() => {\r\n        if (isOpen && idRef.current) {\r\n            idRef.current.value = replyToUserId?.id || ''\r\n        }\r\n    }, [isOpen, replyToUserId])\r\n\r\n\r\n    \r\n    // проверка мобилки\r\n    useEffect(() => {\r\n        const checkMobile = () => {\r\n            setIsMobile(window.innerWidth <= 768)\r\n        }\r\n        checkMobile()\r\n        window.addEventListener(\"resize\", checkMobile)\r\n\r\n        return () => window.removeEventListener(\"resize\", checkMobile)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if(!isMobile){\r\n            setOpenChat(false)\r\n        }\r\n    }, [isMobile])\r\n\r\n    \r\n    \r\n    const handleSendMessage = async () => {\r\n        const idInput = idRef.current?.value || \"\"\r\n        const text = textRef.current?.value || \"\"\r\n\r\n        if (!idInput || !text){\r\n            alert('все поля заполни, сладкий!')\r\n            return\r\n        }\r\n        \r\n        try {\r\n            if (isReply){\r\n                const sendMessage = replyToUserId?.isAnon\r\n                    ? { userId: replyToUserId?.id}\r\n                    : { publicId: replyToUserId?.id}\r\n    \r\n                await send(sendMessage, text, isAnon)\r\n            }\r\n            else {\r\n                await send({publicId: idInput}, text, isAnon)\r\n            }\r\n\r\n            idRef.current!.value = \"\"\r\n            textRef.current!.value = \"\"\r\n            setIsOpen(false)\r\n        } catch (error: any) {\r\n            console.log(error.message || 'Error sending message');\r\n        }\r\n        \r\n    }\r\n    \r\n    const handleSignOut = async () => {\r\n        await sighOut()\r\n        router.push('/anonlove/auth')\r\n    }\r\n\r\n    if (authLoading) {\r\n        return (\r\n            <div className=\"bg-black min-h-screen flex items-center justify-center text-white\">\r\n                Загрузка...\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative bg-black min-h-screen flex flex-col\">\r\n            {user ? (\r\n                <header \r\n                    className=\"bg-linear-to-b from-90% to-100% from-black to-[#8f184f]\r\n                            text-white p-1 flex justify-between items-center shadow-md\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center text-lg font-bold\">\r\n                            {profile?.public_id.charAt(1).toUpperCase()}\r\n                        </div>\r\n                        <div className=\"flex flex-col\">\r\n                            <span className=\"font-semibold\">{profile?.public_id}</span>\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        className=\"bg-white/10 hover:bg-white/20 text-white px-4 py-1 rounded-md transition\"\r\n                        onClick={handleSignOut}\r\n                    >\r\n                        Выйти\r\n                    </button>\r\n                </header>\r\n            ) : (\r\n                <header className=\"bg-gray-900 text-white p-4 shadow-md\">\r\n                    <span>Вы не залогинены</span>\r\n                </header>\r\n            )}\r\n\r\n            {/* сообщения */}\r\n            <main \r\n                className=\"relative flex-1 text-white flex md:flex-row flex-col overflow-hidden\"\r\n            >\r\n                {/* ДИАЛОГИ */}\r\n                <div className={`absolute inset-0 bg-[#12080b] \r\n                                h-[calc(100vh-48px)] overflow-y-auto\r\n                                transition-transform duration-300 ease-out will-change-transform\r\n                                md:static md:translate-x-0 md:w-1/2\r\n                                ${isMobile && openChat ? \"-translate-x-full\" : \"translate-x-0\"}\r\n                    `}>\r\n\r\n                    <div className=\"flex w-full\">\r\n                        <button \r\n                            className=\"bg-white/10 p-2 rounded-md w-full text-center flex justify-center items-center gap-1\"\r\n                        >\r\n                            <span className=\"medium\">Чаты</span>\r\n                            <span \r\n                                className={`w-3 h-3 rounded-full border transition bg-white border-white\r\n                                `}\r\n                            />\r\n                        </button>\r\n\r\n                        \r\n                    </div>\r\n\r\n                    {dialogs.map((dialog) => {\r\n                        const avatar = dialog.displayId.charAt(1).toUpperCase()\r\n                        const title = dialog.displayId\r\n                            \r\n                        return(\r\n                            <button\r\n                                key={dialog.userId}\r\n                                className=\"border border-[#8f18504e] p-2 rounded-lg w-full\"\r\n                                onClick={() => {setActiveDialogId(dialog.userId), setOpenChat(true)}}\r\n                            > \r\n                                <div className=\"flex p-2 items-center gap-2 relative\">\r\n                                    <span\r\n                                        className=\"flex bg-red-500 w-8 h-8 items-center justify-center rounded-full text-lg font-bold\"\r\n                                    >\r\n                                        {avatar}\r\n                                    </span>\r\n\r\n                                    <div className=\"\">\r\n                                        <span className=\"font-semibold\"\r\n                                        >\r\n                                            {title}\r\n                                        </span>\r\n\r\n                                        <span className=\"text-[10px] text-gray-400 absolute bottom-[0px] right-1 \">\r\n                                            {dialog.lastMessage.created_at.slice(11,16)}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                            </button>  \r\n                        )\r\n                    })}\r\n\r\n                    <div\r\n                        className=\"absolute bottom-0 right-2\"\r\n                    >\r\n                        <AnimatedButton\r\n                        openModal={() => {\r\n                            setreplyToUserId(null)\r\n                            setIsOpen(true)\r\n                            setIsReply(false)\r\n                        }}\r\n                        >   \r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 32 32\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M2 4h28v18H16l-8 7v-7H2Z\"/></svg>\r\n                        </AnimatedButton>\r\n                    </div>\r\n                </div>\r\n                \r\n                {/* ===== ЧАТ ===== */}\r\n                <div \r\n                    {...(isMobile ? chatSwipe : {})}\r\n                    className={`\r\n                        absolute inset-0 bg-[#12080b] \r\n                        h-[calc(100vh-48px)] overflow-y-auto\r\n                        transition-transform duration-300 ease-in-out will-change-transform\r\n                        md:static md:translate-x-0 md:w-1/2\r\n                        ${openChat ? \"translate-x-0\" : \"translate-x-full\"}\r\n                    `}>\r\n\r\n                    {/* Кнопка назад (ТОЛЬКО мобилка) */}\r\n                    {isMobile && (\r\n                        <button\r\n                            className=\"absolute top-2 left-2 bg-[#8f1850f0] w-10 h-10 text-center rounded-full z-10\"\r\n                            onClick={() => setOpenChat(false)}\r\n                        >\r\n                            ← \r\n                        </button>\r\n                    )}\r\n                    \r\n\r\n                    {activeDialog?.messages.map(message => {\r\n                        const avatar = message.from_display_id.charAt(1).toUpperCase()\r\n                        const nameLabel = message.from_display_id\r\n                        const bodyText = message.body //\"тебе тут что то пришло, малышка\"\r\n                        const isMine = message.from_user === user?.id\r\n\r\n                        return (\r\n                            <div\r\n                                key={message.id}\r\n                                className={`flex flex-col relative w-full transition hover:bg-white/10\r\n                                    ${isMine ? \"items-end\" : \"items-start\"}\r\n                                `}\r\n                            >\r\n                                <div\r\n                                    className={`flex items-center gap-2 p-2 cursor-pointer max-w-[80%]\r\n                                        ${isMine ? \"flex-row-reverse text-right\" : \"flex-row\"}\r\n                                    `}\r\n                                    onClick={() => router.push(`lovecard#${message.id}`)}\r\n                                >\r\n                                    {/* avatar */}\r\n                                    <div\r\n                                        className=\"md:w-10 md:h-10 w-8 h-8\r\n                                                rounded-full bg-red-500\r\n                                                flex items-center justify-center\r\n                                                text-lg font-bold shrink-0\"\r\n                                    >\r\n                                        {avatar}\r\n                                    </div>\r\n\r\n                                    {/* text */}\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"font-semibold medium\">\r\n                                            {nameLabel}\r\n                                        </span>\r\n                                        <span className=\"small line-clamp-2\">\r\n                                            {bodyText}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* reply button — только для чужих сообщений */}\r\n                                {!isMine && (\r\n                                    <button\r\n                                        className=\"absolute top-1/2 right-1 -translate-y-1/2\"\r\n                                        onClick={() => {\r\n                                            setreplyToUserId({\r\n                                                id: message.from_display_id || message.from_user,\r\n                                                isAnon: message.is_anon\r\n                                            })\r\n                                            setIsReply(true)\r\n                                            setIsOpen(true)\r\n                                        }}\r\n                                    >\r\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 14 14\">\r\n                                            <g fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                                <path d=\"M7.5.5h-5a1 1 0 0 0-1 1v9l-1 3l4-1h8a1 1 0 0 0 1-1v-5\"/>\r\n                                                <path d=\"m8.363 8.137l-3 .54l.5-3.04l4.73-4.71a.999.999 0 0 1 1.42 0l1.06 1.06a1.001 1.001 0 0 1 0 1.42z\"/>\r\n                                            </g>\r\n                                        </svg>\r\n                                    </button>\r\n                                )}\r\n\r\n                                <div className=\"w-full mx-auto bg-white/20 h-[1px]\" />\r\n                            </div>\r\n                        )\r\n                    })}\r\n\r\n                    \r\n                </div>\r\n\r\n                \r\n            </main>\r\n\r\n            {/* modalka */}\r\n            {isOpen && (\r\n                <div \r\n                    className=\"absolute md:w-[400px] w-full h-[300px] bg-black z-50 \r\n                                rounded-lg flex border-2 border-[#8f184f]\r\n                                top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\"> \r\n                    <form \r\n                        className=\"relative flex flex-col justify-center items-center gap-2 mx-auto w-full\"\r\n                        onSubmit={(e) => {e.preventDefault()}}\r\n                        >\r\n                        <input\r\n                            ref={idRef}\r\n                            type=\"text\" \r\n                            placeholder=\"id няшки\" \r\n                            disabled={isReply}\r\n                            className={`p-2 border-2 rounded-lg \r\n                                ${isReply \r\n                                    ? 'opacity-50'\r\n                                    : 'opacity-100'\r\n                                }`}\r\n                            />\r\n                        <input \r\n                            ref={textRef}\r\n                            type=\"text\" \r\n                            placeholder=\"Текст\" \r\n                            className=\"p-2 border-2 rounded-lg \"\r\n                            />\r\n                        <div className=\"flex justify-center items-center\">\r\n                            <input\r\n                                type=\"checkbox\" id=\"anon\" name=\"anon\"\r\n                                checked={isAnon}\r\n                                onChange={(e) => {setIsAnon(e.target.checked)}}\r\n                            />\r\n                            <label htmlFor=\"anon\">{`анонимно (увидит только id)`}</label>\r\n                        </div>\r\n                        \r\n\r\n                        <button \r\n                        className=\"bg-[#8f184f] text-white px-4 py-2 rounded-lg\"\r\n                        type=\"button\" onClick={handleSendMessage}>Отправить</button>\r\n\r\n                        <button onClick={() => {setIsOpen(false)}} className=\"absolute top-1 right-2\">X</button>\r\n                    </form>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\n\r\nfunction AnimatedButton({ \r\n    children,\r\n    openModal \r\n}: {\r\n    children: React.ReactNode,\r\n    openModal: () => void\r\n\r\n}) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n    const animationRef = useRef<number>(0);\r\n    const isHovering = useRef(false);\r\n\r\n    const sizeRef = useRef({w:0,h:0})\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current\r\n        const button = buttonRef.current\r\n        if(!canvas || !button) return;\r\n\r\n        const ctx = canvas.getContext(\"2d\");\r\n        if(!ctx) return;\r\n\r\n        const updateSize = () => {\r\n            const rect = canvas.parentElement!.getBoundingClientRect();\r\n            const dpr = window.devicePixelRatio || 1;\r\n\r\n            sizeRef.current.w = rect.width;\r\n            sizeRef.current.h = rect.height;\r\n\r\n            canvas.width = rect.width * dpr;\r\n            canvas.height = rect.height * dpr;\r\n            canvas.style.width = rect.width + \"px\"\r\n            canvas.style.height = rect.height + \"px\"\r\n            ctx.setTransform(dpr,0,0,dpr,0,0)\r\n        }\r\n        updateSize()\r\n\r\n        function getBtnCenter(){\r\n            const btn = button!.getBoundingClientRect()\r\n            const cvs = canvas!.getBoundingClientRect()\r\n            return{\r\n                x: cvs.width/2,\r\n                y: cvs.height/2\r\n            }\r\n        }\r\n\r\n        const particles: {\r\n            x: number,\r\n            y: number,\r\n            radius: number,\r\n            alpha: number,\r\n            life: number,\r\n            vx: number,\r\n            vy: number\r\n        }[] = []\r\n\r\n        const speed = 50\r\n        let lastTime = performance.now()\r\n\r\n        function animate(currentTime: number) {\r\n            if (!ctx || !canvas) return\r\n            const deltaTime = (currentTime - lastTime) / 1000\r\n            lastTime = currentTime\r\n\r\n            const {w , h} = sizeRef.current\r\n            ctx.clearRect(0,0, w, h)\r\n\r\n            \r\n            if(Math.random() < 0.06) {\r\n                const angle = Math.random() * Math.PI * 2\r\n                particles.push({\r\n                    x: Math.random() * w,\r\n                    y: Math.random() * h,\r\n                    radius: 4,\r\n                    alpha: 1,\r\n                    life: 1,\r\n                    vx: Math.cos(angle) * speed,\r\n                    vy: Math.sin(angle) * speed\r\n                })\r\n            }\r\n            const target = getBtnCenter()\r\n\r\n            for (let i = particles.length -1; i >= 0; i--) {\r\n                const p = particles[i];\r\n\r\n                p.life -= deltaTime * 0.3;\r\n                p.alpha = p.life\r\n                \r\n                if(isHovering.current) {\r\n                    const dx = target.x - p.x\r\n                    const dy = target.y - p.y\r\n                    const dist = Math.sqrt(dx * dx + dy * dy) + 0.001\r\n\r\n                    const force = Math.max(0, 1 - dist / 700) * 400;\r\n\r\n                    p.vx += (dx / dist) * force *deltaTime\r\n                    p.vy += (dy / dist) * force *deltaTime\r\n                } \r\n\r\n                // max speed\r\n                const speed = Math.hypot(p.vx, p.vy);\r\n                const maxSpeed = 160;\r\n                if (speed > maxSpeed) {\r\n                    p.vx = (p.vx / speed) * maxSpeed;\r\n                    p.vy = (p.vy / speed) * maxSpeed;\r\n                }\r\n\r\n                p.x += p.vx * deltaTime;\r\n                p.y += p.vy * deltaTime;\r\n\r\n                \r\n\r\n                if (p.alpha <= 0) {\r\n                    particles.splice(i, 1)\r\n                    continue\r\n                }\r\n                \r\n\r\n                ctx.globalAlpha = p.alpha;\r\n                ctx.shadowBlur = 1;\r\n                ctx.shadowColor = \"white\";\r\n                ctx.fillStyle = 'white';\r\n\r\n                ctx.beginPath();\r\n                ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\r\n                ctx.fill();\r\n            }\r\n            ctx.globalAlpha = 1\r\n            animationRef.current = requestAnimationFrame(animate)\r\n        }\r\n\r\n        animationRef.current = requestAnimationFrame(animate)\r\n        window.addEventListener('resize', updateSize)\r\n\r\n        return () => {\r\n            if (animationRef.current){\r\n                cancelAnimationFrame(animationRef.current)\r\n            }\r\n            window.removeEventListener('resize', updateSize)\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"relative flex justify-center items-center h-full w-full\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"absolute w-full h-full pointer-events-none z-1\"\r\n            >\r\n            </canvas>\r\n            <button\r\n                ref={buttonRef}\r\n                onClick={openModal}\r\n                onMouseEnter={() => (isHovering.current = true)}\r\n                onMouseLeave={() => (isHovering.current = false)}\r\n                className=\"relative p-4 bg-white/10 rounded-full hover:bg-white/40 transition-colors z-2\"\r\n            >\r\n                {children}\r\n            </button>\r\n\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}