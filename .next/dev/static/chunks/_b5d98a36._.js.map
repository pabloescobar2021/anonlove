{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/utils/supabase/alSupabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n\r\n"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,0LAAY"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/utils/auth.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\n\r\nexport async function getCurrentUser() {\r\n    const {data, error} = await supabase.auth.getUser()\r\n    if(error) return\r\n    return data.user\r\n}\r\n\r\nexport async function getUserProfile(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from(\"users\")\r\n        .select(\"public_id, username\")\r\n        .eq(\"id_user\", userId)\r\n        .single()\r\n    if(error) return null\r\n    return data\r\n}\r\n\r\nexport async function sighOut() {\r\n    const {error} = await supabase.auth.signOut()\r\n    if(error) throw error\r\n}\r\n\r\nexport function onAuthStateChange(callback: (user:any) => void) {\r\n    const {data: listener} = supabase.auth.onAuthStateChange((event,session) => {\r\n        callback(session?.user || null)\r\n    })\r\n    return listener.subscription\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IAClB,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IACjD,IAAG,OAAO;IACV,OAAO,KAAK,IAAI;AACpB;AAEO,eAAe,eAAe,MAAc;IAC/C,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,QACd,MAAM;IACX,IAAG,OAAO,OAAO;IACjB,OAAO;AACX;AAEO,eAAe;IAClB,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,IAAI,CAAC,OAAO;IAC3C,IAAG,OAAO,MAAM;AACpB;AAEO,SAAS,kBAAkB,QAA4B;IAC1D,MAAM,EAAC,MAAM,QAAQ,EAAC,GAAG,8IAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAM;QAC5D,SAAS,SAAS,QAAQ;IAC9B;IACA,OAAO,SAAS,YAAY;AAChC"}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/useAuth.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getCurrentUser, getUserProfile, onAuthStateChange } from \"../utils/auth\"\r\n\r\nexport function useAuth() {\r\n    const [user, setUser] = useState<any>(null)\r\n    const [profile, setProfile] = useState<any>(null)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        const loadUser = async () => {\r\n            try {\r\n                const userData = await getCurrentUser()\r\n                setUser(userData)\r\n\r\n                if(userData) {\r\n                    const profileData = await getUserProfile(userData.id)\r\n                    setProfile(profileData)\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Error loading user:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadUser()\r\n\r\n        const subscription = onAuthStateChange(async (newUser) => {\r\n            setUser(newUser)\r\n            if (newUser) {\r\n                const profileData = await getUserProfile(newUser.id)\r\n                setProfile(profileData)\r\n            } else {\r\n                setProfile(null)\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            subscription.unsubscribe()\r\n        }\r\n    },[])\r\n\r\n    return {user,profile,loading}\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKO,SAAS;;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAM;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;6BAAC;YACN,MAAM;8CAAW;oBACb,IAAI;wBACA,MAAM,WAAW,MAAM,IAAA,mJAAc;wBACrC,QAAQ;wBAER,IAAG,UAAU;4BACT,MAAM,cAAc,MAAM,IAAA,mJAAc,EAAC,SAAS,EAAE;4BACpD,WAAW;wBACf;oBACJ,EAAE,OAAO,OAAO;wBACZ,QAAQ,KAAK,CAAC,uBAAuB;oBACzC,SAAU;wBACN,WAAW;oBACf;gBACJ;;YACA;YAEA,MAAM,eAAe,IAAA,sJAAiB;kDAAC,OAAO;oBAC1C,QAAQ;oBACR,IAAI,SAAS;wBACT,MAAM,cAAc,MAAM,IAAA,mJAAc,EAAC,QAAQ,EAAE;wBACnD,WAAW;oBACf,OAAO;wBACH,WAAW;oBACf;gBACJ;;YAEA;qCAAO;oBACH,aAAa,WAAW;gBAC5B;;QACJ;4BAAE,EAAE;IAEJ,OAAO;QAAC;QAAK;QAAQ;IAAO;AAChC;GAvCgB"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/utils/messages.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\nimport { error } from \"console\";\r\nimport { ItemDto } from \"../types/type\";\r\n// to_user:users(id_user, rating)\r\nexport async function getInboxMessages(userId: string){\r\n    const {data, error} = await supabase\r\n        .from(\"messages_safe\")\r\n        .select(`\r\n            *\r\n            `)\r\n        .eq(\"to_user\", userId)\r\n        .eq(\"is_visible_for_receiver\", true)\r\n        .order(\"created_at\", {ascending: true})\r\n    if(error) throw error;  \r\n\r\n    const messages = (data || []).map(msg => {\r\n        const anonSetting = msg.user_anonymous_settings?.[0]?.is_anon\r\n        return {\r\n            ...msg,\r\n            displayId: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_public_id,\r\n            username: (anonSetting || msg.is_anon) ? \"Anon\" : msg.from_username,\r\n        }\r\n    })\r\n\r\n    return messages \r\n}\r\n\r\nexport async function getCurrentMessage(messageId: string, userId: string, isMine?: string | null) {\r\n    console.log('Querying message:', { messageId, userId })\r\n    const {data, error} = await supabase\r\n    .from(\"messages_safe\")\r\n    .select(\"*\")\r\n    .eq(\"id\", messageId)\r\n    .eq(isMine===\"true\" ? \"from_user\" : \"to_user\", userId)\r\n    .maybeSingle()\r\n    console.log('Query result:', { data, error })\r\n    if (error) throw error\r\n    return data || []\r\n}\r\n\r\nexport async function getSentMessages(userId: string) {\r\n    const {data, error} = await supabase\r\n        .from('messages_safe')\r\n        .select(`\r\n            *`)\r\n        .eq(\"from_user\", userId)\r\n        .eq(\"is_visible_to_sender\", true)\r\n        .order(\"created_at\", {ascending: true})\r\n    \r\n    if(error) throw error\r\n    return data || []\r\n\r\n}\r\n\r\nexport async function sendMessage({\r\n    fromUserId,\r\n    toUserId,\r\n    toPublicId,\r\n    body,\r\n    isAnon\r\n}: {\r\n    fromUserId: string,\r\n    toUserId?: string,\r\n    toPublicId?: string,\r\n    body: ItemDto[],\r\n    isAnon?: boolean\r\n}) {\r\n    let receiverId = toUserId\r\n\r\n    if (!receiverId){\r\n        if (!toPublicId) throw new Error(\"–ù–µ —É–∫–∞–∑–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –º–∞–ª—ã—à\")\r\n            const {data: receiver, error: userError} = await supabase\r\n                .from(\"users\") \r\n                .select(\"id_user\")\r\n                .eq(\"public_id\", toPublicId)\r\n                .single()\r\n            if(userError || !receiver){\r\n                throw new Error(\"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∏ÃÜ–¥–µ–Ω, –∫–∏—Å—å\")\r\n            }\r\n        receiverId = receiver.id_user\r\n    }\r\n\r\n    const {data: toggle, error: toggleError} = await supabase.rpc(\"toggle_anonymous\", {\r\n                p_from: fromUserId, \r\n                p_to: receiverId, \r\n                p_is_anon: isAnon\r\n            })\r\n\r\n    if(toggleError) throw toggleError\r\n\r\n    const {error: messageError} = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n            from_user: fromUserId,\r\n            to_user: receiverId,\r\n            body,\r\n        })\r\n    if(messageError) throw messageError\r\n\r\n    return toggle\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAIO,eAAe,iBAAiB,MAAc;IACjD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;;YAEL,CAAC,EACJ,EAAE,CAAC,WAAW,QACd,EAAE,CAAC,2BAA2B,MAC9B,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IACzC,IAAG,OAAO,MAAM;IAEhB,MAAM,WAAW,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAA;QAC9B,MAAM,cAAc,IAAI,uBAAuB,EAAE,CAAC,EAAE,EAAE;QACtD,OAAO;YACH,GAAG,GAAG;YACN,WAAW,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,cAAc;YACrE,UAAU,AAAC,eAAe,IAAI,OAAO,GAAI,SAAS,IAAI,aAAa;QACvE;IACJ;IAEA,OAAO;AACX;AAEO,eAAe,kBAAkB,SAAiB,EAAE,MAAc,EAAE,MAAsB;IAC7F,QAAQ,GAAG,CAAC,qBAAqB;QAAE;QAAW;IAAO;IACrD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,WAAS,SAAS,cAAc,WAAW,QAC9C,WAAW;IACZ,QAAQ,GAAG,CAAC,iBAAiB;QAAE;QAAM;IAAM;IAC3C,IAAI,OAAO,MAAM;IACjB,OAAO,QAAQ,EAAE;AACrB;AAEO,eAAe,gBAAgB,MAAc;IAChD,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,iBACL,MAAM,CAAC,CAAC;aACJ,CAAC,EACL,EAAE,CAAC,aAAa,QAChB,EAAE,CAAC,wBAAwB,MAC3B,KAAK,CAAC,cAAc;QAAC,WAAW;IAAI;IAEzC,IAAG,OAAO,MAAM;IAChB,OAAO,QAAQ,EAAE;AAErB;AAEO,eAAe,YAAY,EAC9B,UAAU,EACV,QAAQ,EACR,UAAU,EACV,IAAI,EACJ,MAAM,EAOT;IACG,IAAI,aAAa;IAEjB,IAAI,CAAC,YAAW;QACZ,IAAI,CAAC,YAAY,MAAM,IAAI,MAAM;QAC7B,MAAM,EAAC,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAC,GAAG,MAAM,8IAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC,WACP,EAAE,CAAC,aAAa,YAChB,MAAM;QACX,IAAG,aAAa,CAAC,UAAS;YACtB,MAAM,IAAI,MAAM;QACpB;QACJ,aAAa,SAAS,OAAO;IACjC;IAEA,MAAM,EAAC,MAAM,MAAM,EAAE,OAAO,WAAW,EAAC,GAAG,MAAM,8IAAQ,CAAC,GAAG,CAAC,oBAAoB;QACtE,QAAQ;QACR,MAAM;QACN,WAAW;IACf;IAER,IAAG,aAAa,MAAM;IAEtB,MAAM,EAAC,OAAO,YAAY,EAAC,GAAG,MAAM,8IAAQ,CACvC,IAAI,CAAC,YACL,MAAM,CAAC;QACJ,WAAW;QACX,SAAS;QACT;IACJ;IACJ,IAAG,cAAc,MAAM;IAEvB,OAAO;AACX"}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/utils/parseDate.ts"],"sourcesContent":["export function parseBackendDate(raw: string): Date {\r\n    if (!raw) return new Date(NaN)\r\n\r\n    return new Date(\r\n    raw\r\n      .replace(\" \", \"T\")\r\n      .replace(/\\.\\d+/, m => m.slice(0, 4)) // –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã ‚Üí 3 –∑–Ω–∞–∫–∞\r\n      .replace(/\\+00:?00$/, \"Z\"))            // +00 or +00:00 ‚Üí Z\r\n\r\n}\r\n\r\nexport function parseDate(date: Date): string {\r\n    return date.toLocaleString(\"ru-RU\", {\r\n        day: \"2-digit\",\r\n        month: \"2-digit\",\r\n        year: \"numeric\",\r\n        hour: \"2-digit\",\r\n        minute: \"2-digit\",\r\n    })\r\n}"],"names":[],"mappings":";;;;;;AAAO,SAAS,iBAAiB,GAAW;IACxC,IAAI,CAAC,KAAK,OAAO,IAAI,KAAK;IAE1B,OAAO,IAAI,KACX,IACG,OAAO,CAAC,KAAK,KACb,OAAO,CAAC,SAAS,CAAA,IAAK,EAAE,KAAK,CAAC,GAAG,IAAI,yBAAyB;KAC9D,OAAO,CAAC,aAAa,MAAiB,oBAAoB;;AAEjE;AAEO,SAAS,UAAU,IAAU;IAChC,OAAO,KAAK,cAAc,CAAC,SAAS;QAChC,KAAK;QACL,OAAO;QACP,MAAM;QACN,MAAM;QACN,QAAQ;IACZ;AACJ"}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/types/type.ts"],"sourcesContent":["import { parseBackendDate } from \"../utils/parseDate\";\r\n\r\nexport type BaseItem = {\r\n    id: number;\r\n    x: number,\r\n    y: number,\r\n    w: number,\r\n    h: number,\r\n    scaleX?: number,\r\n    scaleY?: number,\r\n    rotation?: number,\r\n    isSelected?: boolean\r\n}\r\n\r\nexport type TextItem = BaseItem & {\r\n    type: \"text\"\r\n    content: string\r\n    fontSize?: number\r\n    color?: string\r\n    isEditing: string\r\n}\r\n\r\nexport type GifItem = BaseItem & {\r\n    type: \"gif\",\r\n    src: string,\r\n    autoplay?: boolean\r\n    loop?: boolean\r\n}\r\n\r\nexport type Item = TextItem | GifItem\r\n\r\n\r\n// DTO\r\nexport type BaseItemDto = {\r\n    id: number\r\n    x: number,\r\n    y: number,\r\n    w: number,\r\n    h: number,\r\n    scaleX?: number,\r\n    scaleY?: number,\r\n    rotation?: number\r\n    type: \"text\" | \"gif\"\r\n}\r\nexport type TextItemDto = BaseItemDto & {\r\n    type: \"text\",\r\n    content: string,\r\n    fontSize?: number\r\n    color?: string\r\n}\r\nexport type GifItemDto = BaseItemDto & {\r\n    type: \"gif\",\r\n    src: string,\r\n    autoplay?: boolean\r\n    loop?: boolean\r\n}\r\nexport type ItemDto = TextItemDto | GifItemDto\r\n\r\n\r\n\r\nexport function itemDtoToItem(dto: ItemDto): Item {\r\n    if(dto.type === 'text') {\r\n        return {\r\n            ...dto, \r\n            isEditing: 'none', \r\n            isSelected: false\r\n        }\r\n    }\r\n\r\n    return {\r\n        ...dto, \r\n        isSelected: false\r\n    }\r\n}\r\nexport function itemDtoListToItems(dtos: ItemDto[]): Item[] {\r\n  return dtos.map(itemDtoToItem)\r\n}\r\n\r\n\r\n\r\nexport type Message = {\r\n    id: string,\r\n    body: ItemDto[],\r\n    created_at: string,\r\n    is_anon: boolean,\r\n    is_checked: boolean,\r\n    to_user_rating: number,\r\n    \r\n    from_user: string,\r\n    to_user: string,\r\n    from_display_id: string,\r\n    to_display_id: string,\r\n}\r\n\r\nexport type UiMessage = Omit<Message, \"body\" | 'created_at'> & {\r\n    body: Item[]\r\n    created_at: Date\r\n}\r\n\r\nexport function messageDtoToUiMessage(dto: Message): UiMessage {\r\n    return {\r\n        ...dto,\r\n        body: itemDtoListToItems(dto.body),\r\n        created_at: parseBackendDate(dto.created_at),\r\n    }\r\n}\r\n\r\n\r\n//viewport\r\nexport type Viewport ={\r\n    scale: number,\r\n    offsetX: number,\r\n    offsetY: number\r\n}\r\n\r\n\r\n\r\nexport type Particle = {\r\n  x: number\r\n  y: number\r\n  vx: number\r\n  vy: number\r\n  alpha: number\r\n  r: number\r\n  g: number\r\n  b: number\r\n}"],"names":[],"mappings":";;;;;;;;AAAA;;AA4DO,SAAS,cAAc,GAAY;IACtC,IAAG,IAAI,IAAI,KAAK,QAAQ;QACpB,OAAO;YACH,GAAG,GAAG;YACN,WAAW;YACX,YAAY;QAChB;IACJ;IAEA,OAAO;QACH,GAAG,GAAG;QACN,YAAY;IAChB;AACJ;AACO,SAAS,mBAAmB,IAAe;IAChD,OAAO,KAAK,GAAG,CAAC;AAClB;AAuBO,SAAS,sBAAsB,GAAY;IAC9C,OAAO;QACH,GAAG,GAAG;QACN,MAAM,mBAAmB,IAAI,IAAI;QACjC,YAAY,IAAA,0JAAgB,EAAC,IAAI,UAAU;IAC/C;AACJ"}},
    {"offset": {"line": 273, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/useMessages.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from \"react\"\r\nimport { supabase } from \"@/utils/supabase/alSupabase\"\r\nimport { getInboxMessages, getSentMessages, sendMessage, getCurrentMessage } from \"../utils/messages\"\r\nimport { ItemDto, Item, Message, UiMessage, itemDtoListToItems, messageDtoToUiMessage } from \"../types/type\"\r\nimport { sendTelegramNotification } from \"@/app/telegram/sendTelegramNotification\"\r\n\r\n\r\nexport function useMessages(userId: string | null) {\r\n    const [inbox, setInbox] = useState<UiMessage[]>([])\r\n    const [sent, setSent] = useState<UiMessage[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n\r\n    const loadMessage = async () => {\r\n        if(!userId) return\r\n\r\n        try{\r\n            setLoading(true)\r\n            const [inboxData, sentData] = await Promise.all([\r\n                getInboxMessages(userId), \r\n                getSentMessages(userId)\r\n            ])\r\n\r\n            setInbox(inboxData.map(messageDtoToUiMessage))\r\n            setSent(sentData.map(messageDtoToUiMessage))\r\n        } catch (error) {\r\n            console.error(\"Error loading messages:\", error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadMessage()\r\n    },[userId])\r\n\r\n    const send = async (\r\n        to: {publicId?: string, userId?: string}, \r\n        body: ItemDto[],\r\n        isAnon?: boolean \r\n    ) => {\r\n        if(!userId) throw new Error(\"User not logged in\")\r\n\r\n        let receiverId = to.userId\r\n\r\n        if (!receiverId){\r\n            if(!to.publicId) throw new Error(\"–ù–µ —É–∫–∞–∑–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –º–∞–ª—ã—à\")\r\n\r\n            const {data: receiver, error: userError} = await supabase\r\n                .from(\"users\") \r\n                .select(\"id_user\")\r\n                .eq(\"public_id\", to.publicId)\r\n                .single()\r\n            if(userError || !receiver){\r\n                throw new Error(\"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∏ÃÜ–¥–µ–Ω, –∫–∏—Å—å\")\r\n            }\r\n            receiverId = receiver.id_user\r\n        }\r\n        \r\n        const {data, error} = await supabase.rpc(\"toggle_anonymous\", {\r\n            p_from: userId, \r\n            p_to: receiverId, \r\n            p_is_anon: isAnon\r\n        })\r\n        if(error) throw error\r\n\r\n        const {error: errorMsg} = await supabase\r\n            .from(\"messages\")\r\n            .insert({\r\n                from_user: userId, \r\n                to_user: receiverId, \r\n                body\r\n            })\r\n        if(errorMsg) throw errorMsg\r\n\r\n        // —É–≤–µ–¥–æ–º–ª—è–µ–º –æ —Å–æ–æ–±—â–µ–Ω–∏–∏\r\n        await fetch(\"/api/telegram/sendNotifyTg\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({ \r\n                userId: receiverId, \r\n                text: `–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç ${userId}` \r\n            })\r\n        })\r\n\r\n        await loadMessage()\r\n\r\n        return data\r\n    }\r\n\r\n    const deleteMessage = async (ids: string[] ) => {\r\n        if (!ids.length) {\r\n            console.warn(\"Message ID is required\")\r\n            return\r\n        }\r\n        \r\n        const {error} = await supabase.rpc(\"hide_message_for_me\", {\r\n            msg_id: ids\r\n        })\r\n        if(error) {\r\n            console.error(\"Failed to delete message:\", error)\r\n            throw error\r\n        }\r\n    }\r\n\r\n    return {\r\n        inbox,\r\n        sent,\r\n        loading,\r\n        sendMessage: send,\r\n        refresh: loadMessage,\r\n        deleteMessage\r\n    }\r\n\r\n}\r\n\r\ntype UseCurrentMessageResult = {    \r\n    message: UiMessage | null,\r\n    loading: boolean\r\n}\r\nexport function useCurrentMessage(\r\n    userId: string | null, \r\n    messageId: string | null,\r\n    isMine?: string | null\r\n): UseCurrentMessageResult {\r\n    const [message, setMessage] = useState<UiMessage | null>(null)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        if (!userId || !messageId) return\r\n\r\n        const loadMessage = async () => {\r\n            setLoading(true)\r\n            try{\r\n                const data = await getCurrentMessage(messageId, userId, isMine)\r\n                setMessage(messageDtoToUiMessage(data))\r\n            } catch (error) {\r\n                console.error(\"Error loading messages:\", error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n        loadMessage()\r\n\r\n    }, [userId, messageId])\r\n\r\n    return {\r\n        message,\r\n        loading\r\n    }\r\n}\r\n\r\n\r\n\r\nexport type Dialog = {\r\n    userId: string,\r\n    displayId: string,\r\n\r\n    lastMessage: UiMessage,\r\n    messages: UiMessage[],\r\n    count: number,\r\n    rating?: number\r\n}\r\n\r\n\r\nexport function useDialogs(\r\n    inboxMessages: UiMessage[],\r\n    sentMessages: UiMessage[],\r\n    myUserId: string,\r\n    myPublicId: string\r\n) {\r\n    const dialogs = useMemo<Dialog[]>(() => {\r\n        const map = new Map<string, Dialog>()\r\n\r\n        const allMessages = [...inboxMessages, ...sentMessages]\r\n\r\n        for (const msg of allMessages){\r\n            const dialogUserId = msg.from_user === myUserId\r\n                ? msg.to_user\r\n                : msg.from_user\r\n\r\n            let displayId = ''\r\n            if(msg.from_display_id === 'A'){\r\n                displayId = 'Anon'\r\n            } else{ \r\n                displayId = msg.from_display_id === myPublicId\r\n                    ? msg.to_display_id\r\n                    : msg.from_display_id\r\n            }\r\n\r\n            if(!map.has(dialogUserId)) {\r\n                map.set(dialogUserId, {\r\n                    userId: dialogUserId,\r\n                    displayId: displayId,\r\n\r\n                    lastMessage: msg,\r\n                    messages: [msg],\r\n                    count: 1,\r\n                    rating: msg.to_user_rating\r\n                })\r\n            } else{\r\n                const dialog = map.get(dialogUserId)!\r\n                dialog.messages.push(msg)\r\n                dialog.count++\r\n\r\n                if(msg.created_at > dialog.lastMessage.created_at){\r\n                    dialog.lastMessage = msg\r\n                }\r\n            }\r\n        }\r\n\r\n        return Array.from(map.values()).sort(\r\n            (a,b) =>\r\n                b.lastMessage.created_at.getTime() -\r\n                a.lastMessage.created_at.getTime()\r\n        )\r\n    }, [inboxMessages, sentMessages, myUserId])\r\n\r\n    return dialogs\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 467, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/useSwipe.ts"],"sourcesContent":["import { on } from \"events\";\r\nimport { useRef } from \"react\";\r\n\r\ntype SwipeConfig = {\r\n    onSwipeLeft?: () => void,\r\n    onSwipeRight?: () => void,\r\n    threshold?: number\r\n}\r\n\r\nexport function useSwipe({\r\n    onSwipeLeft,\r\n    onSwipeRight,\r\n    threshold = 50\r\n}: SwipeConfig) {\r\n    const startX = useRef<number | null>(null);\r\n\r\n    const onTouchStart = (e: React.TouchEvent) => {\r\n        startX.current = e.touches[0].clientX;\r\n    }\r\n\r\n    const onTouchEnd = (e: React.TouchEvent) => {\r\n        if (startX.current === null) return;\r\n\r\n        const endX = e.changedTouches[0].clientX;\r\n        const delta = endX - startX.current;\r\n\r\n        if(Math.abs(delta) > threshold) {\r\n            if(delta > 0) onSwipeRight?.()\r\n            else onSwipeLeft?.()\r\n        }\r\n\r\n        startX.current = null;\r\n    }\r\n\r\n    return {\r\n        onTouchStart,\r\n        onTouchEnd\r\n    }\r\n}"],"names":[],"mappings":";;;;AACA;;;AAQO,SAAS,SAAS,EACrB,WAAW,EACX,YAAY,EACZ,YAAY,EAAE,EACJ;;IACV,MAAM,SAAS,IAAA,uKAAM,EAAgB;IAErC,MAAM,eAAe,CAAC;QAClB,OAAO,OAAO,GAAG,EAAE,OAAO,CAAC,EAAE,CAAC,OAAO;IACzC;IAEA,MAAM,aAAa,CAAC;QAChB,IAAI,OAAO,OAAO,KAAK,MAAM;QAE7B,MAAM,OAAO,EAAE,cAAc,CAAC,EAAE,CAAC,OAAO;QACxC,MAAM,QAAQ,OAAO,OAAO,OAAO;QAEnC,IAAG,KAAK,GAAG,CAAC,SAAS,WAAW;YAC5B,IAAG,QAAQ,GAAG;iBACT;QACT;QAEA,OAAO,OAAO,GAAG;IACrB;IAEA,OAAO;QACH;QACA;IACJ;AACJ;GA7BgB"}},
    {"offset": {"line": 503, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/checkMobile.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\n\r\nexport function useCheckMobile(breakPoint = 768) {\r\n    const [isMobile, setIsMobile] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const check = () => {\r\n            setIsMobile(window.innerWidth <= 768)\r\n        }\r\n        check()\r\n        window.addEventListener('resize', check)\r\n        return () => window.removeEventListener('resize', check)\r\n    },[breakPoint])\r\n\r\n    return isMobile\r\n}"],"names":[],"mappings":";;;;AAAA;;;AAEO,SAAS,eAAe,aAAa,GAAG;;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,IAAA,0KAAS;oCAAC;YACN,MAAM;kDAAQ;oBACV,YAAY,OAAO,UAAU,IAAI;gBACrC;;YACA;YACA,OAAO,gBAAgB,CAAC,UAAU;YAClC;4CAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;;QACtD;mCAAE;QAAC;KAAW;IAEd,OAAO;AACX;GAbgB"}},
    {"offset": {"line": 539, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/createcard/components/ReadIndicator.tsx"],"sourcesContent":["export function ReadIndicator({\r\n    isRead,\r\n    isMine\r\n}: {\r\n    isRead: boolean\r\n    isMine?: boolean\r\n}) {\r\n\r\n    return (\r\n    <>\r\n        {isMine && (\r\n            <div className=\"flex items-center gap-1 text-xs\">\r\n                {isRead \r\n                ?(\r\n                    <>\r\n                    {/* –î–≤–æ–π–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ - –ø—Ä–æ—á–∏—Ç–∞–Ω–æ */}\r\n                        <svg \r\n                            className=\"w-4 h-4 text-blue-400\" \r\n                            viewBox=\"0 0 24 24\" \r\n                            fill=\"none\"\r\n                        >\r\n                            <path \r\n                                d=\"M1 12l4 4L15 6M9 12l4 4L23 6\" \r\n                                stroke=\"currentColor\" \r\n                                strokeWidth=\"2\" \r\n                                strokeLinecap=\"round\" \r\n                                strokeLinejoin=\"round\"\r\n                            />\r\n                        </svg>\r\n                    </>\r\n                ):(\r\n                    <>\r\n                        {/* –û–¥–Ω–∞ –≥–∞–ª–æ—á–∫–∞ - –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ */}\r\n                        <svg \r\n                            className=\"w-4 h-4 text-gray-400\" \r\n                            viewBox=\"0 0 24 24\" \r\n                            fill=\"none\"\r\n                        >\r\n                            <path \r\n                                d=\"M5 12l4 4L19 6\" \r\n                                stroke=\"currentColor\" \r\n                                strokeWidth=\"2\" \r\n                                strokeLinecap=\"round\" \r\n                                strokeLinejoin=\"round\"\r\n                            />\r\n                        </svg>\r\n                        <span className=\"text-gray-400\">–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</span>\r\n                    </>\r\n                )}\r\n            </div>\r\n        )}\r\n\r\n        {!isMine && (\r\n            \r\n            <div className=\"flex items-center gap-1 text-md\">\r\n                {isRead \r\n                ?(\r\n                    <>\r\n                    {/*  –ø—Ä–æ—á–∏—Ç–∞–Ω–æ */}\r\n                        <div>\r\n                            ‚óè\r\n                        </div>\r\n                    </>\r\n                ):(\r\n                    <>\r\n                        {/* –Ω–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ */}\r\n                        <div>\r\n                            ‚óã\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n        )}\r\n    </>\r\n    )\r\n}"],"names":[],"mappings":";;;;;;AAAO,SAAS,cAAc,EAC1B,MAAM,EACN,MAAM,EAIT;IAEG,qBACA;;YACK,wBACG,6LAAC;gBAAI,WAAU;0BACV,uBAEG;8BAEI,cAAA,6LAAC;wBACG,WAAU;wBACV,SAAQ;wBACR,MAAK;kCAEL,cAAA,6LAAC;4BACG,GAAE;4BACF,QAAO;4BACP,aAAY;4BACZ,eAAc;4BACd,gBAAe;;;;;;;;;;;kDAK3B;;sCAEI,6LAAC;4BACG,WAAU;4BACV,SAAQ;4BACR,MAAK;sCAEL,cAAA,6LAAC;gCACG,GAAE;gCACF,QAAO;gCACP,aAAY;gCACZ,eAAc;gCACd,gBAAe;;;;;;;;;;;sCAGvB,6LAAC;4BAAK,WAAU;sCAAgB;;;;;;;;;;;;;YAM/C,CAAC,wBAEE,6LAAC;gBAAI,WAAU;0BACV,uBAEG;8BAEI,cAAA,6LAAC;kCAAI;;;;;;kDAKT;8BAEI,cAAA,6LAAC;kCAAI;;;;;;;;;;;;;;AAS7B;KA3EgB"}},
    {"offset": {"line": 645, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/createcard/components/Rating.tsx"],"sourcesContent":["type RatingProps = {\r\n    value?: number\r\n    className?: string\r\n}\r\n\r\nexport function Rating({value, className}: RatingProps) {\r\n    const rating = numberToRating(value)\r\n\r\n    return (\r\n        <div\r\n            className={`flex items-center gap-1 text-sm select-none ${className ?? ''}`}\r\n            title={rating.s}\r\n        >\r\n            <span>{rating.s}</span>\r\n            {/* {value !== undefined && (\r\n                <span className=\"text-gray-400 text-xs\">\r\n                    {value}\r\n                </span>\r\n            )} */}\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function numberToRating(rating?: number){\r\n    if (!rating || rating === 0) {\r\n        return {s: \"üò¥\"}\r\n    }\r\n\r\n    if (rating >= 5){\r\n        return {s: \"‚ù§Ô∏èÔ∏è\"}\r\n    }\r\n\r\n    if (rating >= 10){\r\n        return {s: \"üî•\"}\r\n    }\r\n\r\n    if (rating >= 20){\r\n        return {s: \"üíò\"}\r\n    }\r\n\r\n    if (rating >= 50){\r\n        return {s: \"üëë‚úÆ\"}\r\n    }\r\n    \r\n    if (rating >= 100){\r\n        return {s: \"üëë\"}\r\n    }\r\n\r\n   return {s: \"ü•∞\"}\r\n}"],"names":[],"mappings":";;;;;;;;AAKO,SAAS,OAAO,EAAC,KAAK,EAAE,SAAS,EAAc;IAClD,MAAM,SAAS,eAAe;IAE9B,qBACI,6LAAC;QACG,WAAW,CAAC,4CAA4C,EAAE,aAAa,IAAI;QAC3E,OAAO,OAAO,CAAC;kBAEf,cAAA,6LAAC;sBAAM,OAAO,CAAC;;;;;;;;;;;AAS3B;KAjBgB;AAmBT,SAAS,eAAe,MAAe;IAC1C,IAAI,CAAC,UAAU,WAAW,GAAG;QACzB,OAAO;YAAC,GAAG;QAAI;IACnB;IAEA,IAAI,UAAU,GAAE;QACZ,OAAO;YAAC,GAAG;QAAK;IACpB;IAEA,IAAI,UAAU,IAAG;QACb,OAAO;YAAC,GAAG;QAAI;IACnB;IAEA,IAAI,UAAU,IAAG;QACb,OAAO;YAAC,GAAG;QAAI;IACnB;IAEA,IAAI,UAAU,IAAG;QACb,OAAO;YAAC,GAAG;QAAK;IACpB;IAEA,IAAI,UAAU,KAAI;QACd,OAAO;YAAC,GAAG;QAAI;IACnB;IAED,OAAO;QAAC,GAAG;IAAI;AAClB"}},
    {"offset": {"line": 716, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/useClickOutside.ts"],"sourcesContent":["import { useEffect } from \"react\";\r\n\r\nexport function useClickOutside(\r\n    ref: React.RefObject<HTMLElement>,\r\n    handler: () => void\r\n) {\r\n    useEffect(() => {\r\n        const listener = (e: MouseEvent | TouchEvent) => {\r\n            if(!ref.current) return\r\n            if(ref.current.contains(e.target as Node)) return\r\n            handler()\r\n        }\r\n\r\n        document.addEventListener(\"mousedown\", listener)\r\n        document.addEventListener(\"touchstart\", listener)\r\n\r\n        return () => {\r\n            document.removeEventListener(\"mousedown\", listener)\r\n            document.removeEventListener(\"touchstart\", listener)\r\n        }\r\n    },[ref, handler])\r\n}"],"names":[],"mappings":";;;;AAAA;;;AAEO,SAAS,gBACZ,GAAiC,EACjC,OAAmB;;IAEnB,IAAA,0KAAS;qCAAC;YACN,MAAM;sDAAW,CAAC;oBACd,IAAG,CAAC,IAAI,OAAO,EAAE;oBACjB,IAAG,IAAI,OAAO,CAAC,QAAQ,CAAC,EAAE,MAAM,GAAW;oBAC3C;gBACJ;;YAEA,SAAS,gBAAgB,CAAC,aAAa;YACvC,SAAS,gBAAgB,CAAC,cAAc;YAExC;6CAAO;oBACH,SAAS,mBAAmB,CAAC,aAAa;oBAC1C,SAAS,mBAAmB,CAAC,cAAc;gBAC/C;;QACJ;oCAAE;QAAC;QAAK;KAAQ;AACpB;GAnBgB"}},
    {"offset": {"line": 756, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/contextMenu/useContextMenuBehavior.ts"],"sourcesContent":["import { useEffect, useState, useLayoutEffect } from \"react\"\r\n\r\nexport function useContextMenuBehavior(\r\n    action: any,\r\n    onClose: () => void,\r\n    onDelete: (id: string) => void,\r\n    panelRef?: any,\r\n    isMine?: boolean\r\n) {\r\n    const [visible, setVisible] = useState(false)\r\n    const [confirm, setConfirm] = useState(false)\r\n    const [panelState, setPanelState] = useState<{ t: number; l: number; transform: string; transformOrigin: string }>({\r\n        t: action!.rect.top,\r\n        l: action!.rect.left,\r\n        transform: 'none',\r\n        transformOrigin: 'center'\r\n    });\r\n\r\n    useLayoutEffect(() => {\r\n        if (!action || !panelRef.current) return\r\n        const rect = action.rect\r\n        const panelW = panelRef.current.offsetWidth\r\n        const panelH = panelRef.current.offsetHeight\r\n        const viewport = {w: window.innerWidth, h: window.innerHeight}\r\n\r\n        let left: number\r\n        let transform: string\r\n        let transformOrigin: string\r\n        if (isMine){\r\n            left = rect.left - panelW \r\n            transformOrigin = 'right center'\r\n        } else {\r\n            left = rect.left + rect.width\r\n            transformOrigin = 'left center'\r\n\r\n        }\r\n        let top = rect.top\r\n        if (top + panelH > viewport.h){\r\n            top = viewport.h - panelH - 5\r\n        }\r\n        if(top < 0){\r\n            top = 5\r\n        }\r\n        setPanelState(prev => ({...prev, t: top, l: left, transformOrigin}))\r\n    },[action, isMine])\r\n\r\n    useEffect(() => {\r\n        if (action) {\r\n            requestAnimationFrame(() => {\r\n                setPanelState(prev => ({\r\n                    ...prev,\r\n                    transform: 'translateX(0%)'\r\n                }))\r\n                setVisible(true)\r\n            })\r\n        }\r\n    }, [action])\r\n\r\n    const closeAnimated = () => {\r\n        setVisible(false)\r\n\r\n        setTimeout(() => {\r\n            onClose?.()\r\n        }, 10)\r\n    }\r\n\r\n    const confirmDelete = () => {\r\n        onDelete?.(action?.message.id)\r\n        setConfirm(false)\r\n        closeAnimated()\r\n    }\r\n\r\n    return{\r\n        visible,\r\n        confirm,\r\n        setConfirm,\r\n        closeAnimated,\r\n        confirmDelete,\r\n        panelState,\r\n        setPanelState\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;AAEO,SAAS,uBACZ,MAAW,EACX,OAAmB,EACnB,QAA8B,EAC9B,QAAc,EACd,MAAgB;;IAEhB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAuE;QAC/G,GAAG,OAAQ,IAAI,CAAC,GAAG;QACnB,GAAG,OAAQ,IAAI,CAAC,IAAI;QACpB,WAAW;QACX,iBAAiB;IACrB;IAEA,IAAA,gLAAe;kDAAC;YACZ,IAAI,CAAC,UAAU,CAAC,SAAS,OAAO,EAAE;YAClC,MAAM,OAAO,OAAO,IAAI;YACxB,MAAM,SAAS,SAAS,OAAO,CAAC,WAAW;YAC3C,MAAM,SAAS,SAAS,OAAO,CAAC,YAAY;YAC5C,MAAM,WAAW;gBAAC,GAAG,OAAO,UAAU;gBAAE,GAAG,OAAO,WAAW;YAAA;YAE7D,IAAI;YACJ,IAAI;YACJ,IAAI;YACJ,IAAI,QAAO;gBACP,OAAO,KAAK,IAAI,GAAG;gBACnB,kBAAkB;YACtB,OAAO;gBACH,OAAO,KAAK,IAAI,GAAG,KAAK,KAAK;gBAC7B,kBAAkB;YAEtB;YACA,IAAI,MAAM,KAAK,GAAG;YAClB,IAAI,MAAM,SAAS,SAAS,CAAC,EAAC;gBAC1B,MAAM,SAAS,CAAC,GAAG,SAAS;YAChC;YACA,IAAG,MAAM,GAAE;gBACP,MAAM;YACV;YACA;0DAAc,CAAA,OAAQ,CAAC;wBAAC,GAAG,IAAI;wBAAE,GAAG;wBAAK,GAAG;wBAAM;oBAAe,CAAC;;QACtE;iDAAE;QAAC;QAAQ;KAAO;IAElB,IAAA,0KAAS;4CAAC;YACN,IAAI,QAAQ;gBACR;wDAAsB;wBAClB;gEAAc,CAAA,OAAQ,CAAC;oCACnB,GAAG,IAAI;oCACP,WAAW;gCACf,CAAC;;wBACD,WAAW;oBACf;;YACJ;QACJ;2CAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB;QAClB,WAAW;QAEX,WAAW;YACP;QACJ,GAAG;IACP;IAEA,MAAM,gBAAgB;QAClB,WAAW,QAAQ,QAAQ;QAC3B,WAAW;QACX;IACJ;IAEA,OAAM;QACF;QACA;QACA;QACA;QACA;QACA;QACA;IACJ;AACJ;GA/EgB"}},
    {"offset": {"line": 861, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/contextMenu/messagePanel.tsx"],"sourcesContent":["\"use client\"\r\nimport { useEffect, useLayoutEffect, useRef, useState } from \"react\"\r\nimport { useClickOutside } from \"../things/hooks/useClickOutside\" \r\nimport { useContextMenuBehavior } from \"./useContextMenuBehavior\"\r\n\r\ntype ActionState = {\r\n        message: any,\r\n        rect: DOMRect,\r\n        type: 'desktop' | 'mobile',\r\n        isMine: boolean\r\n    } | null\r\ntype Props = {\r\n    action: ActionState\r\n    onClose?: () => void\r\n    onDelete?: (id: string) => void\r\n    isChose: (v: boolean) => void\r\n    onChose?: (id: string) => void\r\n}\r\n\r\nexport function MessageActionRoot(props: Props) {\r\n    if(!props.action) return null\r\n\r\n    return props.action.type === 'desktop'\r\n        ? <DesktopCM {...props} /> \r\n        : <MobileCM {...props} />\r\n}\r\n\r\nexport function MobileCM({\r\n    action,\r\n    onClose,\r\n    onDelete,\r\n    isChose,\r\n    onChose\r\n}: Props) {\r\n    const ref = useRef<HTMLDivElement>(null!)\r\n    \r\n    const cloneRef = useRef<HTMLDivElement>(null!)\r\n    const panelRef = useRef<HTMLDivElement>(null!)\r\n    const [panelTop, setPanelTop] = useState<number | null>(null)\r\n    useClickOutside(ref, onClose!)\r\n\r\n    const {\r\n        visible, \r\n        confirm, \r\n        setConfirm, \r\n        closeAnimated,\r\n        confirmDelete\r\n    } = useContextMenuBehavior(action, onClose!, onDelete!, panelRef)\r\n\r\n    // –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–∏\r\n    useLayoutEffect(() => {\r\n        if(!cloneRef.current) return\r\n        const rect = cloneRef.current.getBoundingClientRect()\r\n        setPanelTop(rect.bottom + 8)\r\n    },[action])\r\n\r\n\r\n    const [shiftyY, setShiftyY] = useState(0)\r\n    useLayoutEffect(() => {\r\n        if (!action || !panelRef.current) return\r\n        const rect = action.rect\r\n        const panelHeight = panelRef.current.offsetHeight\r\n        const viewportH = window.innerHeight\r\n        const bottomNeed = rect.bottom + panelHeight\r\n\r\n        if (bottomNeed > viewportH) {\r\n            const overflow = bottomNeed - viewportH\r\n            setShiftyY(overflow )\r\n        } else{\r\n            setShiftyY(0)\r\n        }\r\n    }, [action])\r\n\r\n    \r\n    return (\r\n    <div \r\n        ref={ref}\r\n        >\r\n        {/* overlay */}\r\n        <div \r\n            className={`\r\n                fixed inset-0 bg-black/50 z-50 duration-250 ease-out\r\n                select-auto\r\n                ${visible\r\n                    ? 'opacity-100 '\r\n                    : 'opacity-0 '\r\n                }\r\n            `}\r\n            onClick={(e) => closeAnimated()}\r\n            onContextMenu={(e) => {\r\n                 e.preventDefault()\r\n            }}\r\n            />\r\n\r\n        {/* message */}\r\n        <div \r\n            ref={cloneRef}\r\n            className={`\r\n                fixed z-50 transition-all duration-100 ease-out\r\n                ${visible\r\n                    ? 'opacity-100 scale-105'\r\n                    : 'opacity-0 scale-95'}\r\n            `}\r\n            style={{\r\n                top: action!.rect.top - shiftyY,\r\n                left: action?.rect.left,\r\n                width: action?.rect.width,\r\n                height: action?.type === 'mobile' ? '' : action?.rect.height,\r\n                transformOrigin: 'center'\r\n            }}\r\n            >\r\n            <div className=\"scale-105 h-full rounded-2xl p-2 bg-white/10 backdrop-blur-2xl shadow-xl\">\r\n                {action?.message.from_display_id}\r\n            </div>\r\n        </div>\r\n\r\n        {/* panel */}\r\n        <div\r\n            ref={panelRef}\r\n            className={`fixed z-50 transition-all duration-100 ease-out delay-75\r\n                    bg-white/50 backdrop-blur-2xl \r\n                    border border-black/10 \r\n                    rounded-lg shadow-lg\r\n                    min-w-[140px]\r\n                    select-none\r\n                    ${visible\r\n                        ? 'opacity-100 scale-105'\r\n                        : 'opacity-0 scale-95'\r\n                    }\r\n                `}\r\n                style={{\r\n                    top: panelTop! - shiftyY,\r\n                    left: `${action?.rect.left}px`\r\n                }}\r\n        >\r\n            <button\r\n                onClick={(e) => {\r\n                    e.preventDefault()\r\n                    e.stopPropagation()\r\n                    setConfirm(true)\r\n                }}\r\n                onContextMenu={(e) => {\r\n                 e.preventDefault()\r\n                }}\r\n                disabled={!action?.message.id}\r\n                className=\"w-full p-2 hover:bg-black/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n                –£–¥–∞–ª–∏—Ç—å\r\n            </button>\r\n\r\n            <button\r\n                className=\"w-full p-2 hover:bg-black/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                onClick={(e) => {\r\n                    e.preventDefault()\r\n                    isChose?.(true)\r\n                    onChose?.(action?.message.id)\r\n                    closeAnimated()\r\n                }}\r\n            >\r\n                –í—ã–±—Ä–∞—Ç—å\r\n            </button>\r\n\r\n        </div>\r\n        \r\n        {confirm && (\r\n            <div\r\n                className=\"absolute left-1/2 top-1/2 translate-x-[-50%] translate-y-[-50%] flexC flex-col\r\n                bg-linear-to-br from-white/20 to-white/40 z-50 w-90 h-30\r\n                backdrop-blur-2xl rounded-xl border border-white/20\r\n                \"\r\n            >\r\n                –£–¥–∞–ª–∏—Ç—å —É —Å–µ–±—è?\r\n                <div className=\"flex gap-10\">\r\n                    <button className=\"prettyBtn\" \r\n                        autoFocus\r\n                        onClick={(e) => {\r\n                            e.preventDefault()\r\n                            e.stopPropagation()\r\n                            confirmDelete()\r\n                        }}\r\n\r\n                    >\r\n                        –î–∞\r\n                    </button>\r\n                    <button\r\n                        className=\"prettyBtn\"\r\n                        onClick={() => {\r\n                            setConfirm(false)\r\n                            closeAnimated()\r\n                        }}\r\n                    >\r\n                        –ù–µ—Ç\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        )}\r\n    </div>\r\n    )\r\n}\r\n\r\nfunction DesktopCM(props: Props) {\r\n    const { action, isChose, onChose, onDelete, onClose } = props\r\n\r\n    const ref = useRef<HTMLDivElement>(null!)\r\n    const panelRef = useRef<HTMLDivElement>(null!)\r\n    const isMine = action?.isMine ?? false\r\n    const {\r\n        visible, \r\n        confirm, \r\n        setConfirm, \r\n        closeAnimated,\r\n        confirmDelete,\r\n        panelState, setPanelState,\r\n    } = useContextMenuBehavior(action, onClose!, onDelete!, panelRef ,isMine)\r\n    \r\n    useClickOutside(ref, closeAnimated!)\r\n    \r\n    return(\r\n       <div \r\n        ref={ref}\r\n        >\r\n        {/* panel */}\r\n        <div\r\n            ref={panelRef}\r\n            className={`fixed z-50 transition-opacity duration-100 ease-in-out\r\n                    flexC flex-col\r\n                    bg-white/50 backdrop-blur-2xl \r\n                    border border-black/10 \r\n                    rounded-lg shadow-lg\r\n                    min-w-[140px]\r\n                    select-none text-[12px]\r\n                    ${visible\r\n                        ? 'opacity-100 scale-100'\r\n                        : 'opacity-0 scale-95'\r\n                    }\r\n                `}\r\n                style={{\r\n                    top: panelState.t,\r\n                    left: panelState.l,\r\n                    transform: panelState.transform,\r\n                    transformOrigin: panelState.transformOrigin,\r\n                    height: action?.rect.height,\r\n                }}\r\n        >\r\n            <button\r\n                onClick={(e) => {\r\n                    e.preventDefault()\r\n                    e.stopPropagation()\r\n                    setConfirm(true)\r\n                }}\r\n                onContextMenu={(e) => {\r\n                 e.preventDefault()\r\n                }}\r\n                disabled={!action?.message.id}\r\n                className=\"w-full h-full p-2 hover:bg-black/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n                –£–¥–∞–ª–∏—Ç—å\r\n            </button>\r\n\r\n            <button\r\n                className=\"w-full h-full p-2 hover:bg-black/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                onClick={(e) => {\r\n                    e.preventDefault()\r\n                    isChose?.(true)\r\n                    onChose?.(action?.message.id)\r\n                    closeAnimated()\r\n                }}\r\n            >\r\n                –í—ã–±—Ä–∞—Ç—å\r\n            </button>\r\n\r\n        </div>\r\n        \r\n        {confirm && (\r\n            <div\r\n                className=\"absolute left-1/2 top-1/2 translate-x-[-50%] translate-y-[-50%] flexC flex-col\r\n                bg-linear-to-br from-white/20 to-white/40 z-50 w-90 h-30\r\n                backdrop-blur-2xl rounded-xl border border-white/20\r\n                \"\r\n            >\r\n                –£–¥–∞–ª–∏—Ç—å —É —Å–µ–±—è?\r\n                <div className=\"flex gap-10\">\r\n                    <button className=\"prettyBtn\" \r\n                        autoFocus\r\n                        onClick={(e) => {\r\n                            e.preventDefault()\r\n                            e.stopPropagation()\r\n                            confirmDelete()\r\n                        }}\r\n\r\n                    >\r\n                        –î–∞\r\n                    </button>\r\n                    <button\r\n                        className=\"prettyBtn\"\r\n                        onClick={() => {\r\n                            setConfirm(false)\r\n                            closeAnimated()\r\n                        }}\r\n                    >\r\n                        –ù–µ—Ç\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        )}\r\n    </div> \r\n    )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1222, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonMain/AnimatedButton.tsx"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\n\r\nexport function AnimatedButton({ \r\n    children,\r\n    openModal \r\n}: {\r\n    children: React.ReactNode,\r\n    openModal: () => void\r\n\r\n}) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n    const animationRef = useRef<number>(0);\r\n    const isHovering = useRef(false);\r\n\r\n    const sizeRef = useRef({w:0,h:0})\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current\r\n        const button = buttonRef.current\r\n        if(!canvas || !button) return;\r\n\r\n        const ctx = canvas.getContext(\"2d\");\r\n        if(!ctx) return;\r\n\r\n        const updateSize = () => {\r\n            const rect = canvas.parentElement!.getBoundingClientRect();\r\n            const dpr = window.devicePixelRatio || 1;\r\n\r\n            sizeRef.current.w = rect.width;\r\n            sizeRef.current.h = rect.height;\r\n\r\n            canvas.width = rect.width * dpr;\r\n            canvas.height = rect.height * dpr;\r\n            canvas.style.width = rect.width + \"px\"\r\n            canvas.style.height = rect.height + \"px\"\r\n            ctx.setTransform(dpr,0,0,dpr,0,0)\r\n        }\r\n        updateSize()\r\n\r\n        function getBtnCenter(){\r\n            const btn = button!.getBoundingClientRect()\r\n            const cvs = canvas!.getBoundingClientRect()\r\n            return{\r\n                x: cvs.width/2,\r\n                y: cvs.height/2\r\n            }\r\n        }\r\n\r\n        const particles: {\r\n            x: number,\r\n            y: number,\r\n            radius: number,\r\n            alpha: number,\r\n            life: number,\r\n            vx: number,\r\n            vy: number\r\n        }[] = []\r\n\r\n        const speed = 50\r\n        let lastTime = performance.now()\r\n\r\n        function animate(currentTime: number) {\r\n            if (!ctx || !canvas) return\r\n            const deltaTime = (currentTime - lastTime) / 1000\r\n            lastTime = currentTime\r\n\r\n            const {w , h} = sizeRef.current\r\n            ctx.clearRect(0,0, w, h)\r\n\r\n            \r\n            if(Math.random() < 0.06) {\r\n                const angle = Math.random() * Math.PI * 2\r\n                particles.push({\r\n                    x: Math.random() * w,\r\n                    y: Math.random() * h,\r\n                    radius: 1,\r\n                    alpha: 1,\r\n                    life: 1,\r\n                    vx: Math.cos(angle) * speed,\r\n                    vy: Math.sin(angle) * speed\r\n                })\r\n            }\r\n            const target = getBtnCenter()\r\n\r\n            for (let i = particles.length -1; i >= 0; i--) {\r\n                const p = particles[i];\r\n\r\n                p.life -= deltaTime * 0.3;\r\n                p.alpha = p.life\r\n                \r\n                if(isHovering.current) {\r\n                    const dx = target.x - p.x\r\n                    const dy = target.y - p.y\r\n                    const dist = Math.sqrt(dx * dx + dy * dy) + 0.001\r\n\r\n                    const force = Math.max(0, 1 - dist / 700) * 400;\r\n\r\n                    p.vx += (dx / dist) * force *deltaTime\r\n                    p.vy += (dy / dist) * force *deltaTime\r\n                } \r\n\r\n                // max speed\r\n                const speed = Math.hypot(p.vx, p.vy);\r\n                const maxSpeed = 160;\r\n                if (speed > maxSpeed) {\r\n                    p.vx = (p.vx / speed) * maxSpeed;\r\n                    p.vy = (p.vy / speed) * maxSpeed;\r\n                }\r\n\r\n                p.x += p.vx * deltaTime;\r\n                p.y += p.vy * deltaTime;\r\n\r\n                \r\n\r\n                if (p.alpha <= 0) {\r\n                    particles.splice(i, 1)\r\n                    continue\r\n                }\r\n                \r\n\r\n                ctx.globalAlpha = p.alpha;\r\n                ctx.shadowBlur = 1;\r\n                ctx.shadowColor = \"white\";\r\n                ctx.fillStyle = 'white';\r\n\r\n                ctx.beginPath();\r\n                ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\r\n                ctx.fill();\r\n            }\r\n            ctx.globalAlpha = 1\r\n            animationRef.current = requestAnimationFrame(animate)\r\n        }\r\n\r\n        animationRef.current = requestAnimationFrame(animate)\r\n        window.addEventListener('resize', updateSize)\r\n\r\n        return () => {\r\n            if (animationRef.current){\r\n                cancelAnimationFrame(animationRef.current)\r\n            }\r\n            window.removeEventListener('resize', updateSize)\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"relative flex justify-center items-center h-full w-full\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"absolute w-full h-full pointer-events-none z-1\"\r\n            >\r\n            </canvas>\r\n            <button\r\n                ref={buttonRef}\r\n                onClick={() => openModal()}\r\n                onMouseEnter={() => (isHovering.current = true)}\r\n                onMouseLeave={() => (isHovering.current = false)}\r\n                className=\"relative flex items-center justify-center z-2\"\r\n            >\r\n                {children}\r\n            </button>\r\n\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1381, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/useCheckMsg.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\n\r\nexport function useMessageRead(\r\n) {\r\n\r\n    const markAsRead = async (messageId: string, userId: string) => {\r\n    console.log(\"Trying to mark as read:\", { messageId, userId });\r\n    const { error } = await supabase\r\n        .from(\"messages\")\r\n        .update({ is_checked: true })\r\n        .eq(\"id\", messageId)\r\n        .eq(\"to_user\", userId)\r\n    if (error) {\r\n        console.error(\"Error marking message as read:\", error);\r\n    } \r\n};\r\n\r\n    const getReadStatus = async (messageId: string) => {\r\n        try {\r\n            const {data, error} = await supabase\r\n            .from(\"messages\")\r\n            .select('is_checked')\r\n            .eq('id', messageId)\r\n            .single()\r\n\r\n            if(error) throw error\r\n            return data.is_checked\r\n\r\n        } catch (err) {\r\n            console.error(err)\r\n            return false\r\n        }\r\n    }\r\n\r\n    return { markAsRead, getReadStatus}\r\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,SAAS;IAGZ,MAAM,aAAa,OAAO,WAAmB;QAC7C,QAAQ,GAAG,CAAC,2BAA2B;YAAE;YAAW;QAAO;QAC3D,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,8IAAQ,CAC3B,IAAI,CAAC,YACL,MAAM,CAAC;YAAE,YAAY;QAAK,GAC1B,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,WAAW;QACnB,IAAI,OAAO;YACP,QAAQ,KAAK,CAAC,kCAAkC;QACpD;IACJ;IAEI,MAAM,gBAAgB,OAAO;QACzB,IAAI;YACA,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,cACP,EAAE,CAAC,MAAM,WACT,MAAM;YAEP,IAAG,OAAO,MAAM;YAChB,OAAO,KAAK,UAAU;QAE1B,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC;YACd,OAAO;QACX;IACJ;IAEA,OAAO;QAAE;QAAY;IAAa;AACtC"}},
    {"offset": {"line": 1422, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonMain/useDeleteMessage.ts"],"sourcesContent":["type Props = {\r\n    choosenMsg: any\r\n    setChoosenMsg: (v: any[]) => void\r\n    setAction: (v: any) => void\r\n    setIsChoose: (v: boolean) => void\r\n    deleteMessage: (ids: string[]) => Promise<void>\r\n    refresh: () => Promise<void>\r\n}\r\nexport function useDeleteMessage(props: Props) {\r\n    const { setChoosenMsg, setAction, setIsChoose, choosenMsg, deleteMessage, refresh } = props\r\n\r\n    const handleDeleteMessage = async (ids: string[]) => {\r\n        try {\r\n            if (!ids) {\r\n                console.warn(\"No message ID provided\")\r\n                return\r\n            }\r\n            await deleteMessage(ids)\r\n            await refresh()\r\n            setAction(null)\r\n        } catch (error) {\r\n            console.error(\"Error deleting message:\", error)\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    return{handleDeleteMessage, }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAQO,SAAS,iBAAiB,KAAY;IACzC,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,WAAW,EAAE,UAAU,EAAE,aAAa,EAAE,OAAO,EAAE,GAAG;IAEtF,MAAM,sBAAsB,OAAO;QAC/B,IAAI;YACA,IAAI,CAAC,KAAK;gBACN,QAAQ,IAAI,CAAC;gBACb;YACJ;YACA,MAAM,cAAc;YACpB,MAAM;YACN,UAAU;QACd,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,2BAA2B;QAC7C;IACJ;IAIA,OAAM;QAAC;IAAqB;AAChC"}},
    {"offset": {"line": 1452, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonMain/DialogResizehandler.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\n\r\ntype Props = {\r\n    dialogPanelRef: React.RefObject<HTMLDivElement>\r\n}\r\n\r\nexport function DialogResizehandler(props: Props) {\r\n    const color = 'bg-linear-to-br from-white/20 to-white/10'\r\n    const handlerRef = useRef<HTMLDivElement>(null)\r\n    const [isHovered, setIsHovered] = useState(false)\r\n    const [isDragging, setIsDragging] = useState(false)\r\n    \r\n\r\n    \r\n\r\n    useEffect(() => {\r\n        if(!isDragging || !props.dialogPanelRef.current || !handlerRef.current) return\r\n\r\n        const panel = props.dialogPanelRef.current\r\n        const handle = handlerRef.current\r\n        const panelLeft = panel.getBoundingClientRect().left\r\n\r\n        const onMove = (e: MouseEvent | TouchEvent) => {\r\n            const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX\r\n\r\n            const newWidth = Math.max(200, clientX - panelLeft)\r\n\r\n            panel.style.width = `${newWidth}px`\r\n            handle.style.left = `${newWidth}px`\r\n        }\r\n        const onUp = () => {\r\n            setIsDragging(false)\r\n            setIsHovered(false)\r\n        }\r\n\r\n        window.addEventListener('mousemove', onMove)\r\n        window.addEventListener('mouseup', onUp)\r\n\r\n        return () => {\r\n            window.removeEventListener('mousemove', onMove)\r\n            window.removeEventListener('mouseup', onUp)\r\n        }\r\n    }, [isDragging, props.dialogPanelRef])\r\n\r\n    if(!props.dialogPanelRef.current) return null\r\n    return (\r\n        <div\r\n            ref={handlerRef}\r\n            className={`fixed top-0 h-full w-1 ${color} z-20 cursor-ew-resize\r\n            ${isHovered || isDragging ? 'opacity-100' : 'opacity-0'}\r\n            `}\r\n            style={{\r\n                left: props.dialogPanelRef.current.clientWidth\r\n            }}\r\n\r\n            onPointerEnter={(e) => {\r\n                setIsHovered(true)\r\n            }}\r\n            onPointerLeave={(e) => {\r\n                !isDragging && setIsHovered(false)\r\n            }}\r\n            onMouseDown={(e) => {\r\n                setIsDragging(true)\r\n            }}\r\n        >\r\n            \r\n        </div>\r\n    )\r\n}\r\n    "],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAQO,SAAS,oBAAoB,KAAY;;IAC5C,MAAM,QAAQ;IACd,MAAM,aAAa,IAAA,uKAAM,EAAiB;IAC1C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAK7C,IAAA,0KAAS;yCAAC;YACN,IAAG,CAAC,cAAc,CAAC,MAAM,cAAc,CAAC,OAAO,IAAI,CAAC,WAAW,OAAO,EAAE;YAExE,MAAM,QAAQ,MAAM,cAAc,CAAC,OAAO;YAC1C,MAAM,SAAS,WAAW,OAAO;YACjC,MAAM,YAAY,MAAM,qBAAqB,GAAG,IAAI;YAEpD,MAAM;wDAAS,CAAC;oBACZ,MAAM,UAAU,aAAa,IAAI,EAAE,OAAO,CAAC,EAAE,CAAC,OAAO,GAAG,EAAE,OAAO;oBAEjE,MAAM,WAAW,KAAK,GAAG,CAAC,KAAK,UAAU;oBAEzC,MAAM,KAAK,CAAC,KAAK,GAAG,GAAG,SAAS,EAAE,CAAC;oBACnC,OAAO,KAAK,CAAC,IAAI,GAAG,GAAG,SAAS,EAAE,CAAC;gBACvC;;YACA,MAAM;sDAAO;oBACT,cAAc;oBACd,aAAa;gBACjB;;YAEA,OAAO,gBAAgB,CAAC,aAAa;YACrC,OAAO,gBAAgB,CAAC,WAAW;YAEnC;iDAAO;oBACH,OAAO,mBAAmB,CAAC,aAAa;oBACxC,OAAO,mBAAmB,CAAC,WAAW;gBAC1C;;QACJ;wCAAG;QAAC;QAAY,MAAM,cAAc;KAAC;IAErC,IAAG,CAAC,MAAM,cAAc,CAAC,OAAO,EAAE,OAAO;IACzC,qBACI,6LAAC;QACG,KAAK;QACL,WAAW,CAAC,uBAAuB,EAAE,MAAM;YAC3C,EAAE,aAAa,aAAa,gBAAgB,YAAY;YACxD,CAAC;QACD,OAAO;YACH,MAAM,MAAM,cAAc,CAAC,OAAO,CAAC,WAAW;QAClD;QAEA,gBAAgB,CAAC;YACb,aAAa;QACjB;QACA,gBAAgB,CAAC;YACb,CAAC,cAAc,aAAa;QAChC;QACA,aAAa,CAAC;YACV,cAAc;QAClB;;;;;;AAKZ;GA9DgB;KAAA"}},
    {"offset": {"line": 1536, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonMain/useShatterMessage.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useRef } from \"react\"\r\nimport * as htmlToImage from \"html-to-image\"\r\n\r\nexport type Particle = {\r\n  x: number\r\n  y: number\r\n  vx: number\r\n  vy: number\r\n  alpha: number\r\n  r: number\r\n  g: number\r\n  b: number\r\n}\r\n\r\ntype ParticleSystem = {\r\n  particles: Particle[]\r\n}\r\n\r\ntype Options = {\r\n  pixelSize?: number\r\n  gravity?: number\r\n  fade?: number\r\n}\r\n\r\nexport function useShatterMessage(options?: Options) {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null)\r\n  const systemsRef = useRef<ParticleSystem[]>([])\r\n  const animatingRef = useRef(false)\r\n\r\n  const PIXEL_SIZE = options?.pixelSize ?? 2\r\n  const GRAVITY = options?.gravity ?? 0.03\r\n  const FADE = options?.fade ?? 0.035\r\n\r\n  const shatterMessages = async (\r\n    elements: HTMLDivElement[],\r\n    onAllDone: () => void\r\n  ) => {\r\n    if (!canvasRef.current || elements.length === 0) return\r\n\r\n    const canvas = canvasRef.current\r\n    const ctx = canvas.getContext(\"2d\", { willReadFrequently: true })!\r\n\r\n    canvas.width = window.innerWidth\r\n    canvas.height = window.innerHeight\r\n\r\n    for (const el of elements) {\r\n      const rect = el.getBoundingClientRect()\r\n\r\n      const renderCanvas = await htmlToImage.toCanvas(el, {\r\n        width: rect.width,\r\n        height: rect.height,\r\n        style: { transform: \"none\" },\r\n      })\r\n\r\n      const rctx = renderCanvas.getContext(\"2d\")!\r\n      const { data } = rctx.getImageData(\r\n        0,\r\n        0,\r\n        renderCanvas.width,\r\n        renderCanvas.height\r\n      )\r\n\r\n      const particles: Particle[] = []\r\n\r\n      for (let y = 0; y < renderCanvas.height; y += PIXEL_SIZE) {\r\n        for (let x = 0; x < renderCanvas.width; x += PIXEL_SIZE) {\r\n          const i = (y * renderCanvas.width + x) * 4\r\n          const a = data[i + 3]\r\n\r\n          if (a > 50) {\r\n            particles.push({\r\n              x: rect.left + (x / renderCanvas.width) * rect.width,\r\n              y: rect.top + (y / renderCanvas.height) * rect.height,\r\n              vx: (Math.random() ) * 1.7,\r\n              vy: (Math.random() -0.5) * -0.8,\r\n              alpha: 1,\r\n              r: data[i],\r\n              g: data[i + 1],\r\n              b: data[i + 2],\r\n            })\r\n          }\r\n        }\r\n      }\r\n\r\n      el.style.visibility = \"hidden\"\r\n      systemsRef.current.push({ particles })\r\n    }\r\n\r\n    if (!animatingRef.current) {\r\n      animatingRef.current = true\r\n      requestAnimationFrame(() =>\r\n        animate(ctx, canvas, onAllDone)\r\n      )\r\n    }\r\n  }\r\n\r\n  const animate = (\r\n    ctx: CanvasRenderingContext2D,\r\n    canvas: HTMLCanvasElement,\r\n    onAllDone: () => void\r\n  ) => {\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n\r\n    systemsRef.current = systemsRef.current.filter(system => {\r\n      system.particles.forEach(p => {\r\n        p.vy += GRAVITY\r\n        p.x += p.vx\r\n        p.y += p.vy\r\n        p.alpha -= FADE\r\n\r\n        if (p.alpha > 0) {\r\n          ctx.fillStyle = `rgba(${p.r},${p.g},${p.b},${p.alpha})`\r\n          ctx.fillRect(p.x, p.y, PIXEL_SIZE, PIXEL_SIZE)\r\n        }\r\n      })\r\n\r\n      system.particles = system.particles.filter(p => p.alpha > 0)\r\n      return system.particles.length > 0\r\n    })\r\n\r\n    if (systemsRef.current.length > 0) {\r\n      requestAnimationFrame(() =>\r\n        animate(ctx, canvas, onAllDone)\r\n      )\r\n    } else {\r\n      animatingRef.current = false\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n      onAllDone()\r\n    }\r\n  }\r\n\r\n  return {\r\n    canvasRef,\r\n    shatterMessages,\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1639, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/things/hooks/useSetAnon.ts"],"sourcesContent":["import { supabase } from \"@/utils/supabase/alSupabase\";\r\nimport { useState } from \"react\";\r\n\r\ntype SetAnonParams = {\r\n    from_user_id: string,\r\n    to_user_id: string,\r\n    is_anon: boolean\r\n}\r\n\r\nexport function useSetAnon() {\r\n    const [loading, setLoading] = useState(false)\r\n    const [error, setError] = useState<Error | null>(null)\r\n\r\n\r\n    const setAnon = async ({\r\n        from_user_id,\r\n        to_user_id,\r\n        is_anon\r\n    }: SetAnonParams) => {\r\n        try {\r\n            setLoading(true)\r\n            setError(null)\r\n\r\n            const {data, error} = await supabase.rpc(\"toggle_anonymous\", {\r\n                p_from: from_user_id, \r\n                p_to: to_user_id, \r\n                p_is_anon: is_anon\r\n            })\r\n\r\n            if(error) throw error\r\n\r\n            if (data === false){\r\n                throw new Error(\"–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å —É–∂–µ –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞\")\r\n            }\r\n            return data\r\n\r\n        } catch (err) {\r\n            setError(err as Error)\r\n            throw err\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const checkAnon = async (from_user_id: string, to_user_id: string) => {\r\n        try {\r\n            setLoading(true)\r\n            setError(null)\r\n\r\n            const {data, error} = await supabase\r\n                .from(\"user_anonymous_settings\")\r\n                .select(\"is_anon, anon_used_once\")\r\n                .eq(\"from_user_id\", from_user_id)\r\n                .eq(\"to_user_id\", to_user_id)\r\n                .maybeSingle()\r\n            if(error) throw error\r\n\r\n            if (!data) {\r\n                return {\r\n                    isAnon: false,\r\n                    anonUsedOnce: false,\r\n                    canToggle: true\r\n                }\r\n            }\r\n\r\n            return {\r\n                isAnon: data?.is_anon ?? false,\r\n                anonUsedOnce: data?.anon_used_once ?? false,\r\n                canToggle: !(data?.anon_used_once && !data.is_anon)\r\n            }\r\n        } catch (err) {\r\n            setError(err as Error)\r\n            throw err\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n        \r\n\r\n    return {setAnon, checkAnon, loading, error}\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAQO,SAAS;;IACZ,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAe;IAGjD,MAAM,UAAU,OAAO,EACnB,YAAY,EACZ,UAAU,EACV,OAAO,EACK;QACZ,IAAI;YACA,WAAW;YACX,SAAS;YAET,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAAC,GAAG,CAAC,oBAAoB;gBACzD,QAAQ;gBACR,MAAM;gBACN,WAAW;YACf;YAEA,IAAG,OAAO,MAAM;YAEhB,IAAI,SAAS,OAAM;gBACf,MAAM,IAAI,MAAM;YACpB;YACA,OAAO;QAEX,EAAE,OAAO,KAAK;YACV,SAAS;YACT,MAAM;QACV,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,YAAY,OAAO,cAAsB;QAC3C,IAAI;YACA,WAAW;YACX,SAAS;YAET,MAAM,EAAC,IAAI,EAAE,KAAK,EAAC,GAAG,MAAM,8IAAQ,CAC/B,IAAI,CAAC,2BACL,MAAM,CAAC,2BACP,EAAE,CAAC,gBAAgB,cACnB,EAAE,CAAC,cAAc,YACjB,WAAW;YAChB,IAAG,OAAO,MAAM;YAEhB,IAAI,CAAC,MAAM;gBACP,OAAO;oBACH,QAAQ;oBACR,cAAc;oBACd,WAAW;gBACf;YACJ;YAEA,OAAO;gBACH,QAAQ,MAAM,WAAW;gBACzB,cAAc,MAAM,kBAAkB;gBACtC,WAAW,CAAC,CAAC,MAAM,kBAAkB,CAAC,KAAK,OAAO;YACtD;QACJ,EAAE,OAAO,KAAK;YACV,SAAS;YACT,MAAM;QACV,SAAU;YACN,WAAW;QACf;IACJ;IAGA,OAAO;QAAC;QAAS;QAAW;QAAS;IAAK;AAC9C;GAvEgB"}},
    {"offset": {"line": 1713, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/modal/modalProfile.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\r\nimport { Dialog } from \"../things/hooks/useMessages\"\r\nimport { useSetAnon } from \"../things/hooks/useSetAnon\";\r\n\r\ntype ModalProfileProps = {\r\n  dialog: Dialog | null\r\n  onClose: () => void\r\n  fromUser: string\r\n  refresh: () => void\r\n}\r\n\r\nexport function ModalProfile({\r\n  dialog,\r\n  onClose,\r\n  fromUser, \r\n  refresh\r\n}: ModalProfileProps) {\r\n    const [isAnon, setIsAnon] = useState(false);\r\n    const [anonUsedOnce, setAnonUsedOnce] = useState(false);\r\n\r\n    const {setAnon, checkAnon, loading, error} = useSetAnon()\r\n\r\n\r\n    useEffect(() => {\r\n        if(!fromUser || !dialog) return\r\n\r\n        const load = async () => {\r\n            const data = await checkAnon(fromUser, dialog.userId)\r\n            if(!data) return\r\n\r\n            setIsAnon(data.isAnon)\r\n            setAnonUsedOnce(data.anonUsedOnce)\r\n        }\r\n\r\n        load()\r\n\r\n    }, [dialog,fromUser]);\r\n\r\n\r\n  if (!dialog) return null\r\n\r\n\r\n  return (\r\n    <div\r\n      className=\"\r\n        fixed inset-0 z-50\r\n        flex items-center justify-center\r\n        bg-black/60 backdrop-blur-sm\r\n        animate-fadeIn\r\n      \"\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        className=\"\r\n          w-full max-w-md\r\n          rounded-2xl\r\n          bg-[#12080b]\r\n          border border-white/10\r\n          shadow-2xl\r\n          p-6\r\n          animate-scaleIn\r\n          text-white\r\n        \"\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center text-lg font-bold\">\r\n              {dialog.displayId.charAt(1).toUpperCase()}\r\n            </div>\r\n\r\n            <div>\r\n              <div className=\"font-semibold\">{dialog.displayId}</div>\r\n              <div className=\"text-xs text-white/50\">–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-white/50 hover:text-white transition\"\r\n          >\r\n            ‚úï\r\n          </button>\r\n        </div>\r\n\r\n        {/* Body */}\r\n        <form\r\n          className=\"flex flex-col gap-5\"\r\n          onSubmit={async (e) => {\r\n            e.preventDefault()\r\n            try {\r\n                await setAnon({\r\n                    from_user_id: fromUser,\r\n                    to_user_id: dialog.userId,\r\n                    is_anon: isAnon\r\n                })\r\n\r\n                refresh()\r\n                onClose()\r\n            } catch {}\r\n          }}\r\n        >\r\n            {!loading \r\n            ?(\r\n                <label className=\"flex items-start gap-3 cursor-pointer\">\r\n                    <input\r\n                    type=\"checkbox\"\r\n                    className=\"\r\n                        mt-1\r\n                        w-4 h-4\r\n                        accent-red-500\r\n                    \"\r\n                    checked={isAnon}\r\n                    disabled={loading || anonUsedOnce && !isAnon}\r\n                    onChange={(e) => setIsAnon(e.target.checked)}\r\n                    />\r\n                    {anonUsedOnce && !isAnon \r\n                    ?(\r\n                        <span className=\"text-sm text-white/80\">\r\n                            –ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∞\r\n                            <div className=\"text-xs text-white/40\">\r\n                                –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑\r\n                            </div>\r\n                        </span>\r\n                    )\r\n                    : (\r\n                        <span className=\"text-sm text-white/80\">\r\n                            –ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\r\n                            <div className=\"text-xs text-white/40\">\r\n                                –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑\r\n                            </div>\r\n                        </span>\r\n                    )}\r\n\r\n                </label>\r\n            )\r\n            :(\r\n                <span className=\"text-sm text-white/80\">\r\n                    –ó–∞–≥—Ä—É–∑–∫–∞...\r\n                </span>\r\n            )\r\n            }\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex justify-end gap-3 mt-4\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"\r\n                px-4 py-2 rounded-lg\r\n                bg-white/5 hover:bg-white/10\r\n                text-sm transition\r\n              \"\r\n            >\r\n              –û—Ç–º–µ–Ω–∞\r\n            </button>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              className=\"\r\n                px-4 py-2 rounded-lg\r\n                bg-red-500 hover:bg-red-600\r\n                text-sm font-medium\r\n                transition\r\n              \"\r\n            >\r\n              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;;AASO,SAAS,aAAa,EAC3B,MAAM,EACN,OAAO,EACP,QAAQ,EACR,OAAO,EACW;;IAChB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD,MAAM,EAAC,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAC,GAAG,IAAA,qJAAU;IAGvD,IAAA,0KAAS;kCAAC;YACN,IAAG,CAAC,YAAY,CAAC,QAAQ;YAEzB,MAAM;+CAAO;oBACT,MAAM,OAAO,MAAM,UAAU,UAAU,OAAO,MAAM;oBACpD,IAAG,CAAC,MAAM;oBAEV,UAAU,KAAK,MAAM;oBACrB,gBAAgB,KAAK,YAAY;gBACrC;;YAEA;QAEJ;iCAAG;QAAC;QAAO;KAAS;IAGtB,IAAI,CAAC,QAAQ,OAAO;IAGpB,qBACE,6LAAC;QACC,WAAU;QAMV,SAAS;kBAET,cAAA,6LAAC;YACC,WAAU;YAUV,SAAS,CAAC,IAAM,EAAE,eAAe;;8BAGjC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;8CACZ,OAAO,SAAS,CAAC,MAAM,CAAC,GAAG,WAAW;;;;;;8CAGzC,6LAAC;;sDACC,6LAAC;4CAAI,WAAU;sDAAiB,OAAO,SAAS;;;;;;sDAChD,6LAAC;4CAAI,WAAU;sDAAwB;;;;;;;;;;;;;;;;;;sCAI3C,6LAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;8BAMH,6LAAC;oBACC,WAAU;oBACV,UAAU,OAAO;wBACf,EAAE,cAAc;wBAChB,IAAI;4BACA,MAAM,QAAQ;gCACV,cAAc;gCACd,YAAY,OAAO,MAAM;gCACzB,SAAS;4BACb;4BAEA;4BACA;wBACJ,EAAE,OAAM,CAAC;oBACX;;wBAEG,CAAC,wBAEE,6LAAC;4BAAM,WAAU;;8CACb,6LAAC;oCACD,MAAK;oCACL,WAAU;oCAKV,SAAS;oCACT,UAAU,WAAW,gBAAgB,CAAC;oCACtC,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,OAAO;;;;;;gCAE1C,gBAAgB,CAAC,uBAEd,6LAAC;oCAAK,WAAU;;wCAAwB;sDAEpC,6LAAC;4CAAI,WAAU;sDAAwB;;;;;;;;;;;yDAM3C,6LAAC;oCAAK,WAAU;;wCAAwB;sDAEpC,6LAAC;4CAAI,WAAU;sDAAwB;;;;;;;;;;;;;;;;;iDASnD,6LAAC;4BAAK,WAAU;sCAAwB;;;;;;sCAO9C,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CAKX;;;;;;8CAID,6LAAC;oCACC,MAAK;oCACL,WAAU;8CAMX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb;GAnKgB;;QASiC,qJAAU;;;KAT3C"}},
    {"offset": {"line": 1951, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/anonMain/chat/Chat.tsx"],"sourcesContent":["import { useState, useEffect, useRef, useLayoutEffect } from \"react\";\r\nimport { Dialog } from \"../../things/hooks/useMessages\";\r\nimport { parseDate } from \"../../things/utils/parseDate\";\r\nimport { ReadIndicator } from \"../../createcard/components/ReadIndicator\";\r\nimport { Particle, UiMessage } from \"../../things/types/type\";\r\nimport { Rating } from \"../../createcard/components/Rating\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { MessageActionRoot } from \"../../contextMenu/messagePanel\";\r\nimport { AnimatedButton } from \"../AnimatedButton\";\r\nimport { useMessageRead } from \"@/app/things/hooks/useCheckMsg\";\r\nimport { useDeleteMessage } from \"../useDeleteMessage\";\r\nimport { useSwipe } from \"@/app/things/hooks/useSwipe\";\r\nimport { DialogResizehandler } from \"../DialogResizehandler\";\r\nimport { useShatterMessage } from \"../useShatterMessage\";\r\nimport { ModalProfile } from \"@/app/modal/modalProfile\";\r\n\r\nexport type Props = {\r\n    userId: string | undefined;\r\n    dialogs: Dialog[];\r\n    setOpenProfile: (open: boolean) => void;\r\n    setOpenChat: (open: boolean) => void;\r\n    openChat: boolean;\r\n    isMobile: boolean;\r\n    deleteMessage: (id: string[]) => Promise<void>;\r\n    refresh: () => Promise<void>;\r\n}\r\n\r\nexport function ManagerChat(props: Props) {\r\n    const router = useRouter();\r\n    const {\r\n        userId,\r\n        dialogs,\r\n        setOpenProfile,\r\n        setOpenChat,\r\n        openChat,\r\n        isMobile,\r\n        refresh\r\n    } = props;\r\n    const { markAsRead } = useMessageRead();\r\n\r\n    const [activeChatUserId, setActiveChatUserId] = useState<string | null>(null);\r\n    const [activeDialogId, setActiveDialogId] = useState<string | null>(null);\r\n    const [activeDialog, setActiveDialog] = useState<Dialog | null>(null);\r\n\r\n    // modalProfileUser\r\n    const [openModalProfile, setOpenModalProfile] = useState<Dialog | null>(null); // state –º–æ–¥–∞–ª–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è\r\n\r\n    // messagePanel\r\n    const msgRef = useRef<HTMLDivElement>(null);\r\n    let timer = useRef<number | null>(null);\r\n    type ActionState = {\r\n        message: UiMessage;\r\n        rect: DOMRect;\r\n        type: \"desktop\" | \"mobile\";\r\n        isMine: boolean;\r\n    } | null;\r\n    const closeMenu = () => {\r\n        setAction(null);\r\n        setSelectTouched(null);\r\n    };\r\n    const cancelTouch = () => {\r\n        clearInterval(timer.current!);\r\n        setSelectTouched(null);\r\n    };\r\n    const [action, setAction] = useState<ActionState>(null);\r\n    const [isChoose, setIsChoose] = useState(false);\r\n    const [choosenMsg, setChoosenMsg] = useState<any[]>([]);\r\n    const [selectTouched, setSelectTouched] = useState<string | null>(null);\r\n    ////////\r\n\r\n    // dialogResizeHandler (—Ç–æ–ª—å–∫–æ –¥–ª—è desktop)\r\n    const dialogPanelRef = useRef<HTMLDivElement>(null!);\r\n\r\n    const {canvasRef, shatterMessages} = useShatterMessage({})\r\n\r\n    // —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è activeDialog —Å dialogs\r\n    useEffect(() => {\r\n        if (!activeDialogId) {\r\n            setActiveDialog(null);\r\n            return;\r\n        }\r\n        const found = dialogs.find((d) => d.userId === activeDialogId) || null;\r\n        setActiveDialog(found);\r\n    }, [dialogs, activeDialogId]);\r\n\r\n    const { handleDeleteMessage } = useDeleteMessage({\r\n        setChoosenMsg, setAction,setIsChoose,choosenMsg,\r\n        deleteMessage: props.deleteMessage, refresh: props.refresh,\r\n    });\r\n\r\n\r\n    const [deletingMsg, setDeletingMsg] = useState<string[]>([]);\r\n    const wrapperRef = useRef<Record<string, HTMLDivElement | null>>({})\r\n    const bubbleRef = useRef<Record<string, HTMLDivElement | null>>({})\r\n    \r\n    const handleRemoveMsg = async (ids: string[]) => {\r\n        if (!ids.length) return\r\n\r\n        const bubbles = ids\r\n            .map((id) => bubbleRef.current[id])\r\n            .filter((el): el is HTMLDivElement => Boolean(el));\r\n        const wrappers = ids\r\n            .map((id) => wrapperRef.current[id])\r\n            .filter((el): el is HTMLDivElement => Boolean(el));\r\n\r\n        wrappers.forEach(el => {\r\n            el.style.height = `${el.offsetHeight}px`\r\n        })\r\n\r\n        shatterMessages(bubbles, async () => {\r\n            requestAnimationFrame(() => {\r\n                setDeletingMsg([...ids])\r\n            })  \r\n            await Promise.all(wrappers.map(el =>\r\n                new Promise<void>(resolve => {\r\n                    const onEnd = (e: TransitionEvent) => {\r\n                        if(e.propertyName !== 'height') return\r\n                        el.removeEventListener('transitionend', onEnd)\r\n                        resolve()\r\n                    }\r\n                    el.addEventListener('transitionend', onEnd)\r\n                })\r\n            ))   \r\n            await handleDeleteMessage(ids)\r\n            setChoosenMsg([])\r\n            setIsChoose(false)\r\n            setDeletingMsg([])       \r\n        })\r\n    } \r\n\r\n    // swipe handlers –¥–ª—è mobile\r\n    const profileSwipe = useSwipe({\r\n        onSwipeLeft: () => {\r\n            if (!isMobile) return;\r\n            setOpenProfile(false);\r\n        },\r\n        onSwipeRight: () => {\r\n            if (!isMobile) return;\r\n            setOpenProfile(true);\r\n        },\r\n    });\r\n    const chatSwipe = useSwipe({\r\n        onSwipeRight: () => {\r\n            if (!isMobile) return;\r\n            setOpenChat(false);\r\n        },\r\n    });\r\n\r\n    // –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Å–∞–π–∑\r\n    useLayoutEffect(() => {\r\n        if (!isMobile) {\r\n            dialogPanelRef.current.style.width = \"50%\"\r\n            return\r\n        };\r\n        if(isMobile){\r\n            dialogPanelRef.current.style.width = \"100vw\"\r\n            return\r\n        }\r\n    },[isMobile])\r\n  \r\n    return (\r\n        <main\r\n            className={`flex overflow-hidden bg-[#12080b] select-none ${isMobile ? \"\" : \"h-screen\"}`}\r\n            {...(isMobile && !openChat ? profileSwipe : {})}\r\n        >\r\n\r\n            {/* DIALOGS */}\r\n            <div\r\n                ref={dialogPanelRef}\r\n                className={`bg-[#12080b] overflow-y-auto overflow-x-hidden\r\n                    ${\r\n                        isMobile\r\n                            ? `absolute inset-0 transition-transform duration-300 ease-out will-change-transform ${\r\n                                  openChat ? \"-translate-x-full\" : \"translate-x-0\"\r\n                              }`\r\n                            : \"relative w-1/2 border-r border-[#d91c558b]\"\r\n                    }\r\n                `}\r\n                style={{\r\n                    overscrollBehavior: \"contain\",\r\n                    touchAction: \"pan-y\",\r\n                }}\r\n            >\r\n                {/* Header –¥–∏–∞–ª–æ–≥–æ–≤ */}\r\n                <div className=\"flex w-full relative backdrop-blur-md\">\r\n                    <button\r\n                        onClick={() => setOpenProfile(true)}\r\n                        className=\"absolute left-2 top-1/2 -translate-y-1/2 prettyBtnChat\"\r\n                    >\r\n                        <svg\r\n                            xmlns=\"http://www.w3.org/2000/svg\"\r\n                            width=\"16\"\r\n                            height=\"16\"\r\n                            viewBox=\"0 0 32 32\"\r\n                        >\r\n                            <path\r\n                                fill=\"none\"\r\n                                stroke=\"currentColor\"\r\n                                strokeLinecap=\"round\"\r\n                                strokeLinejoin=\"round\"\r\n                                strokeWidth=\"2\"\r\n                                d=\"M4 8h24M4 16h24M4 24h24\"\r\n                            />\r\n                        </svg>\r\n                    </button>\r\n\r\n                    <button className=\"p-2 rounded-md w-full text-center flex justify-center items-center\">\r\n                        <span className=\"medium font-semibold\">–ß–∞—Ç—ã</span>\r\n                    </button>\r\n\r\n                    <div className=\"absolute bottom-1/2 translate-y-1/2 right-2 prettyBtnChat\">\r\n                        <AnimatedButton\r\n                            openModal={() => {\r\n                                router.push(`createcard?type=send`);\r\n                            }}\r\n                        >\r\n                            <svg\r\n                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                width=\"16\"\r\n                                height=\"16\"\r\n                                viewBox=\"0 0 32 32\"\r\n                            >\r\n                                <path\r\n                                    fill=\"none\"\r\n                                    stroke=\"currentColor\"\r\n                                    strokeLinecap=\"round\"\r\n                                    strokeLinejoin=\"round\"\r\n                                    strokeWidth=\"2\"\r\n                                    d=\"M2 4h28v18H16l-8 7v-7H2Z\"\r\n                                />\r\n                            </svg>\r\n                        </AnimatedButton>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Resize handler —Ç–æ–ª—å–∫–æ –¥–ª—è desktop */}\r\n                {!isMobile && <DialogResizehandler dialogPanelRef={dialogPanelRef} />}\r\n\r\n                {/* –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ */}\r\n                {dialogs.map((dialog) => {\r\n                    const avatar = dialog.displayId.charAt(1).toUpperCase();\r\n                    const title = dialog.displayId;\r\n                    const timeSend = parseDate(dialog.lastMessage.created_at);\r\n                    const unread = dialog.messages.filter((el) => !el.is_checked && el.from_user !== userId).length;\r\n                    return (\r\n                        <button\r\n                            key={dialog.userId}\r\n                            className=\"p-2 rounded-lg w-full\"\r\n                            onClick={() => {\r\n                                setActiveDialogId(dialog.userId);\r\n                                setActiveDialog(dialog);\r\n                                setActiveChatUserId(dialog.displayId);\r\n                                if (isMobile) setOpenChat(true);\r\n                            }}\r\n                        >\r\n                            <div\r\n                                className={`flex p-3 items-center relative gap-2 rounded-2xl transition-colors\r\n                                    ${\r\n                                        dialog.userId !== activeDialogId && !isMobile\r\n                                            ? \"bg-[#5b5b5ba2]\"\r\n                                            : \"bg-[#949494a2]\"\r\n                                    }\r\n                                `}\r\n                            >\r\n                                {/* AVATAR */}\r\n                                <div\r\n                                    className={`flex w-8 h-8 items-center justify-center rounded-full text-lg font-bold transition-all\r\n                                        bg-linear-to-b from-red-500 to-red-700 backdrop-blur-md\r\n                                        hover:from-red-600 hover:to-red-800 hover:border hover:border-white/40\r\n                                    `}\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        setOpenModalProfile(dialog);\r\n                                    }}\r\n                                >\r\n                                    <span>\r\n                                        {avatar}\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {/* NAME */}\r\n                                <span className=\"font-semibold\">{title}</span>\r\n\r\n                                {/* TIME */}\r\n                                <p className=\"absolute right-2 top-3 flexC text-center text-gray-400 text-[10px]\">\r\n                                    {timeSend}\r\n                                </p>\r\n                                {/* UNREAD */}\r\n                                {unread > 0 && (\r\n                                    <p \r\n                                        className=\"absolute right-2 bottom-1 flexC text-center \r\n                                        unreadMsg\r\n                                    \">\r\n                                        {unread}\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                        </button>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            {/* MESSAGES */}\r\n            <div\r\n                className={`overflow-y-auto bg-[#0e0406]\r\n                    ${isMobile\r\n                        ? `absolute inset-0 bg-[#12080b] transition-transform duration-300 ease-in-out will-change-transform \r\n                        ${openChat ? \"translate-x-0\" : \"translate-x-full\"}`\r\n                        : \"flex-1 flex flex-col\"\r\n                    }\r\n                `}\r\n                {...(isMobile ? chatSwipe : {})}\r\n            >\r\n                {/* Header —á–∞—Ç–∞ */}\r\n                {activeChatUserId && !isChoose && (\r\n                    <div className=\"sticky top-0 w-full flexC py-2 z-20\">\r\n                        <button\r\n                            className={`flexC z-10 prettyBtnChat\r\n                                ${isMobile ? '': 'opacity-0 pointer-events-none'}`}\r\n                            onClick={() => setOpenChat(false)}\r\n                        >\r\n                            <svg\r\n                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                width=\"16\"\r\n                                height=\"16\"\r\n                                viewBox=\"0 0 24 24\"\r\n                            >\r\n                                <path\r\n                                    fill=\"currentColor\"\r\n                                    d=\"M16.88 2.88a1.25 1.25 0 0 0-1.77 0L6.7 11.29a.996.996 0 0 0 0 1.41l8.41 8.41c.49.49 1.28.49 1.77 0s.49-1.28 0-1.77L9.54 12l7.35-7.35c.48-.49.48-1.28-.01-1.77\"\r\n                                />\r\n                            </svg>\r\n                        </button>\r\n\r\n                        <div className=\"flexC mx-auto text-[15px] prettyBtnChat\">\r\n                            {activeChatUserId}\r\n                            <Rating value={activeDialog?.rating}></Rating>\r\n                        </div>\r\n\r\n                        <button\r\n                            className={`flexC prettyBtnChat\r\n                                ${isMobile ? \"justify-self-center\" : \"justify-self-end w-20\"}\r\n                            `}\r\n                            onClick={() => {\r\n                                router.push(\r\n                                    `createcard?type=send&to=${encodeURIComponent(activeChatUserId ?? \"\")}`\r\n                                );\r\n                            }}\r\n                        >\r\n                            <svg\r\n                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                width=\"16\"\r\n                                height=\"16\"\r\n                                viewBox=\"0 0 14 14\"\r\n                            >\r\n                                <g fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\"\r\n                                >\r\n                                    <path d=\"M7.5.5h-5a1 1 0 0 0-1 1v9l-1 3l4-1h8a1 1 0 0 0 1-1v-5\" />\r\n                                    <path d=\"m8.363 8.137l-3 .54l.5-3.04l4.73-4.71a.999.999 0 0 1 1.42 0l1.06 1.06a1.001 1.001 0 0 1 0 1.42z\" />\r\n                                </g>\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                )}\r\n                {/* header –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–æ–æ–±—â–µ–Ω–∏–π */}\r\n                {isChoose && (\r\n                    <div className=\"sticky top-0 w-full flex items-start justify-between z-20 text-[15px] p-1\">\r\n                        <button\r\n                            className=\"flexC prettyBtn\"\r\n                            onClick={() => {\r\n                                setIsChoose(false);\r\n                                setChoosenMsg([]);\r\n                            }}\r\n                        >\r\n                            –ù–∞–∑–∞–¥\r\n                        </button>\r\n\r\n                        <button className=\"flexC prettyBtn\" \r\n                            onClick={() => {\r\n                                handleRemoveMsg(choosenMsg)\r\n                            }}\r\n                        >\r\n                            –£–¥–∞–ª–∏—Ç—å\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                {/* –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π */}\r\n                <div className=\"relative p-2 space-y-2 \">\r\n                    {activeDialog?.messages.map((message, i) => {\r\n                        const avatar = message.from_display_id.charAt(1).toUpperCase();\r\n                        const nameLabel = message.from_display_id;\r\n                        const isMine = message.from_user === userId;\r\n                        const date = parseDate(message.created_at);\r\n\r\n                        return (\r\n                            <div\r\n                                key={message.id}\r\n                                ref={el => {(wrapperRef.current[message.id] = el)}}\r\n\r\n                                className={`flex flex-col relative w-full transition hover:bg-white/10 select-none\r\n                                    ${isMine ? \"items-end\" : \"items-start\"} \r\n                                    message-wrapper ${deletingMsg.includes(message.id)  ? \"message--collapsing\" : \"\"}\r\n                                `}\r\n                            >\r\n                                <div\r\n                                    // ref={msgRef}\r\n                                    ref={el => {(bubbleRef.current[message.id] = el)}}\r\n                                    className={`relative flex flex-col items-center justify-center p-2 gap-2 w-1/2 rounded-2xl cursor-pointer transition-transform\r\n                                        ${!isMine \r\n                                            ? \"bg-linear-to-b from-[#ff00666d] to-[#ec015f5d]\" \r\n                                            : \"bg-linear-to-b from-white/60 to-white/40\"}\r\n                                        ${selectTouched === message.id && isMobile ? \"scale-105\" : \"\"}\r\n                                        ${selectTouched === message.id && !isMobile ? (isMine ? \"border-l\" : \"border-r\") : \"\"}\r\n                                        message ${deletingMsg.includes(message.id) ? \"message--deleting\" : \"\"}\r\n                                    `}\r\n                                    onClick={(e) => {\r\n                                        if (isChoose) {\r\n                                            setChoosenMsg((prev) => {\r\n                                                if (prev.includes(message.id)) {\r\n                                                    return prev.filter((id) => id !== message.id);\r\n                                                } else {\r\n                                                    return [...prev, message.id];\r\n                                                }\r\n                                            });\r\n                                            return;\r\n                                        } else {\r\n                                            if (!isMine && !message.is_checked) {\r\n                                                markAsRead(message.id, userId!).then(() => {\r\n                                                    setActiveDialog(\r\n                                                        (d) =>\r\n                                                            d && {\r\n                                                                ...d,\r\n                                                                messages: d.messages.map((m) =>\r\n                                                                    m.id === message.id\r\n                                                                        ? { ...m, is_checked: true }\r\n                                                                        : m\r\n                                                                ),\r\n                                                            }\r\n                                                    );\r\n                                                });\r\n                                            }\r\n                                            router.push(\r\n                                                `createcard?isMine=${isMine}&id=${encodeURIComponent(message.id)}&type=recieve&to=${encodeURIComponent(message?.from_display_id ?? \"\")}`\r\n                                            );\r\n                                        }\r\n                                    }}\r\n                                    onContextMenu={(e) => {\r\n                                        if (isMobile) return;\r\n                                        e.preventDefault();\r\n                                        const target = e.currentTarget as HTMLDivElement;\r\n                                        const rect = target.getBoundingClientRect();\r\n                                        setSelectTouched(message.id);\r\n                                        setAction({ message, rect, type: \"desktop\", isMine });\r\n                                    }}\r\n                                    onPointerDown={(e) => {\r\n                                        if (!isMobile || isChoose) return;\r\n                                        const target = e.currentTarget as HTMLDivElement;\r\n                                        if (e.pointerType === \"touch\") {\r\n                                            setSelectTouched(message.id);\r\n                                            timer.current = window.setTimeout(() => {\r\n                                                const rect = target.getBoundingClientRect();\r\n                                                setAction({ message, rect, type: \"mobile\", isMine });\r\n                                            }, 400);\r\n                                        }\r\n                                    }}\r\n                                    onPointerCancel={() => cancelTouch()}\r\n                                >\r\n                                    <div className=\"flexC gap-2\">\r\n                                        <div className=\"md:w-6 md:h-6 w-8 h-8 rounded-full bg-red-500 flex items-center justify-center text-md font-bold shrink-0\">\r\n                                            {avatar}\r\n                                        </div>\r\n\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"font-semibold medium\">{nameLabel}</span>\r\n                                            <span className=\"small line-clamp-2\">{``}</span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"text-[9px] text-[#cdcdcd]\">{date}</div>\r\n\r\n                                    <ReadIndicator isRead={message.is_checked} isMine={isMine} />\r\n                                    \r\n                                    {isChoose && (\r\n                                        <div\r\n                                            className={`absolute w-3 h-3 rounded-full border\r\n                                                ${!isMine ? \"-right-10\" : \"-left-10\"}\r\n                                                ${isChoose ? \"opacity-100 \" : \"opacity-0\"}\r\n                                                ${choosenMsg.map((msg) => msg).includes(message.id) ? \"bg-white\" : \"\"}\r\n                                            `}\r\n                                        ></div>\r\n                                    )}\r\n\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"absolute top-0 left-0 pointer-events-none overflow-visible w-screen h-screen\"\r\n                // style={{width: '100vw', height: '100vh'}}\r\n\r\n            />\r\n\r\n            {/* message panel */}\r\n            {action && (\r\n                <MessageActionRoot\r\n                    action={action!}\r\n                    onClose={() => {\r\n                        closeMenu();\r\n                        setSelectTouched(null);\r\n                    }}\r\n                    onDelete={(id) => {\r\n                        handleRemoveMsg([...choosenMsg, id])\r\n                    }}\r\n                    isChose={setIsChoose}\r\n                    onChose={(id) => setChoosenMsg((prev) => [...prev, id])}\r\n                />\r\n            )}\r\n\r\n            {/* modal profile */}\r\n            <ModalProfile \r\n                dialog={openModalProfile} \r\n                onClose={() => {setOpenModalProfile(null)}}\r\n                fromUser={userId!}\r\n                refresh={() => refresh()}\r\n            />\r\n        </main>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2686, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D0%95%D0%BB%D0%B5%D0%BD%D0%B0/Desktop/next.js/anonlove/app/main.tsx"],"sourcesContent":["\"use client\"\r\n\r\n// export const dynamic = \"force-dynamic\";\r\n\r\nimport { useState, useEffect, useRef, use } from \"react\"\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useAuth } from \"./things/hooks/useAuth\";\r\nimport { useMessages, useDialogs, Dialog } from \"./things/hooks/useMessages\";\r\nimport { sighOut } from \"./things/utils/auth\";\r\nimport { useSwipe } from \"./things/hooks/useSwipe\";\r\nimport { useCheckMobile } from \"./things/hooks/checkMobile\";\r\nimport {ModalProfile} from \"./modal/modalProfile\"\r\nimport { MessageActionRoot } from \"./contextMenu/messagePanel\"; \r\nimport { UiMessage } from \"./things/types/type\";\r\nimport { ManagerChat } from \"./anonMain/chat/Chat\";\r\n\r\n\r\n\r\nexport default function MainPage() {\r\n    const router = useRouter();\r\n\r\n    const {user, profile, loading: authLoading} = useAuth();\r\n    \r\n    const {inbox, sent, sendMessage: send, loading: messageLoading, refresh, deleteMessage} = useMessages(user?.id || null);\r\n\r\n    const dialogs = useDialogs(inbox, sent, user?.id || \"\", profile?.public_id || \"\");\r\n    const [activeDialogId, setActiveDialogId] = useState<string | null>(null);\r\n    const [activeDialog, setActiveDialog] = useState<Dialog | null>(null);\r\n\r\n    const [openChat, setOpenChat] = useState(false);\r\n    const isMobile = useCheckMobile()\r\n\r\n    const [openProfile, setOpenProfile] = useState(false); // profile —Å–ª–µ–≤–∞\r\n\r\n    \r\n\r\n    const styleToNotSwipe: React.CSSProperties = {\r\n        overscrollBehavior: 'contain',\r\n        touchAction: 'pan-y'\r\n    }\r\n\r\n    // messagePanel\r\n    const msgRef = useRef<HTMLDivElement>(null) \r\n    let timer = useRef<number | null>(null)\r\n    type ActionState = {\r\n        message: UiMessage,\r\n        rect: DOMRect,\r\n        type: 'desktop' | 'mobile',\r\n        isMine: boolean\r\n    } | null\r\n    const closeMenu = () => {setAction(null); setSelectTouched(null)} // –∑–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é\r\n    const cancelTouch = () => {clearInterval(timer.current!); setSelectTouched(null)} // –æ—Ç–º–µ–Ω–∞ —Ç–∞—á–∞\r\n    const [action, setAction] = useState<ActionState>(null)\r\n    const [isChoose, setIsChoose] = useState(false) // –Ω–∞—á–∞–ª–æ –≤—ã–±–æ—Ä–∞\r\n    const [choosenMsg, setChoosenMsg] = useState<any[]>([]) // –≤—ã–±—Ä–∞–Ω–Ω—ã–µ\r\n    const [selectTouched, setSelectTouched] = useState<string | null>(null)\r\n    //\r\n\r\n    const startTelegramLink = async () => {\r\n        const res = await fetch(\"/api/telegram/start\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"x-user-id\": user?.id\r\n            }\r\n        })\r\n        const {url} = await res.json()\r\n        window.location.href = url\r\n    }\r\n    \r\n\r\n    useEffect(() => {\r\n        if (!activeDialogId){\r\n            setActiveDialog(null)\r\n            return\r\n        }\r\n        const found = dialogs.find(d => d.userId === activeDialogId) || null\r\n        setActiveDialog(found)\r\n    }, [dialogs, activeDialogId])\r\n\r\n    // —Å–≤–∞–π–ø –¥–ª—è –º–æ–±–∏–ª–∫–∏\r\n    const chatSwipe = useSwipe({\r\n        onSwipeRight: () => {\r\n            if (!isMobile) return;\r\n            setOpenChat(false)\r\n        }\r\n    })\r\n    // swipe close profile mobile\r\n    const profileSwipe = useSwipe({\r\n        onSwipeLeft: () => {\r\n            if (!isMobile) return;\r\n            setOpenProfile(false)\r\n        },\r\n        onSwipeRight: () => {\r\n            if (!isMobile) return;\r\n            setOpenProfile(true)\r\n        }\r\n    })\r\n\r\n\r\n    // —Ä–µ–¥–∏—Ä–µ–∫—Ç –µ—Å–ª–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω\r\n    useEffect(() => {\r\n        if (authLoading) return;\r\n\r\n        if(!user){\r\n            router.replace('/auth')\r\n        }\r\n    }, [user, authLoading,router])\r\n\r\n    \r\n\r\n    useEffect(() => {\r\n        if(!isMobile){\r\n            setOpenChat(false)\r\n        }\r\n    }, [isMobile])\r\n\r\n    \r\n    \r\n    const handleSignOut = async () => {\r\n        await sighOut()\r\n        router.push('/auth')\r\n    }\r\n\r\n\r\n\r\n\r\n    const [loadingText, setLoadingText] = useState(\"\")\r\n    const indexRef = useRef(0)\r\n    const intervalRef = useRef<number | null>(null)\r\n    useEffect(() => {\r\n        if (!authLoading){\r\n            if (intervalRef.current){\r\n                clearInterval(intervalRef.current)\r\n                intervalRef.current = null\r\n            }\r\n            return\r\n        }\r\n        \r\n        const word = 'loading'\r\n        indexRef.current = 0\r\n        setLoadingText('')\r\n\r\n        intervalRef.current = window.setInterval(() => {\r\n            setLoadingText(prev => {\r\n                if (indexRef.current >= word.length) {\r\n                    indexRef.current = 0\r\n                    return \"\"\r\n                }\r\n                const next = prev + word[indexRef.current]\r\n                indexRef.current +=1\r\n                return next\r\n            })\r\n        },100)\r\n\r\n        return () => {\r\n            if (intervalRef.current){\r\n                clearInterval(intervalRef.current)\r\n                intervalRef.current = null\r\n            }\r\n        }\r\n    }, [authLoading])\r\n    \r\n    \r\n    if (authLoading) {\r\n        return (\r\n            <div className=\"bg-black min-h-screen flex items-center justify-center text-white \">\r\n                <div className=\"animate-pulse\">–ó–∞–≥—Ä—É–û—á–∫–∞...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n\r\n    return (\r\n        <div \r\n            className=\"relative bg-black min-h-screen max-h-screen flex flex-col overflow-hidden \"\r\n            >\r\n            <ManagerChat \r\n                userId={user?.id}\r\n                dialogs={dialogs}\r\n                setOpenProfile={setOpenProfile}\r\n                setOpenChat={setOpenChat}\r\n                openChat={openChat}\r\n                isMobile={isMobile}\r\n                deleteMessage={deleteMessage}\r\n                refresh={refresh}\r\n            />\r\n\r\n\r\n            {/* profile left side */}\r\n            <div\r\n                {...(isMobile ? profileSwipe : {})}\r\n                className={`flex flex-1 flex-col items-center absolute bg-black/50 backdrop-blur-md transition-transform duration-150 ease-in-out will-change-transform\r\n                    ${openProfile ? \"translate-x-0\" : \"-translate-x-full \"}\r\n                    ${isMobile ? \"inset-0\" : \"w-1/3 h-full\"}\r\n                    `}\r\n                onClick={(e) => {\r\n                    e.stopPropagation()\r\n                }}\r\n            >\r\n                <div\r\n                    className=\"bg-white/20 backdrop-blur-2xl w-full flexC p-2 rounded-b-2xl\"\r\n                >\r\n                    {profile?.public_id} \r\n\r\n                    \r\n                </div>\r\n\r\n                <button \r\n                    className=\"p-2 bg-white/20 rounded-full m-2\"\r\n                    onClick={(e) => startTelegramLink()}\r\n                >\r\n                    –ü—Ä–∏–≤—è–∑–∞—Ç—å —Ç–µ–ª–µ–≥—Ä–∞–º–º\r\n                </button>\r\n\r\n                <div className=\"absolute bottom-0 bg-white/10 p-2 backdrop-blur-md w-full flexC rounded-t-2xl\">\r\n                    <button\r\n                        className=\"text-red-500\"\r\n                        onClick={() => {\r\n                            handleSignOut()\r\n                        }}\r\n                    >\r\n                        –í—ã–π—Ç–∏\r\n                    </button>\r\n                </div>\r\n\r\n                <button\r\n                    className=\"absolute h-40 top-1/2 -translate-y-1/2 right-0 bg-white/20 backdrop-blur-2xl flexC p-1 \r\n                            animate-pulse rounded-l-2xl\r\n                    \"\r\n                    onClick={() => setOpenProfile(false)}\r\n                >\r\n                    {`>`}\r\n                </button>\r\n\r\n            </div>\r\n\r\n            \r\n            \r\n        </div>\r\n        \r\n    )\r\n\r\n}\r\n\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AAEA,0CAA0C;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;;;AAdA;;;;;;;;;AAkBe,SAAS;;IACpB,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,EAAC,IAAI,EAAE,OAAO,EAAE,SAAS,WAAW,EAAC,GAAG,IAAA,+IAAO;IAErD,MAAM,EAAC,KAAK,EAAE,IAAI,EAAE,aAAa,IAAI,EAAE,SAAS,cAAc,EAAE,OAAO,EAAE,aAAa,EAAC,GAAG,IAAA,uJAAW,EAAC,MAAM,MAAM;IAElH,MAAM,UAAU,IAAA,sJAAU,EAAC,OAAO,MAAM,MAAM,MAAM,IAAI,SAAS,aAAa;IAC9E,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAgB;IACpE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAgB;IAEhE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,WAAW,IAAA,0JAAc;IAE/B,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC,QAAQ,gBAAgB;IAIvE,MAAM,kBAAuC;QACzC,oBAAoB;QACpB,aAAa;IACjB;IAEA,eAAe;IACf,MAAM,SAAS,IAAA,uKAAM,EAAiB;IACtC,IAAI,QAAQ,IAAA,uKAAM,EAAgB;IAOlC,MAAM,YAAY;QAAO,UAAU;QAAO,iBAAiB;IAAK,EAAE,gBAAgB;;IAClF,MAAM,cAAc;QAAO,cAAc,MAAM,OAAO;QAAI,iBAAiB;IAAK,EAAE,cAAc;;IAChG,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAc;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC,OAAO,gBAAgB;;IAChE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAQ,EAAE,EAAE,YAAY;;IACpE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAgB;IAClE,EAAE;IAEF,MAAM,oBAAoB;QACtB,MAAM,MAAM,MAAM,MAAM,uBAAuB;YAC3C,QAAQ;YACR,SAAS;gBACL,aAAa,MAAM;YACvB;QACJ;QACA,MAAM,EAAC,GAAG,EAAC,GAAG,MAAM,IAAI,IAAI;QAC5B,OAAO,QAAQ,CAAC,IAAI,GAAG;IAC3B;IAGA,IAAA,0KAAS;8BAAC;YACN,IAAI,CAAC,gBAAe;gBAChB,gBAAgB;gBAChB;YACJ;YACA,MAAM,QAAQ,QAAQ,IAAI;sCAAC,CAAA,IAAK,EAAE,MAAM,KAAK;wCAAmB;YAChE,gBAAgB;QACpB;6BAAG;QAAC;QAAS;KAAe;IAE5B,oBAAoB;IACpB,MAAM,YAAY,IAAA,iJAAQ,EAAC;QACvB,YAAY;4CAAE;gBACV,IAAI,CAAC,UAAU;gBACf,YAAY;YAChB;;IACJ;IACA,6BAA6B;IAC7B,MAAM,eAAe,IAAA,iJAAQ,EAAC;QAC1B,WAAW;+CAAE;gBACT,IAAI,CAAC,UAAU;gBACf,eAAe;YACnB;;QACA,YAAY;+CAAE;gBACV,IAAI,CAAC,UAAU;gBACf,eAAe;YACnB;;IACJ;IAGA,8BAA8B;IAC9B,IAAA,0KAAS;8BAAC;YACN,IAAI,aAAa;YAEjB,IAAG,CAAC,MAAK;gBACL,OAAO,OAAO,CAAC;YACnB;QACJ;6BAAG;QAAC;QAAM;QAAY;KAAO;IAI7B,IAAA,0KAAS;8BAAC;YACN,IAAG,CAAC,UAAS;gBACT,YAAY;YAChB;QACJ;6BAAG;QAAC;KAAS;IAIb,MAAM,gBAAgB;QAClB,MAAM,IAAA,4IAAO;QACb,OAAO,IAAI,CAAC;IAChB;IAKA,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,WAAW,IAAA,uKAAM,EAAC;IACxB,MAAM,cAAc,IAAA,uKAAM,EAAgB;IAC1C,IAAA,0KAAS;8BAAC;YACN,IAAI,CAAC,aAAY;gBACb,IAAI,YAAY,OAAO,EAAC;oBACpB,cAAc,YAAY,OAAO;oBACjC,YAAY,OAAO,GAAG;gBAC1B;gBACA;YACJ;YAEA,MAAM,OAAO;YACb,SAAS,OAAO,GAAG;YACnB,eAAe;YAEf,YAAY,OAAO,GAAG,OAAO,WAAW;sCAAC;oBACrC;8CAAe,CAAA;4BACX,IAAI,SAAS,OAAO,IAAI,KAAK,MAAM,EAAE;gCACjC,SAAS,OAAO,GAAG;gCACnB,OAAO;4BACX;4BACA,MAAM,OAAO,OAAO,IAAI,CAAC,SAAS,OAAO,CAAC;4BAC1C,SAAS,OAAO,IAAG;4BACnB,OAAO;wBACX;;gBACJ;qCAAE;YAEF;sCAAO;oBACH,IAAI,YAAY,OAAO,EAAC;wBACpB,cAAc,YAAY,OAAO;wBACjC,YAAY,OAAO,GAAG;oBAC1B;gBACJ;;QACJ;6BAAG;QAAC;KAAY;IAGhB,IAAI,aAAa;QACb,qBACI,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBAAI,WAAU;0BAAgB;;;;;;;;;;;IAG3C;IAGA,qBACI,6LAAC;QACG,WAAU;;0BAEV,6LAAC,kJAAW;gBACR,QAAQ,MAAM;gBACd,SAAS;gBACT,gBAAgB;gBAChB,aAAa;gBACb,UAAU;gBACV,UAAU;gBACV,eAAe;gBACf,SAAS;;;;;;0BAKb,6LAAC;gBACI,GAAI,WAAW,eAAe,CAAC,CAAC;gBACjC,WAAW,CAAC;oBACR,EAAE,cAAc,kBAAkB,qBAAqB;oBACvD,EAAE,WAAW,YAAY,eAAe;oBACxC,CAAC;gBACL,SAAS,CAAC;oBACN,EAAE,eAAe;gBACrB;;kCAEA,6LAAC;wBACG,WAAU;kCAET,SAAS;;;;;;kCAKd,6LAAC;wBACG,WAAU;wBACV,SAAS,CAAC,IAAM;kCACnB;;;;;;kCAID,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC;4BACG,WAAU;4BACV,SAAS;gCACL;4BACJ;sCACH;;;;;;;;;;;kCAKL,6LAAC;wBACG,WAAU;wBAGV,SAAS,IAAM,eAAe;kCAE7B,CAAC,CAAC,CAAC;;;;;;;;;;;;;;;;;;AAWxB;GAhOwB;;QACL,kJAAS;QAEsB,+IAAO;QAEqC,uJAAW;QAErF,sJAAU;QAKT,0JAAc;QAkDb,iJAAQ;QAOL,iJAAQ;;;KArET"}}]
}